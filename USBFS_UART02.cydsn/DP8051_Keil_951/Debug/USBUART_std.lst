C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE USBUART_STD
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Debug\USBUART_std.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\Generated_Source\PSoC3\USBUART_std.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB WL(2)
                    - PR(.\DP8051_Keil_951\Debug/USBUART_std.lst) CD OT(2,SIZE) OJ(.\DP8051_Keil_951\Debug\USBUART_std.obj)

line level    source

   1          /***************************************************************************//**
   2          * \file USBUART_std.c
   3          * \version 3.0
   4          *
   5          * \brief
   6          *  This file contains the USB Standard request handler.
   7          *
   8          ********************************************************************************
   9          * \copyright
  10          * Copyright 2008-2015, Cypress Semiconductor Corporation.  All rights reserved.
  11          * You may use this file only in accordance with the license, terms, conditions,
  12          * disclaimers, and limitations in the end user license agreement accompanying
  13          * the software package with which this file was provided.
  14          *******************************************************************************/
  15          
  16          #include "USBUART_pvt.h"
  17          
  18          /***************************************
  19          *   Static data allocation
  20          ***************************************/
  21          
  22          #if defined(USBUART_ENABLE_FWSN_STRING)
                  static volatile uint8* USBUART_fwSerialNumberStringDescriptor;
                  static volatile uint8  USBUART_snStringConfirm = USBUART_FALSE;
              #endif  /* (USBUART_ENABLE_FWSN_STRING) */
  26          
  27          #if defined(USBUART_ENABLE_FWSN_STRING)
                  /***************************************************************************
                  * Function Name: USBUART_SerialNumString
                  ************************************************************************//**
                  *
                  *  This function is available only when the User Call Back option in the 
                  *  Serial Number String descriptor properties is selected. Application 
                  *  firmware can provide the source of the USB device serial number string 
                  *  descriptor during run time. The default string is used if the application 
                  *  firmware does not use this function or sets the wrong string descriptor.
                  *
                  *  \param snString:  Pointer to the user-defined string descriptor. The 
                  *  string descriptor should meet the Universal Serial Bus Specification 
                  *  revision 2.0 chapter 9.6.7
                  *  Offset|Size|Value|Description
                  *  ------|----|------|---------------------------------
                  *  0     |1   |N     |Size of this descriptor in bytes
                  *  1     |1   |0x03  |STRING Descriptor Type
                  *  2     |N-2 |Number|UNICODE encoded string
                  *  
                  * *For example:* uint8 snString[16]={0x0E,0x03,'F',0,'W',0,'S',0,'N',0,'0',0,'1',0};
                  *
                  * \reentrant
                  *  No.
                  *
                  ***************************************************************************/
                  void  USBUART_SerialNumString(uint8 snString[]) 
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 2   

                  {
                      USBUART_snStringConfirm = USBUART_FALSE;
                      
                      if (snString != NULL)
                      {
                          /* Check descriptor validation */
                          if ((snString[0u] > 1u) && (snString[1u] == USBUART_DESCR_STRING))
                          {
                              USBUART_fwSerialNumberStringDescriptor = snString;
                              USBUART_snStringConfirm = USBUART_TRUE;
                          }
                      }
                  }
              #endif  /* USBUART_ENABLE_FWSN_STRING */
  68          
  69          
  70          /*******************************************************************************
  71          * Function Name: USBUART_HandleStandardRqst
  72          ****************************************************************************//**
  73          *
  74          *  This Routine dispatches standard requests
  75          *
  76          *
  77          * \return
  78          *  TRUE if request handled.
  79          *
  80          * \reentrant
  81          *  No.
  82          *
  83          *******************************************************************************/
  84          uint8 USBUART_HandleStandardRqst(void) 
  85          {
  86   1          uint8 requestHandled = USBUART_FALSE;
  87   1          uint8 interfaceNumber;
  88   1          uint8 configurationN;
  89   1          uint8 bmRequestType = USBUART_bmRequestTypeReg;
  90   1      
  91   1      #if defined(USBUART_ENABLE_STRINGS)
  92   1          volatile uint8 *pStr = 0u;
  93   1          #if defined(USBUART_ENABLE_DESCRIPTOR_STRINGS)
  94   1              uint8 nStr;
  95   1              uint8 descrLength;
  96   1          #endif /* (USBUART_ENABLE_DESCRIPTOR_STRINGS) */
  97   1      #endif /* (USBUART_ENABLE_STRINGS) */
  98   1          
  99   1          static volatile uint8 USBUART_tBuffer[USBUART_STATUS_LENGTH_MAX];
 100   1          const T_USBUART_LUT CYCODE *pTmp;
 101   1      
 102   1          USBUART_currentTD.count = 0u;
 103   1      
 104   1          if (USBUART_RQST_DIR_D2H == (bmRequestType & USBUART_RQST_DIR_MASK))
 105   1          {
 106   2              /* Control Read */
 107   2              switch (USBUART_bRequestReg)
 108   2              {
 109   3                  case USBUART_GET_DESCRIPTOR:
 110   3                      if (USBUART_DESCR_DEVICE ==USBUART_wValueHiReg)
 111   3                      {
 112   4                          pTmp = USBUART_GetDeviceTablePtr();
 113   4                          USBUART_currentTD.pData = (volatile uint8 *)pTmp->p_list;
 114   4                          USBUART_currentTD.count = USBUART_DEVICE_DESCR_LENGTH;
 115   4                          
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 3   

 116   4                          requestHandled  = USBUART_InitControlRead();
 117   4                      }
 118   3                      else if (USBUART_DESCR_CONFIG == USBUART_wValueHiReg)
 119   3                      {
 120   4                          pTmp = USBUART_GetConfigTablePtr((uint8) USBUART_wValueLoReg);
 121   4                          
 122   4                          /* Verify that requested descriptor exists */
 123   4                          if (pTmp != NULL)
 124   4                          {
 125   5                              USBUART_currentTD.pData = (volatile uint8 *)pTmp->p_list;
 126   5                              USBUART_currentTD.count = (uint16)((uint16)(USBUART_currentTD.pData)[USBUART_CONFI
             -G_DESCR_TOTAL_LENGTH_HI] << 8u) | \
 127   5                                                                                  (USBUART_currentTD.pData)[USBU
             -ART_CONFIG_DESCR_TOTAL_LENGTH_LOW];
 128   5                              requestHandled  = USBUART_InitControlRead();
 129   5                          }
 130   4                      }
 131   3                      
 132   3                  #if(USBUART_BOS_ENABLE)
                              else if (USBUART_DESCR_BOS == USBUART_wValueHiReg)
                              {
                                  pTmp = USBUART_GetBOSPtr();
                                  
                                  /* Verify that requested descriptor exists */
                                  if (pTmp != NULL)
                                  {
                                      USBUART_currentTD.pData = (volatile uint8 *)pTmp;
                                      USBUART_currentTD.count = ((uint16)((uint16)(USBUART_currentTD.pData)[USBUART_BOS_
             -DESCR_TOTAL_LENGTH_HI] << 8u)) | \
                                                                                           (USBUART_currentTD.pData)[USB
             -UART_BOS_DESCR_TOTAL_LENGTH_LOW];
                                      requestHandled  = USBUART_InitControlRead();
                                  }
                              }
                          #endif /*(USBUART_BOS_ENABLE)*/
 147   3                  
 148   3                  #if defined(USBUART_ENABLE_STRINGS)
 149   3                      else if (USBUART_DESCR_STRING == USBUART_wValueHiReg)
 150   3                      {
 151   4                      /* Descriptor Strings */
 152   4                      #if defined(USBUART_ENABLE_DESCRIPTOR_STRINGS)
 153   4                          nStr = 0u;
 154   4                          pStr = (volatile uint8 *) &USBUART_STRING_DESCRIPTORS[0u];
 155   4                          
 156   4                          while ((USBUART_wValueLoReg > nStr) && (*pStr != 0u))
 157   4                          {
 158   5                              /* Read descriptor length from 1st byte */
 159   5                              descrLength = *pStr;
 160   5                              /* Move to next string descriptor */
 161   5                              pStr = &pStr[descrLength];
 162   5                              nStr++;
 163   5                          }
 164   4                      #endif /* (USBUART_ENABLE_DESCRIPTOR_STRINGS) */
 165   4                      
 166   4                      /* Microsoft OS String */
 167   4                      #if defined(USBUART_ENABLE_MSOS_STRING)
 168   4                          if (USBUART_STRING_MSOS == USBUART_wValueLoReg)
 169   4                          {
 170   5                              pStr = (volatile uint8 *)& USBUART_MSOS_DESCRIPTOR[0u];
 171   5                          }
 172   4                      #endif /* (USBUART_ENABLE_MSOS_STRING) */
 173   4                      
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 4   

 174   4                      /* SN string */
 175   4                      #if defined(USBUART_ENABLE_SN_STRING)
 176   4                          if ((USBUART_wValueLoReg != 0u) && 
 177   4                              (USBUART_wValueLoReg == USBUART_DEVICE0_DESCR[USBUART_DEVICE_DESCR_SN_SHIFT]))
 178   4                          {
 179   5                          #if defined(USBUART_ENABLE_IDSN_STRING)
 180   5                              /* Read DIE ID and generate string descriptor in RAM */
 181   5                              USBUART_ReadDieID(USBUART_idSerialNumberStringDescriptor);
 182   5                              pStr = USBUART_idSerialNumberStringDescriptor;
 183   5                          #elif defined(USBUART_ENABLE_FWSN_STRING)
                                      
                                      if(USBUART_snStringConfirm != USBUART_FALSE)
                                      {
                                          pStr = USBUART_fwSerialNumberStringDescriptor;
                                      }
                                      else
                                      {
                                          pStr = (volatile uint8 *)&USBUART_SN_STRING_DESCRIPTOR[0u];
                                      }
                                  #else
                                      pStr = (volatile uint8 *)&USBUART_SN_STRING_DESCRIPTOR[0u];
                                  #endif  /* (USBUART_ENABLE_IDSN_STRING) */
 196   5                          }
 197   4                      #endif /* (USBUART_ENABLE_SN_STRING) */
 198   4                      
 199   4                          if (*pStr != 0u)
 200   4                          {
 201   5                              USBUART_currentTD.count = *pStr;
 202   5                              USBUART_currentTD.pData = pStr;
 203   5                              requestHandled  = USBUART_InitControlRead();
 204   5                          }
 205   4                      }
 206   3                  #endif /*  USBUART_ENABLE_STRINGS */
 207   3                      else
 208   3                      {
 209   4                          requestHandled = USBUART_DispatchClassRqst();
 210   4                      }
 211   3                      break;
 212   3                      
 213   3                  case USBUART_GET_STATUS:
 214   3                      switch (bmRequestType & USBUART_RQST_RCPT_MASK)
 215   3                      {
 216   4                          case USBUART_RQST_RCPT_EP:
 217   4                              USBUART_currentTD.count = USBUART_EP_STATUS_LENGTH;
 218   4                              USBUART_tBuffer[0u]     = USBUART_EP[USBUART_wIndexLoReg & USBUART_DIR_UNUSED].hwE
             -pState;
 219   4                              USBUART_tBuffer[1u]     = 0u;
 220   4                              USBUART_currentTD.pData = &USBUART_tBuffer[0u];
 221   4                              
 222   4                              requestHandled  = USBUART_InitControlRead();
 223   4                              break;
 224   4                          case USBUART_RQST_RCPT_DEV:
 225   4                              USBUART_currentTD.count = USBUART_DEVICE_STATUS_LENGTH;
 226   4                              USBUART_tBuffer[0u]     = USBUART_deviceStatus;
 227   4                              USBUART_tBuffer[1u]     = 0u;
 228   4                              USBUART_currentTD.pData = &USBUART_tBuffer[0u];
 229   4                              
 230   4                              requestHandled  = USBUART_InitControlRead();
 231   4                              break;
 232   4                          default:    /* requestHandled is initialized as FALSE by default */
 233   4                              break;
 234   4                      }
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 5   

 235   3                      break;
 236   3                      
 237   3                  case USBUART_GET_CONFIGURATION:
 238   3                      USBUART_currentTD.count = 1u;
 239   3                      USBUART_currentTD.pData = (volatile uint8 *) &USBUART_configuration;
 240   3                      requestHandled  = USBUART_InitControlRead();
 241   3                      break;
 242   3                      
 243   3                  case USBUART_GET_INTERFACE:
 244   3                      USBUART_currentTD.count = 1u;
 245   3                      USBUART_currentTD.pData = (volatile uint8 *) &USBUART_interfaceSetting[USBUART_wIndexLoReg
             -];
 246   3                      requestHandled  = USBUART_InitControlRead();
 247   3                      break;
 248   3                      
 249   3                  default: /* requestHandled is initialized as FALSE by default */
 250   3                      break;
 251   3              }
 252   2          }
 253   1          else
 254   1          {
 255   2              /* Control Write */
 256   2              switch (USBUART_bRequestReg)
 257   2              {
 258   3                  case USBUART_SET_ADDRESS:
 259   3                      /* Store address to be set in USBUART_NoDataControlStatusStage(). */
 260   3                      USBUART_deviceAddress = (uint8) USBUART_wValueLoReg;
 261   3                      requestHandled = USBUART_InitNoDataControlTransfer();
 262   3                      break;
 263   3                      
 264   3                  case USBUART_SET_CONFIGURATION:
 265   3                      configurationN = USBUART_wValueLoReg;
 266   3                      
 267   3                      /* Verify that configuration descriptor exists */
 268   3                      if(configurationN > 0u)
 269   3                      {
 270   4                          pTmp = USBUART_GetConfigTablePtr((uint8) configurationN - 1u);
 271   4                      }
 272   3                      
 273   3                      /* Responds with a Request Error when configuration number is invalid */
 274   3                      if (((configurationN > 0u) && (pTmp != NULL)) || (configurationN == 0u))
 275   3                      {
 276   4                          /* Set new configuration if it has been changed */
 277   4                          if(configurationN != USBUART_configuration)
 278   4                          {
 279   5                              USBUART_configuration = (uint8) configurationN;
 280   5                              USBUART_configurationChanged = USBUART_TRUE;
 281   5                              USBUART_Config(USBUART_TRUE);
 282   5                          }
 283   4                          requestHandled = USBUART_InitNoDataControlTransfer();
 284   4                      }
 285   3                      break;
 286   3                      
 287   3                  case USBUART_SET_INTERFACE:
 288   3                      if (0u != USBUART_ValidateAlternateSetting())
 289   3                      {
 290   4                          /* Get interface number from the request. */
 291   4                          interfaceNumber = USBUART_wIndexLoReg;
 292   4                          USBUART_interfaceNumber = (uint8) USBUART_wIndexLoReg;
 293   4                           
 294   4                          /* Check if alternate settings is changed for interface. */
 295   4                          if (USBUART_interfaceSettingLast[interfaceNumber] != USBUART_interfaceSetting[interfac
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 6   

             -eNumber])
 296   4                          {
 297   5                              USBUART_configurationChanged = USBUART_TRUE;
 298   5                          
 299   5                              /* Change alternate setting for the endpoints. */
 300   5                          #if (USBUART_EP_MANAGEMENT_MANUAL && USBUART_EP_ALLOC_DYNAMIC)
                                      USBUART_Config(USBUART_FALSE);
                                  #else
 303   5                              USBUART_ConfigAltChanged();
 304   5                          #endif /* (USBUART_EP_MANAGEMENT_MANUAL && USBUART_EP_ALLOC_DYNAMIC) */
 305   5                          }
 306   4                          
 307   4                          requestHandled = USBUART_InitNoDataControlTransfer();
 308   4                      }
 309   3                      break;
 310   3                      
 311   3                  case USBUART_CLEAR_FEATURE:
 312   3                      switch (bmRequestType & USBUART_RQST_RCPT_MASK)
 313   3                      {
 314   4                          case USBUART_RQST_RCPT_EP:
 315   4                              if (USBUART_wValueLoReg == USBUART_ENDPOINT_HALT)
 316   4                              {
 317   5                                  requestHandled = USBUART_ClearEndpointHalt();
 318   5                              }
 319   4                              break;
 320   4                          case USBUART_RQST_RCPT_DEV:
 321   4                              /* Clear device REMOTE_WAKEUP */
 322   4                              if (USBUART_wValueLoReg == USBUART_DEVICE_REMOTE_WAKEUP)
 323   4                              {
 324   5                                  USBUART_deviceStatus &= (uint8)~USBUART_DEVICE_STATUS_REMOTE_WAKEUP;
 325   5                                  requestHandled = USBUART_InitNoDataControlTransfer();
 326   5                              }
 327   4                              break;
 328   4                          case USBUART_RQST_RCPT_IFC:
 329   4                              /* Validate interfaceNumber */
 330   4                              if (USBUART_wIndexLoReg < USBUART_MAX_INTERFACES_NUMBER)
 331   4                              {
 332   5                                  USBUART_interfaceStatus[USBUART_wIndexLoReg] &= (uint8) ~USBUART_wValueLoReg;
 333   5                                  requestHandled = USBUART_InitNoDataControlTransfer();
 334   5                              }
 335   4                              break;
 336   4                          default:    /* requestHandled is initialized as FALSE by default */
 337   4                              break;
 338   4                      }
 339   3                      break;
 340   3                      
 341   3                  case USBUART_SET_FEATURE:
 342   3                      switch (bmRequestType & USBUART_RQST_RCPT_MASK)
 343   3                      {
 344   4                          case USBUART_RQST_RCPT_EP:
 345   4                              if (USBUART_wValueLoReg == USBUART_ENDPOINT_HALT)
 346   4                              {
 347   5                                  requestHandled = USBUART_SetEndpointHalt();
 348   5                              }
 349   4                              break;
 350   4                              
 351   4                          case USBUART_RQST_RCPT_DEV:
 352   4                              /* Set device REMOTE_WAKEUP */
 353   4                              if (USBUART_wValueLoReg == USBUART_DEVICE_REMOTE_WAKEUP)
 354   4                              {
 355   5                                  USBUART_deviceStatus |= USBUART_DEVICE_STATUS_REMOTE_WAKEUP;
 356   5                                  requestHandled = USBUART_InitNoDataControlTransfer();
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 7   

 357   5                              }
 358   4                              break;
 359   4                              
 360   4                          case USBUART_RQST_RCPT_IFC:
 361   4                              /* Validate interfaceNumber */
 362   4                              if (USBUART_wIndexLoReg < USBUART_MAX_INTERFACES_NUMBER)
 363   4                              {
 364   5                                  USBUART_interfaceStatus[USBUART_wIndexLoReg] &= (uint8) ~USBUART_wValueLoReg;
 365   5                                  requestHandled = USBUART_InitNoDataControlTransfer();
 366   5                              }
 367   4                              break;
 368   4                          
 369   4                          default:    /* requestHandled is initialized as FALSE by default */
 370   4                              break;
 371   4                      }
 372   3                      break;
 373   3                      
 374   3                  default:    /* requestHandled is initialized as FALSE by default */
 375   3                      break;
 376   3              }
 377   2          }
 378   1          
 379   1          return (requestHandled);
 380   1      }
 381          
 382          
 383          #if defined(USBUART_ENABLE_IDSN_STRING)
 384              /***************************************************************************
 385              * Function Name: USBUART_ReadDieID
 386              ************************************************************************//**
 387              *
 388              *  This routine read Die ID and generate Serial Number string descriptor.
 389              *
 390              *  \param descr:  pointer on string descriptor. This string size has to be equal or
 391              *          greater than USBUART_IDSN_DESCR_LENGTH.
 392              *
 393              *
 394              * \reentrant
 395              *  No.
 396              *
 397              ***************************************************************************/
 398              void USBUART_ReadDieID(uint8 descr[]) 
 399              {
 400   1              const char8 CYCODE hex[] = "0123456789ABCDEF";
 401   1              uint8 i;
 402   1              uint8 j = 0u;
 403   1              uint8 uniqueId[8u];
 404   1      
 405   1              if (NULL != descr)
 406   1              {
 407   2                  /* Initialize descriptor header. */
 408   2                  descr[0u] = USBUART_IDSN_DESCR_LENGTH;
 409   2                  descr[1u] = USBUART_DESCR_STRING;
 410   2                  
 411   2                  /* Unique ID size is 8 bytes. */
 412   2                  CyGetUniqueId((uint32 *) uniqueId);
 413   2      
 414   2                  /* Fill descriptor with unique device ID. */
 415   2                  for (i = 2u; i < USBUART_IDSN_DESCR_LENGTH; i += 4u)
 416   2                  {
 417   3                      descr[i]      = (uint8) hex[(uniqueId[j] >> 4u)];
 418   3                      descr[i + 1u] = 0u;
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 8   

 419   3                      descr[i + 2u] = (uint8) hex[(uniqueId[j] & 0x0Fu)];
 420   3                      descr[i + 3u] = 0u;
 421   3                      ++j;
 422   3                  }
 423   2              }
 424   1          }
 425          #endif /* (USBUART_ENABLE_IDSN_STRING) */
 426          
 427          
 428          /*******************************************************************************
 429          * Function Name: USBUART_ConfigReg
 430          ****************************************************************************//**
 431          *
 432          *  This routine configures hardware registers from the variables.
 433          *  It is called from USBUART_Config() function and from RestoreConfig
 434          *  after Wakeup.
 435          *
 436          *******************************************************************************/
 437          void USBUART_ConfigReg(void) 
 438          {
 439   1          uint8 ep;
 440   1      
 441   1      #if (USBUART_EP_MANAGEMENT_DMA_AUTO)
                  uint8 epType = 0u;
              #endif /* (USBUART_EP_MANAGEMENT_DMA_AUTO) */
 444   1      
 445   1          /* Go thought all endpoints and set hardware configuration */
 446   1          for (ep = USBUART_EP1; ep < USBUART_MAX_EP; ++ep)
 447   1          {
 448   2              USBUART_ARB_EP_BASE.arbEp[ep].epCfg = USBUART_ARB_EPX_CFG_DEFAULT;
 449   2              
 450   2          #if (USBUART_EP_MANAGEMENT_DMA)
                      /* Enable arbiter endpoint interrupt sources */
                      USBUART_ARB_EP_BASE.arbEp[ep].epIntEn = USBUART_ARB_EPX_INT_MASK;
                  #endif /* (USBUART_EP_MANAGEMENT_DMA) */
 454   2          
 455   2              if (USBUART_EP[ep].epMode != USBUART_MODE_DISABLE)
 456   2              {
 457   3                  if (0u != (USBUART_EP[ep].addr & USBUART_DIR_IN))
 458   3                  {
 459   4                      USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_NAK_IN;
 460   4                      
 461   4                  #if (USBUART_EP_MANAGEMENT_DMA_AUTO && CY_PSOC4)
                              /* Clear DMA_TERMIN for IN endpoint. */
                              USBUART_ARB_EP_BASE.arbEp[ep].epIntEn &= (uint32) ~USBUART_ARB_EPX_INT_DMA_TERMIN;
                          #endif /* (USBUART_EP_MANAGEMENT_DMA_AUTO && CY_PSOC4) */
 465   4                  }
 466   3                  else
 467   3                  {
 468   4                      USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_NAK_OUT;
 469   4      
 470   4                  #if (USBUART_EP_MANAGEMENT_DMA_AUTO)
                              /* (CY_PSOC4): DMA_TERMIN for OUT endpoint is set above. */
                              
                              /* Prepare endpoint type mask. */
                              epType |= (uint8) (0x01u << (ep - USBUART_EP1));
                          #endif /* (USBUART_EP_MANAGEMENT_DMA_AUTO) */
 476   4                  }
 477   3              }
 478   2              else
 479   2              {
 480   3                  USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_STALL_DATA_EP;
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 9   

 481   3              }
 482   2              
 483   2          #if (!USBUART_EP_MANAGEMENT_DMA_AUTO)
 484   2              #if (CY_PSOC4)
                          USBUART_ARB_EP16_BASE.arbEp[ep].rwRa16  = (uint32) USBUART_EP[ep].buffOffset;
                          USBUART_ARB_EP16_BASE.arbEp[ep].rwWa16  = (uint32) USBUART_EP[ep].buffOffset;
                      #else
 488   2                  USBUART_ARB_EP_BASE.arbEp[ep].rwRa    = LO8(USBUART_EP[ep].buffOffset);
 489   2                  USBUART_ARB_EP_BASE.arbEp[ep].rwRaMsb = HI8(USBUART_EP[ep].buffOffset);
 490   2                  USBUART_ARB_EP_BASE.arbEp[ep].rwWa    = LO8(USBUART_EP[ep].buffOffset);
 491   2                  USBUART_ARB_EP_BASE.arbEp[ep].rwWaMsb = HI8(USBUART_EP[ep].buffOffset);
 492   2              #endif /* (CY_PSOC4) */
 493   2          #endif /* (!USBUART_EP_MANAGEMENT_DMA_AUTO) */
 494   2          }
 495   1      
 496   1      #if (USBUART_EP_MANAGEMENT_DMA_AUTO)
                   /* BUF_SIZE depend on DMA_THRESS value:0x55-32 bytes  0x44-16 bytes 0x33-8 bytes 0x22-4 bytes 0x11-2 
             -bytes */
                  USBUART_BUF_SIZE_REG = USBUART_DMA_BUF_SIZE;
              
                  /* Configure DMA burst threshold */
              #if (CY_PSOC4)
                  USBUART_DMA_THRES16_REG   = USBUART_DMA_BYTES_PER_BURST;
              #else
                  USBUART_DMA_THRES_REG     = USBUART_DMA_BYTES_PER_BURST;
                  USBUART_DMA_THRES_MSB_REG = 0u;
              #endif /* (CY_PSOC4) */
                  USBUART_EP_ACTIVE_REG = USBUART_DEFAULT_ARB_INT_EN;
                  USBUART_EP_TYPE_REG   = epType;
                  
                  /* Cfg_cmp bit set to 1 once configuration is complete. */
                  /* Lock arbiter configtuation */
                  USBUART_ARB_CFG_REG |= (uint8)  USBUART_ARB_CFG_CFG_CMP;
                  /* Cfg_cmp bit set to 0 during configuration of PFSUSB Registers. */
                  USBUART_ARB_CFG_REG &= (uint8) ~USBUART_ARB_CFG_CFG_CMP;
              
              #endif /* (USBUART_EP_MANAGEMENT_DMA_AUTO) */
 517   1      
 518   1          /* Enable interrupt SIE interurpt source from EP0-EP1 */
 519   1          USBUART_SIE_EP_INT_EN_REG = (uint8) USBUART_DEFAULT_SIE_EP_INT_EN;
 520   1      }
 521          
 522          
 523          /*******************************************************************************
 524          * Function Name: USBUART_EpStateInit
 525          ****************************************************************************//**
 526          *
 527          *  This routine initialize state of Data end points based of its type: 
 528          *   IN  - USBUART_IN_BUFFER_EMPTY (USBUART_EVENT_PENDING)
 529          *   OUT - USBUART_OUT_BUFFER_EMPTY (USBUART_NO_EVENT_PENDING)
 530          *
 531          *******************************************************************************/
 532          void USBUART_EpStateInit(void) 
 533          {
 534   1          uint8 i;
 535   1      
 536   1          for (i = USBUART_EP1; i < USBUART_MAX_EP; i++)
 537   1          { 
 538   2              if (0u != (USBUART_EP[i].addr & USBUART_DIR_IN))
 539   2              {
 540   3                  /* IN Endpoint */
 541   3                  USBUART_EP[i].apiEpState = USBUART_EVENT_PENDING;
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 10  

 542   3              }
 543   2              else
 544   2              {
 545   3                  /* OUT Endpoint */
 546   3                  USBUART_EP[i].apiEpState = USBUART_NO_EVENT_PENDING;
 547   3              }
 548   2          }
 549   1                          
 550   1      }
 551          
 552          
 553          /*******************************************************************************
 554          * Function Name: USBUART_Config
 555          ****************************************************************************//**
 556          *
 557          *  This routine configures endpoints for the entire configuration by scanning
 558          *  the configuration descriptor.
 559          *
 560          *  \param clearAltSetting: It configures the bAlternateSetting 0 for each interface.
 561          *
 562          * USBUART_interfaceClass - Initialized class array for each interface.
 563          *   It is used for handling Class specific requests depend on interface class.
 564          *   Different classes in multiple Alternate settings does not supported.
 565          *
 566          * \reentrant
 567          *  No.
 568          *
 569          *******************************************************************************/
 570          void USBUART_Config(uint8 clearAltSetting) 
 571          {
 572   1          uint8 ep;
 573   1          uint8 curEp;
 574   1          uint8 i;
 575   1          uint8 epType;
 576   1          const uint8 *pDescr;
 577   1          
 578   1          #if (!USBUART_EP_MANAGEMENT_DMA_AUTO)
 579   1              uint16 buffCount = 0u;
 580   1          #endif /* (!USBUART_EP_MANAGEMENT_DMA_AUTO) */
 581   1      
 582   1          const T_USBUART_LUT CYCODE *pTmp;
 583   1          const T_USBUART_EP_SETTINGS_BLOCK CYCODE *pEP;
 584   1      
 585   1          /* Clear endpoints settings */
 586   1          for (ep = 0u; ep < USBUART_MAX_EP; ++ep)
 587   1          {
 588   2              USBUART_EP[ep].attrib     = 0u;
 589   2              USBUART_EP[ep].hwEpState  = 0u;
 590   2              USBUART_EP[ep].epToggle   = 0u;
 591   2              USBUART_EP[ep].bufferSize = 0u;
 592   2              USBUART_EP[ep].interface  = 0u;
 593   2              USBUART_EP[ep].apiEpState = USBUART_NO_EVENT_PENDING;
 594   2              USBUART_EP[ep].epMode     = USBUART_MODE_DISABLE;   
 595   2          }
 596   1      
 597   1          /* Clear Alternate settings for all interfaces. */
 598   1          if (0u != clearAltSetting)
 599   1          {
 600   2              for (i = 0u; i < USBUART_MAX_INTERFACES_NUMBER; ++i)
 601   2              {
 602   3                  USBUART_interfaceSetting[i]     = 0u;
 603   3                  USBUART_interfaceSettingLast[i] = 0u;
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 11  

 604   3              }
 605   2          }
 606   1      
 607   1          /* Init Endpoints and Device Status if configured */
 608   1          if (USBUART_configuration > 0u)
 609   1          {
 610   2              #if defined(USBUART_ENABLE_CDC_CLASS)
 611   2                  uint8 cdcComNums = 0u;
 612   2              #endif  /* (USBUART_ENABLE_CDC_CLASS) */  
 613   2      
 614   2              pTmp = USBUART_GetConfigTablePtr(USBUART_configuration - 1u);
 615   2              
 616   2              /* Set Power status for current configuration */
 617   2              pDescr = (const uint8 *)pTmp->p_list;
 618   2              if ((pDescr[USBUART_CONFIG_DESCR_ATTRIB] & USBUART_CONFIG_DESCR_ATTRIB_SELF_POWERED) != 0u)
 619   2              {
 620   3                  USBUART_deviceStatus |= (uint8)  USBUART_DEVICE_STATUS_SELF_POWERED;
 621   3              }
 622   2              else
 623   2              {
 624   3                  USBUART_deviceStatus &= (uint8) ~USBUART_DEVICE_STATUS_SELF_POWERED;
 625   3              }
 626   2              
 627   2              /* Move to next element */
 628   2              pTmp = &pTmp[1u];
 629   2              ep = pTmp->c;  /* For this table, c is the number of endpoints configurations  */
 630   2      
 631   2              #if (USBUART_EP_MANAGEMENT_MANUAL && USBUART_EP_ALLOC_DYNAMIC)
                          /* Configure for dynamic EP memory allocation */
                          /* p_list points the endpoint setting table. */
                          pEP = (T_USBUART_EP_SETTINGS_BLOCK *) pTmp->p_list;
                          
                          for (i = 0u; i < ep; i++)
                          {     
                              /* Compare current Alternate setting with EP Alt */
                              if (USBUART_interfaceSetting[pEP->interface] == pEP->altSetting)
                              {                                                          
                                  curEp  = pEP->addr & USBUART_DIR_UNUSED;
                                  epType = pEP->attributes & USBUART_EP_TYPE_MASK;
                                  
                                  USBUART_EP[curEp].addr       = pEP->addr;
                                  USBUART_EP[curEp].attrib     = pEP->attributes;
                                  USBUART_EP[curEp].bufferSize = pEP->bufferSize;
              
                                  if (0u != (pEP->addr & USBUART_DIR_IN))
                                  {
                                      /* IN Endpoint */
                                      USBUART_EP[curEp].epMode     = USBUART_GET_ACTIVE_IN_EP_CR0_MODE(epType);
                                      USBUART_EP[curEp].apiEpState = USBUART_EVENT_PENDING;
                                  
                                  #if (defined(USBUART_ENABLE_MIDI_STREAMING) && (USBUART_MIDI_IN_BUFF_SIZE > 0))
                                      if ((pEP->bMisc == USBUART_CLASS_AUDIO) && (epType == USBUART_EP_TYPE_BULK))
                                      {
                                          USBUART_midi_in_ep = curEp;
                                      }
                                  #endif  /* (USBUART_ENABLE_MIDI_STREAMING) */
                                  }
                                  else
                                  {
                                      /* OUT Endpoint */
                                      USBUART_EP[curEp].epMode     = USBUART_GET_ACTIVE_OUT_EP_CR0_MODE(epType);
                                      USBUART_EP[curEp].apiEpState = USBUART_NO_EVENT_PENDING;
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 12  

                                      
                                  #if (defined(USBUART_ENABLE_MIDI_STREAMING) && (USBUART_MIDI_OUT_BUFF_SIZE > 0))
                                      if ((pEP->bMisc == USBUART_CLASS_AUDIO) && (epType == USBUART_EP_TYPE_BULK))
                                      {
                                          USBUART_midi_out_ep = curEp;
                                      }
                                  #endif  /* (USBUART_ENABLE_MIDI_STREAMING) */
                                  }
              
                              #if(defined (USBUART_ENABLE_CDC_CLASS))
                                  if((pEP->bMisc == USBUART_CLASS_CDC_DATA) ||(pEP->bMisc == USBUART_CLASS_CDC))
                                  {
                                      cdcComNums = USBUART_Cdc_EpInit(pEP, curEp, cdcComNums);
                                  }
                              #endif  /* (USBUART_ENABLE_CDC_CLASS) */
                              }
                              
                              pEP = &pEP[1u];
                          }
                          
                      #else
 687   2                  for (i = USBUART_EP1; i < USBUART_MAX_EP; ++i)
 688   2                  {
 689   3                      /* p_list points the endpoint setting table. */
 690   3                      pEP = (const T_USBUART_EP_SETTINGS_BLOCK CYCODE *) pTmp->p_list;
 691   3                      /* Find max length for each EP and select it (length could be different in different Alt s
             -ettings) */
 692   3                      /* but other settings should be correct with regards to Interface alt Setting */
 693   3                      
 694   3                      for (curEp = 0u; curEp < ep; ++curEp)
 695   3                      {
 696   4                          if (i == (pEP->addr & USBUART_DIR_UNUSED))
 697   4                          {
 698   5                              /* Compare endpoint buffers size with current size to find greater. */
 699   5                              if (USBUART_EP[i].bufferSize < pEP->bufferSize)
 700   5                              {
 701   6                                  USBUART_EP[i].bufferSize = pEP->bufferSize;
 702   6                              }
 703   5                              
 704   5                              /* Compare current Alternate setting with EP Alt */
 705   5                              if (USBUART_interfaceSetting[pEP->interface] == pEP->altSetting)
 706   5                              {                            
 707   6                                  USBUART_EP[i].addr = pEP->addr;
 708   6                                  USBUART_EP[i].attrib = pEP->attributes;
 709   6                                  
 710   6                                  epType = pEP->attributes & USBUART_EP_TYPE_MASK;
 711   6                                  
 712   6                                  if (0u != (pEP->addr & USBUART_DIR_IN))
 713   6                                  {
 714   7                                      /* IN Endpoint */
 715   7                                      USBUART_EP[i].epMode     = USBUART_GET_ACTIVE_IN_EP_CR0_MODE(epType);
 716   7                                      USBUART_EP[i].apiEpState = USBUART_EVENT_PENDING;
 717   7                                      
 718   7                                  #if (defined(USBUART_ENABLE_MIDI_STREAMING) && (USBUART_MIDI_IN_BUFF_SIZE > 0)
             -)
                                              if ((pEP->bMisc == USBUART_CLASS_AUDIO) && (epType == USBUART_EP_TYPE_BULK
             -))
                                              {
                                                  USBUART_midi_in_ep = i;
                                              }
                                          #endif  /* (USBUART_ENABLE_MIDI_STREAMING) */
 724   7                                  }
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 13  

 725   6                                  else
 726   6                                  {
 727   7                                      /* OUT Endpoint */
 728   7                                      USBUART_EP[i].epMode     = USBUART_GET_ACTIVE_OUT_EP_CR0_MODE(epType);
 729   7                                      USBUART_EP[i].apiEpState = USBUART_NO_EVENT_PENDING;
 730   7                                      
 731   7                                  #if (defined(USBUART_ENABLE_MIDI_STREAMING) && (USBUART_MIDI_OUT_BUFF_SIZE > 0
             -))
                                              if ((pEP->bMisc == USBUART_CLASS_AUDIO) && (epType == USBUART_EP_TYPE_BULK
             -))
                                              {
                                                  USBUART_midi_out_ep = i;
                                              }
                                          #endif  /* (USBUART_ENABLE_MIDI_STREAMING) */
 737   7                                  }
 738   6      
 739   6                              #if (defined(USBUART_ENABLE_CDC_CLASS))
 740   6                                  if((pEP->bMisc == USBUART_CLASS_CDC_DATA) ||(pEP->bMisc == USBUART_CLASS_CDC))
 741   6                                  {
 742   7                                      cdcComNums = USBUART_Cdc_EpInit(pEP, i, cdcComNums);
 743   7                                  }
 744   6                              #endif  /* (USBUART_ENABLE_CDC_CLASS) */
 745   6      
 746   6                                  #if (USBUART_EP_MANAGEMENT_DMA_AUTO)
                                              break;  /* Use first EP setting in Auto memory management */
                                          #endif /* (USBUART_EP_MANAGEMENT_DMA_AUTO) */
 749   6                              }
 750   5                          }
 751   4                          
 752   4                          pEP = &pEP[1u];
 753   4                      }
 754   3                  }
 755   2              #endif /*  (USBUART_EP_MANAGEMENT_MANUAL && USBUART_EP_ALLOC_DYNAMIC) */
 756   2      
 757   2              /* Init class array for each interface and interface number for each EP.
 758   2              *  It is used for handling Class specific requests directed to either an
 759   2              *  interface or the endpoint.
 760   2              */
 761   2              /* p_list points the endpoint setting table. */
 762   2              pEP = (const T_USBUART_EP_SETTINGS_BLOCK CYCODE *) pTmp->p_list;
 763   2              for (i = 0u; i < ep; i++)
 764   2              {
 765   3                  /* Configure interface number for each EP */
 766   3                  USBUART_EP[pEP->addr & USBUART_DIR_UNUSED].interface = pEP->interface;
 767   3                  pEP = &pEP[1u];
 768   3              }
 769   2              
 770   2              /* Init pointer on interface class table */
 771   2              USBUART_interfaceClass = USBUART_GetInterfaceClassTablePtr();
 772   2              
 773   2          /* Set the endpoint buffer addresses */
 774   2          #if (!USBUART_EP_MANAGEMENT_DMA_AUTO)
 775   2              buffCount = 0u;
 776   2              for (ep = USBUART_EP1; ep < USBUART_MAX_EP; ++ep)
 777   2              {
 778   3                  USBUART_EP[ep].buffOffset = buffCount;        
 779   3                  buffCount += USBUART_EP[ep].bufferSize;
 780   3                  
 781   3              #if (USBUART_GEN_16BITS_EP_ACCESS)
                          /* Align EP buffers to be event size to access 16-bits DR register. */
                          buffCount += (0u != (buffCount & 0x01u)) ? 1u : 0u;
                      #endif /* (USBUART_GEN_16BITS_EP_ACCESS) */            
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 14  

 785   3              }
 786   2          #endif /* (!USBUART_EP_MANAGEMENT_DMA_AUTO) */
 787   2      
 788   2              /* Configure hardware registers */
 789   2              USBUART_ConfigReg();
 790   2          }
 791   1      }
 792          
 793          
 794          /*******************************************************************************
 795          * Function Name: USBUART_ConfigAltChanged
 796          ****************************************************************************//**
 797          *
 798          *  This routine update configuration for the required endpoints only.
 799          *  It is called after SET_INTERFACE request when Static memory allocation used.
 800          *
 801          * \reentrant
 802          *  No.
 803          *
 804          *******************************************************************************/
 805          void USBUART_ConfigAltChanged(void) 
 806          {
 807   1          uint8 ep;
 808   1          uint8 curEp;
 809   1          uint8 epType;
 810   1          uint8 i;
 811   1          uint8 interfaceNum;
 812   1      
 813   1          const T_USBUART_LUT CYCODE *pTmp;
 814   1          const T_USBUART_EP_SETTINGS_BLOCK CYCODE *pEP;
 815   1      
 816   1          /* Init Endpoints and Device Status if configured */
 817   1          if (USBUART_configuration > 0u)
 818   1          {
 819   2              /* Get number of endpoints configurations (ep). */
 820   2              pTmp = USBUART_GetConfigTablePtr(USBUART_configuration - 1u);
 821   2              pTmp = &pTmp[1u];
 822   2              ep = pTmp->c;
 823   2      
 824   2              /* Get pointer to endpoints setting table (pEP). */
 825   2              pEP = (const T_USBUART_EP_SETTINGS_BLOCK CYCODE *) pTmp->p_list;
 826   2              
 827   2              /* Look through all possible endpoint configurations. Find endpoints 
 828   2              * which belong to current interface and alternate settings for 
 829   2              * re-configuration.
 830   2              */
 831   2              interfaceNum = USBUART_interfaceNumber;
 832   2              for (i = 0u; i < ep; i++)
 833   2              {
 834   3                  /* Find endpoints which belong to current interface and alternate settings. */
 835   3                  if ((interfaceNum == pEP->interface) && 
 836   3                      (USBUART_interfaceSetting[interfaceNum] == pEP->altSetting))
 837   3                  {
 838   4                      curEp  = ((uint8) pEP->addr & USBUART_DIR_UNUSED);
 839   4                      epType = ((uint8) pEP->attributes & USBUART_EP_TYPE_MASK);
 840   4                      
 841   4                      /* Change the SIE mode for the selected EP to NAK ALL */
 842   4                      USBUART_EP[curEp].epToggle   = 0u;
 843   4                      USBUART_EP[curEp].addr       = pEP->addr;
 844   4                      USBUART_EP[curEp].attrib     = pEP->attributes;
 845   4                      USBUART_EP[curEp].bufferSize = pEP->bufferSize;
 846   4      
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 15  

 847   4                      if (0u != (pEP->addr & USBUART_DIR_IN))
 848   4                      {
 849   5                          /* IN Endpoint */
 850   5                          USBUART_EP[curEp].epMode     = USBUART_GET_ACTIVE_IN_EP_CR0_MODE(epType);
 851   5                          USBUART_EP[curEp].apiEpState = USBUART_EVENT_PENDING;
 852   5                      }
 853   4                      else
 854   4                      {
 855   5                          /* OUT Endpoint */
 856   5                          USBUART_EP[curEp].epMode     = USBUART_GET_ACTIVE_OUT_EP_CR0_MODE(epType);
 857   5                          USBUART_EP[curEp].apiEpState = USBUART_NO_EVENT_PENDING;
 858   5                      }
 859   4                      
 860   4                      /* Make SIE to NAK any endpoint requests */
 861   4                      USBUART_SIE_EP_BASE.sieEp[curEp].epCr0 = USBUART_MODE_NAK_IN_OUT;
 862   4      
 863   4                  #if (USBUART_EP_MANAGEMENT_DMA_AUTO)
                              /* Clear IN data ready. */
                              USBUART_ARB_EP_BASE.arbEp[curEp].epCfg &= (uint8) ~USBUART_ARB_EPX_CFG_IN_DATA_RDY;
              
                              /* Select endpoint number of reconfiguration */
                              USBUART_DYN_RECONFIG_REG = (uint8) ((curEp - 1u) << USBUART_DYN_RECONFIG_EP_SHIFT);
                              
                              /* Request for dynamic re-configuration of endpoint. */
                              USBUART_DYN_RECONFIG_REG |= USBUART_DYN_RECONFIG_ENABLE;
                              
                              /* Wait until block is ready for re-configuration */
                              while (0u == (USBUART_DYN_RECONFIG_REG & USBUART_DYN_RECONFIG_RDY_STS))
                              {
                              }
                              
                              /* Once DYN_RECONFIG_RDY_STS bit is set, FW can change the EP configuration. */
                              /* Change EP Type with new direction */
                              if (0u != (pEP->addr & USBUART_DIR_IN))
                              {
                                  /* Set endpoint type: 0 - IN and 1 - OUT. */
                                  USBUART_EP_TYPE_REG &= (uint8) ~(uint8)((uint8) 0x01u << (curEp - 1u));
                                  
                              #if (CY_PSOC4)
                                  /* Clear DMA_TERMIN for IN endpoint */
                                  USBUART_ARB_EP_BASE.arbEp[curEp].epIntEn &= (uint32) ~USBUART_ARB_EPX_INT_DMA_TERMIN;
                              #endif /* (CY_PSOC4) */
                              }
                              else
                              {
                                  /* Set endpoint type: 0 - IN and 1- OUT. */
                                  USBUART_EP_TYPE_REG |= (uint8) ((uint8) 0x01u << (curEp - 1u));
                                  
                              #if (CY_PSOC4)
                                  /* Set DMA_TERMIN for OUT endpoint */
                                  USBUART_ARB_EP_BASE.arbEp[curEp].epIntEn |= (uint32) USBUART_ARB_EPX_INT_DMA_TERMIN;
                              #endif /* (CY_PSOC4) */
                              }
                              
                              /* Complete dynamic re-configuration: all endpoint related status and signals 
                              * are set into the default state.
                              */
                              USBUART_DYN_RECONFIG_REG &= (uint8) ~USBUART_DYN_RECONFIG_ENABLE;
              
                          #else
 907   4                      USBUART_SIE_EP_BASE.sieEp[curEp].epCnt0 = HI8(USBUART_EP[curEp].bufferSize);
 908   4                      USBUART_SIE_EP_BASE.sieEp[curEp].epCnt1 = LO8(USBUART_EP[curEp].bufferSize);
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 16  

 909   4                      
 910   4                      #if (CY_PSOC4)
                                  USBUART_ARB_EP16_BASE.arbEp[curEp].rwRa16  = (uint32) USBUART_EP[curEp].buffOffset;
                                  USBUART_ARB_EP16_BASE.arbEp[curEp].rwWa16  = (uint32) USBUART_EP[curEp].buffOffset;
                              #else
 914   4                          USBUART_ARB_EP_BASE.arbEp[curEp].rwRa    = LO8(USBUART_EP[curEp].buffOffset);
 915   4                          USBUART_ARB_EP_BASE.arbEp[curEp].rwRaMsb = HI8(USBUART_EP[curEp].buffOffset);
 916   4                          USBUART_ARB_EP_BASE.arbEp[curEp].rwWa    = LO8(USBUART_EP[curEp].buffOffset);
 917   4                          USBUART_ARB_EP_BASE.arbEp[curEp].rwWaMsb = HI8(USBUART_EP[curEp].buffOffset);
 918   4                      #endif /* (CY_PSOC4) */                
 919   4                  #endif /* (USBUART_EP_MANAGEMENT_DMA_AUTO) */
 920   4                  }
 921   3                  
 922   3                  pEP = &pEP[1u]; /* Get next EP element */
 923   3              }
 924   2              
 925   2              /* The main loop has to re-enable DMA and OUT endpoint */
 926   2          }
 927   1      }
 928          
 929          
 930          /*******************************************************************************
 931          * Function Name: USBUART_GetConfigTablePtr
 932          ****************************************************************************//**
 933          *
 934          *  This routine returns a pointer a configuration table entry
 935          *
 936          *  \param confIndex:  Configuration Index
 937          *
 938          * \return
 939          *  Device Descriptor pointer or NULL when descriptor does not exist.
 940          *
 941          *******************************************************************************/
 942          const T_USBUART_LUT CYCODE *USBUART_GetConfigTablePtr(uint8 confIndex)
 943                                                                  
 944          {
 945   1          /* Device Table */
 946   1          const T_USBUART_LUT CYCODE *pTmp;
 947   1      
 948   1          pTmp = (const T_USBUART_LUT CYCODE *) USBUART_TABLE[USBUART_device].p_list;
 949   1      
 950   1          /* The first entry points to the Device Descriptor,
 951   1          *  the second entry point to the BOS Descriptor
 952   1          *  the rest configuration entries.
 953   1          *  Set pointer to the first Configuration Descriptor
 954   1          */
 955   1          pTmp = &pTmp[2u];
 956   1          /* For this table, c is the number of configuration descriptors  */
 957   1          if(confIndex >= pTmp->c)   /* Verify that required configuration descriptor exists */
 958   1          {
 959   2              pTmp = (const T_USBUART_LUT CYCODE *) NULL;
 960   2          }
 961   1          else
 962   1          {
 963   2              pTmp = (const T_USBUART_LUT CYCODE *) pTmp[confIndex].p_list;
 964   2          }
 965   1      
 966   1          return (pTmp);
 967   1      }
 968          
 969          
 970          #if (USBUART_BOS_ENABLE)
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 17  

                  /*******************************************************************************
                  * Function Name: USBUART_GetBOSPtr
                  ****************************************************************************//**
                  *
                  *  This routine returns a pointer a BOS table entry
                  *
                  *  
                  *
                  * \return
                  *  BOS Descriptor pointer or NULL when descriptor does not exist.
                  *
                  *******************************************************************************/
                  const T_USBUART_LUT CYCODE *USBUART_GetBOSPtr(void)
                                                                          
                  {
                      /* Device Table */
                      const T_USBUART_LUT CYCODE *pTmp;
              
                      pTmp = (const T_USBUART_LUT CYCODE *) USBUART_TABLE[USBUART_device].p_list;
              
                      /* The first entry points to the Device Descriptor,
                      *  the second entry points to the BOS Descriptor
                      */
                      pTmp = &pTmp[1u];
                      pTmp = (const T_USBUART_LUT CYCODE *) pTmp->p_list;
                      return (pTmp);
                  }
              #endif /* (USBUART_BOS_ENABLE) */
 999          
1000          
1001          /*******************************************************************************
1002          * Function Name: USBUART_GetDeviceTablePtr
1003          ****************************************************************************//**
1004          *
1005          *  This routine returns a pointer to the Device table
1006          *
1007          * \return
1008          *  Device Table pointer
1009          *
1010          *******************************************************************************/
1011          const T_USBUART_LUT CYCODE *USBUART_GetDeviceTablePtr(void)
1012                                                                      
1013          {
1014   1          /* Device Table */
1015   1          return( (const T_USBUART_LUT CYCODE *) USBUART_TABLE[USBUART_device].p_list );
1016   1      }
1017          
1018          
1019          /*******************************************************************************
1020          * Function Name: USB_GetInterfaceClassTablePtr
1021          ****************************************************************************//**
1022          *
1023          *  This routine returns Interface Class table pointer, which contains
1024          *  the relation between interface number and interface class.
1025          *
1026          * \return
1027          *  Interface Class table pointer.
1028          *
1029          *******************************************************************************/
1030          const uint8 CYCODE *USBUART_GetInterfaceClassTablePtr(void)
1031                                                                  
1032          {
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 18  

1033   1          const T_USBUART_LUT CYCODE *pTmp;
1034   1          const uint8 CYCODE *pInterfaceClass;
1035   1          uint8 currentInterfacesNum;
1036   1      
1037   1          pTmp = USBUART_GetConfigTablePtr(USBUART_configuration - 1u);
1038   1          if (pTmp != NULL)
1039   1          {
1040   2              currentInterfacesNum  = ((const uint8 *) pTmp->p_list)[USBUART_CONFIG_DESCR_NUM_INTERFACES];
1041   2              /* Third entry in the LUT starts the Interface Table pointers */
1042   2              /* The INTERFACE_CLASS table is located after all interfaces */
1043   2              pTmp = &pTmp[currentInterfacesNum + 2u];
1044   2              pInterfaceClass = (const uint8 CYCODE *) pTmp->p_list;
1045   2          }
1046   1          else
1047   1          {
1048   2              pInterfaceClass = (const uint8 CYCODE *) NULL;
1049   2          }
1050   1      
1051   1          return (pInterfaceClass);
1052   1      }
1053          
1054          
1055          /*******************************************************************************
1056          * Function Name: USBUART_TerminateEP
1057          ****************************************************************************//**
1058          *
1059          *  This function terminates the specified USBFS endpoint.
1060          *  This function should be used before endpoint reconfiguration.
1061          *
1062          *  \param ep Contains the data endpoint number.
1063          *
1064          *  \reentrant
1065          *  No.
1066          *
1067          * \sideeffect
1068          * 
1069          * The device responds with a NAK for any transactions on the selected endpoint.
1070          *   
1071          *******************************************************************************/
1072          void USBUART_TerminateEP(uint8 epNumber) 
1073          {
1074   1          /* Get endpoint number */
1075   1          epNumber &= USBUART_DIR_UNUSED;
1076   1      
1077   1          if ((epNumber > USBUART_EP0) && (epNumber < USBUART_MAX_EP))
1078   1          {
1079   2              /* Set the endpoint Halt */
1080   2              USBUART_EP[epNumber].hwEpState |= USBUART_ENDPOINT_STATUS_HALT;
1081   2      
1082   2              /* Clear the data toggle */
1083   2              USBUART_EP[epNumber].epToggle = 0u;
1084   2              USBUART_EP[epNumber].apiEpState = USBUART_NO_EVENT_ALLOWED;
1085   2      
1086   2              if ((USBUART_EP[epNumber].addr & USBUART_DIR_IN) != 0u)
1087   2              {   
1088   3                  /* IN Endpoint */
1089   3                  USBUART_SIE_EP_BASE.sieEp[epNumber].epCr0 = USBUART_MODE_NAK_IN;
1090   3              }
1091   2              else
1092   2              {
1093   3                  /* OUT Endpoint */
1094   3                  USBUART_SIE_EP_BASE.sieEp[epNumber].epCr0 = USBUART_MODE_NAK_OUT;
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 19  

1095   3              }
1096   2          }
1097   1      }
1098          
1099          
1100          /*******************************************************************************
1101          * Function Name: USBUART_SetEndpointHalt
1102          ****************************************************************************//**
1103          *
1104          *  This routine handles set endpoint halt.
1105          *
1106          * \return
1107          *  requestHandled.
1108          *
1109          * \reentrant
1110          *  No.
1111          *
1112          *******************************************************************************/
1113          uint8 USBUART_SetEndpointHalt(void) 
1114          {
1115   1          uint8 requestHandled = USBUART_FALSE;
1116   1          uint8 ep;
1117   1          
1118   1          /* Set endpoint halt */
1119   1          ep = USBUART_wIndexLoReg & USBUART_DIR_UNUSED;
1120   1      
1121   1          if ((ep > USBUART_EP0) && (ep < USBUART_MAX_EP))
1122   1          {
1123   2              /* Set the endpoint Halt */
1124   2              USBUART_EP[ep].hwEpState |= (USBUART_ENDPOINT_STATUS_HALT);
1125   2      
1126   2              /* Clear the data toggle */
1127   2              USBUART_EP[ep].epToggle = 0u;
1128   2              USBUART_EP[ep].apiEpState |= USBUART_NO_EVENT_ALLOWED;
1129   2      
1130   2              if ((USBUART_EP[ep].addr & USBUART_DIR_IN) != 0u)
1131   2              {
1132   3                  /* IN Endpoint */
1133   3                  USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = (USBUART_MODE_STALL_DATA_EP | 
1134   3                                                                  USBUART_MODE_ACK_IN);
1135   3              }
1136   2              else
1137   2              {
1138   3                  /* OUT Endpoint */
1139   3                  USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = (USBUART_MODE_STALL_DATA_EP | 
1140   3                                                                  USBUART_MODE_ACK_OUT);
1141   3              }
1142   2              requestHandled = USBUART_InitNoDataControlTransfer();
1143   2          }
1144   1      
1145   1          return (requestHandled);
1146   1      }
1147          
1148          
1149          /*******************************************************************************
1150          * Function Name: USBUART_ClearEndpointHalt
1151          ****************************************************************************//**
1152          *
1153          *  This routine handles clear endpoint halt.
1154          *
1155          * \return
1156          *  requestHandled.
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 20  

1157          *
1158          * \reentrant
1159          *  No.
1160          *
1161          *******************************************************************************/
1162          uint8 USBUART_ClearEndpointHalt(void) 
1163          {
1164   1          uint8 requestHandled = USBUART_FALSE;
1165   1          uint8 ep;
1166   1      
1167   1          /* Clear endpoint halt */
1168   1          ep = USBUART_wIndexLoReg & USBUART_DIR_UNUSED;
1169   1      
1170   1          if ((ep > USBUART_EP0) && (ep < USBUART_MAX_EP))
1171   1          {
1172   2              /* Clear the endpoint Halt */
1173   2              USBUART_EP[ep].hwEpState &= (uint8) ~USBUART_ENDPOINT_STATUS_HALT;
1174   2      
1175   2              /* Clear the data toggle */
1176   2              USBUART_EP[ep].epToggle = 0u;
1177   2              
1178   2              /* Clear toggle bit for already armed packet */
1179   2              USBUART_SIE_EP_BASE.sieEp[ep].epCnt0 = (uint8) ~(uint8)USBUART_EPX_CNT_DATA_TOGGLE;
1180   2              
1181   2              /* Return API State as it was defined before */
1182   2              USBUART_EP[ep].apiEpState &= (uint8) ~USBUART_NO_EVENT_ALLOWED;
1183   2      
1184   2              if ((USBUART_EP[ep].addr & USBUART_DIR_IN) != 0u)
1185   2              {
1186   3                  /* IN Endpoint */
1187   3                  if(USBUART_EP[ep].apiEpState == USBUART_IN_BUFFER_EMPTY)
1188   3                  {       
1189   4                      /* Wait for next packet from application */
1190   4                      USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_NAK_IN;
1191   4                  }
1192   3                  else    /* Continue armed transfer */
1193   3                  {
1194   4                      USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_ACK_IN;
1195   4                  }
1196   3              }
1197   2              else
1198   2              {
1199   3                  /* OUT Endpoint */
1200   3                  if (USBUART_EP[ep].apiEpState == USBUART_OUT_BUFFER_FULL)
1201   3                  {       
1202   4                      /* Allow application to read full buffer */
1203   4                      USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_NAK_OUT;
1204   4                  }
1205   3                  else    /* Mark endpoint as empty, so it will be reloaded */
1206   3                  {
1207   4                      USBUART_SIE_EP_BASE.sieEp[ep].epCr0 = USBUART_MODE_ACK_OUT;
1208   4                  }
1209   3              }
1210   2              
1211   2              requestHandled = USBUART_InitNoDataControlTransfer();
1212   2          }
1213   1      
1214   1          return(requestHandled);
1215   1      }
1216          
1217          
1218          /*******************************************************************************
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 21  

1219          * Function Name: USBUART_ValidateAlternateSetting
1220          ****************************************************************************//**
1221          *
1222          *  Validates (and records) a SET INTERFACE request.
1223          *
1224          * \return
1225          *  requestHandled.
1226          *
1227          * \reentrant
1228          *  No.
1229          *
1230          *******************************************************************************/
1231          uint8 USBUART_ValidateAlternateSetting(void) 
1232          {
1233   1          uint8 requestHandled = USBUART_FALSE;
1234   1          
1235   1          uint8 interfaceNum;
1236   1          uint8 curInterfacesNum;
1237   1          const T_USBUART_LUT CYCODE *pTmp;
1238   1          
1239   1          /* Get interface number from the request. */
1240   1          interfaceNum = (uint8) USBUART_wIndexLoReg;
1241   1          
1242   1          /* Get number of interfaces for current configuration. */
1243   1          pTmp = USBUART_GetConfigTablePtr(USBUART_configuration - 1u);
1244   1          curInterfacesNum  = ((const uint8 *) pTmp->p_list)[USBUART_CONFIG_DESCR_NUM_INTERFACES];
1245   1      
1246   1          /* Validate that interface number is within range. */
1247   1          if ((interfaceNum <= curInterfacesNum) || (interfaceNum <= USBUART_MAX_INTERFACES_NUMBER))
1248   1          {
1249   2              /* Save current and new alternate settings (come with request) to make 
1250   2              * desicion about following endpoint re-configuration.
1251   2              */
1252   2              USBUART_interfaceSettingLast[interfaceNum] = USBUART_interfaceSetting[interfaceNum];
1253   2              USBUART_interfaceSetting[interfaceNum]     = (uint8) USBUART_wValueLoReg;
1254   2              
1255   2              requestHandled = USBUART_TRUE;
1256   2          }
1257   1      
1258   1          return (requestHandled);
1259   1      }
1260          
1261          
1262          /* [] END OF FILE */
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 22  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION USBUART_HandleStandardRqst (BEGIN)
                                           ; SOURCE LINE # 84
                                           ; SOURCE LINE # 85
                                           ; SOURCE LINE # 86
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 89
0005 906000            MOV     DPTR,#06000H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A 900000      R     MOV     DPTR,#bmRequestType
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 92
000F 7B00              MOV     R3,#00H
0011 7A00              MOV     R2,#00H
0013 7900              MOV     R1,#00H
0015 900000      R     MOV     DPTR,#pStr
0018 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 102
001B 900000      E     MOV     DPTR,#USBUART_currentTD
001E E4                CLR     A
001F F0                MOVX    @DPTR,A
0020 A3                INC     DPTR
0021 E4                CLR     A
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 104
0023 900000      R     MOV     DPTR,#bmRequestType
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 EF                MOV     A,R7
0029 5480              ANL     A,#080H
002B FF                MOV     R7,A
002C 7E00              MOV     R6,#00H
002E EF                MOV     A,R7
002F 6480              XRL     A,#080H
0031 4E                ORL     A,R6
0032 6003              JZ      $ + 5H
0034 020000      R     LJMP    ?C0001
                                           ; SOURCE LINE # 105
                                           ; SOURCE LINE # 107
0037 906001            MOV     DPTR,#06001H
003A E0                MOVX    A,@DPTR
003B FF                MOV     R7,A
003C EF                MOV     A,R7
003D 120000      E     LCALL   ?C?CCASE
0040 0000        R     DW      ?C0016
0042 00                DB      00H
0043 0000        R     DW      ?C0003
0045 06                DB      06H
0046 0000        R     DW      ?C0021
0048 08                DB      08H
0049 0000        R     DW      ?C0022
004B 0A                DB      0AH
004C 0000              DW      00H
004E 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 108
                                           ; SOURCE LINE # 109
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 23  

0050         ?C0003:
                                           ; SOURCE LINE # 110
0050 906003            MOV     DPTR,#06003H
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 EF                MOV     A,R7
0056 B40135            CJNE    A,#01H,?C0004
                                           ; SOURCE LINE # 111
                                           ; SOURCE LINE # 112
0059 120000      R     LCALL   USBUART_GetDeviceTablePtr
005C 900000      R     MOV     DPTR,#pTmp
005F EE                MOV     A,R6
0060 F0                MOVX    @DPTR,A
0061 A3                INC     DPTR
0062 EF                MOV     A,R7
0063 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 113
0064 900000      R     MOV     DPTR,#pTmp
0067 E0                MOVX    A,@DPTR
0068 FE                MOV     R6,A
0069 A3                INC     DPTR
006A E0                MOVX    A,@DPTR
006B FF                MOV     R7,A
006C 8F82              MOV     DPL,R7
006E 8E83              MOV     DPH,R6
0070 A3                INC     DPTR
0071 120000      E     LCALL   ?C?PLDCODE
0074 900000      E     MOV     DPTR,#USBUART_currentTD+02H
0077 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 114
007A 900000      E     MOV     DPTR,#USBUART_currentTD
007D E4                CLR     A
007E F0                MOVX    @DPTR,A
007F A3                INC     DPTR
0080 7412              MOV     A,#012H
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 116
0083 120000      E     LCALL   USBUART_InitControlRead
0086 900000      R     MOV     DPTR,#requestHandled
0089 EF                MOV     A,R7
008A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 117
008B 020000      R     LJMP    ?C0024
008E         ?C0004:
                                           ; SOURCE LINE # 118
008E 906003            MOV     DPTR,#06003H
0091 E0                MOVX    A,@DPTR
0092 FF                MOV     R7,A
0093 EF                MOV     A,R7
0094 6402              XRL     A,#02H
0096 707A              JNZ     ?C0006
                                           ; SOURCE LINE # 119
                                           ; SOURCE LINE # 120
0098 906002            MOV     DPTR,#06002H
009B E0                MOVX    A,@DPTR
009C FF                MOV     R7,A
009D 120000      R     LCALL   _USBUART_GetConfigTablePtr
00A0 900000      R     MOV     DPTR,#pTmp
00A3 EE                MOV     A,R6
00A4 F0                MOVX    @DPTR,A
00A5 A3                INC     DPTR
00A6 EF                MOV     A,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 24  

00A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 123
00A8 900000      R     MOV     DPTR,#pTmp
00AB E0                MOVX    A,@DPTR
00AC FE                MOV     R6,A
00AD A3                INC     DPTR
00AE E0                MOVX    A,@DPTR
00AF FF                MOV     R7,A
00B0 EF                MOV     A,R7
00B1 4E                ORL     A,R6
00B2 7003              JNZ     $ + 5H
00B4 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 124
                                           ; SOURCE LINE # 125
00B7 900000      R     MOV     DPTR,#pTmp
00BA E0                MOVX    A,@DPTR
00BB FE                MOV     R6,A
00BC A3                INC     DPTR
00BD E0                MOVX    A,@DPTR
00BE FF                MOV     R7,A
00BF 8F82              MOV     DPL,R7
00C1 8E83              MOV     DPH,R6
00C3 A3                INC     DPTR
00C4 120000      E     LCALL   ?C?PLDCODE
00C7 900000      E     MOV     DPTR,#USBUART_currentTD+02H
00CA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 126
00CD 900000      E     MOV     DPTR,#USBUART_currentTD+02H
00D0 120000      E     LCALL   ?C?PLDXDATA
00D3 E9                MOV     A,R1
00D4 2403              ADD     A,#03H
00D6 F9                MOV     R1,A
00D7 EA                MOV     A,R2
00D8 3400              ADDC    A,#00H
00DA FA                MOV     R2,A
00DB 120000      E     LCALL   ?C?CLDPTR
00DE FF                MOV     R7,A
00DF 7E00              MOV     R6,#00H
00E1 EF                MOV     A,R7
00E2 7F00              MOV     R7,#00H
00E4 FE                MOV     R6,A
00E5 900000      E     MOV     DPTR,#USBUART_currentTD+02H
00E8 120000      E     LCALL   ?C?PLDXDATA
00EB E9                MOV     A,R1
00EC 2402              ADD     A,#02H
00EE F9                MOV     R1,A
00EF EA                MOV     A,R2
00F0 3400              ADDC    A,#00H
00F2 FA                MOV     R2,A
00F3 120000      E     LCALL   ?C?CLDPTR
00F6 FD                MOV     R5,A
00F7 7C00              MOV     R4,#00H
00F9 EE                MOV     A,R6
00FA 4C                ORL     A,R4
00FB FE                MOV     R6,A
00FC EF                MOV     A,R7
00FD 4D                ORL     A,R5
00FE FF                MOV     R7,A
00FF 900000      E     MOV     DPTR,#USBUART_currentTD
0102 EE                MOV     A,R6
0103 F0                MOVX    @DPTR,A
0104 A3                INC     DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 25  

0105 EF                MOV     A,R7
0106 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 128
0107 120000      E     LCALL   USBUART_InitControlRead
010A 900000      R     MOV     DPTR,#requestHandled
010D EF                MOV     A,R7
010E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 129
                                           ; SOURCE LINE # 130
010F 020000      R     LJMP    ?C0024
0112         ?C0006:
                                           ; SOURCE LINE # 149
0112 906003            MOV     DPTR,#06003H
0115 E0                MOVX    A,@DPTR
0116 FF                MOV     R7,A
0117 EF                MOV     A,R7
0118 6403              XRL     A,#03H
011A 6003              JZ      $ + 5H
011C 020000      R     LJMP    ?C0009
                                           ; SOURCE LINE # 150
                                           ; SOURCE LINE # 153
011F 900000      R     MOV     DPTR,#nStr
0122 E4                CLR     A
0123 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 154
0124 7BFF              MOV     R3,#0FFH
0126 7A00        E     MOV     R2,#HIGH USBUART_STRING_DESCRIPTORS
0128 7900        E     MOV     R1,#LOW USBUART_STRING_DESCRIPTORS
012A 900000      R     MOV     DPTR,#pStr
012D 120000      E     LCALL   ?C?PSTXDATA
0130         ?C0010:
                                           ; SOURCE LINE # 156
0130 900000      R     MOV     DPTR,#nStr
0133 E0                MOVX    A,@DPTR
0134 FF                MOV     R7,A
0135 906002            MOV     DPTR,#06002H
0138 E0                MOVX    A,@DPTR
0139 FE                MOV     R6,A
013A EE                MOV     A,R6
013B D3                SETB    C
013C 9F                SUBB    A,R7
013D 403D              JC      ?C0011
013F 900000      R     MOV     DPTR,#pStr
0142 120000      E     LCALL   ?C?PLDXDATA
0145 120000      E     LCALL   ?C?CLDPTR
0148 FF                MOV     R7,A
0149 EF                MOV     A,R7
014A 6030              JZ      ?C0011
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 159
014C 900000      R     MOV     DPTR,#pStr
014F 120000      E     LCALL   ?C?PLDXDATA
0152 120000      E     LCALL   ?C?CLDPTR
0155 FF                MOV     R7,A
0156 900000      R     MOV     DPTR,#descrLength
0159 EF                MOV     A,R7
015A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 161
015B 900000      R     MOV     DPTR,#pStr
015E 120000      E     LCALL   ?C?PLDXDATA
0161 900000      R     MOV     DPTR,#descrLength
0164 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 26  

0165 FF                MOV     R7,A
0166 7E00              MOV     R6,#00H
0168 E9                MOV     A,R1
0169 2F                ADD     A,R7
016A F9                MOV     R1,A
016B EA                MOV     A,R2
016C 3E                ADDC    A,R6
016D FA                MOV     R2,A
016E 900000      R     MOV     DPTR,#pStr
0171 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 162
0174 900000      R     MOV     DPTR,#nStr
0177 E0                MOVX    A,@DPTR
0178 04                INC     A
0179 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 163
017A 80B4              SJMP    ?C0010
017C         ?C0011:
                                           ; SOURCE LINE # 168
017C 906002            MOV     DPTR,#06002H
017F E0                MOVX    A,@DPTR
0180 FF                MOV     R7,A
0181 EF                MOV     A,R7
0182 B4EE0C            CJNE    A,#0EEH,?C0012
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
0185 7BFF              MOV     R3,#0FFH
0187 7A00        E     MOV     R2,#HIGH USBUART_MSOS_DESCRIPTOR
0189 7900        E     MOV     R1,#LOW USBUART_MSOS_DESCRIPTOR
018B 900000      R     MOV     DPTR,#pStr
018E 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 171
0191         ?C0012:
                                           ; SOURCE LINE # 177
0191 906002            MOV     DPTR,#06002H
0194 E0                MOVX    A,@DPTR
0195 FF                MOV     R7,A
0196 EF                MOV     A,R7
0197 6024              JZ      ?C0013
0199 900000      E     MOV     DPTR,#USBUART_DEVICE0_DESCR+010H
019C E4                CLR     A
019D 93                MOVC    A,@A+DPTR
019E FF                MOV     R7,A
019F 906002            MOV     DPTR,#06002H
01A2 E0                MOVX    A,@DPTR
01A3 FE                MOV     R6,A
01A4 EE                MOV     A,R6
01A5 B50715            CJNE    A,AR7,?C0013
                                           ; SOURCE LINE # 178
                                           ; SOURCE LINE # 181
01A8 7B01              MOV     R3,#01H
01AA 7A00        E     MOV     R2,#HIGH USBUART_idSerialNumberStringDescriptor
01AC 7900        E     MOV     R1,#LOW USBUART_idSerialNumberStringDescriptor
01AE 120000      R     LCALL   _USBUART_ReadDieID
                                           ; SOURCE LINE # 182
01B1 7B01              MOV     R3,#01H
01B3 7A00        E     MOV     R2,#HIGH USBUART_idSerialNumberStringDescriptor
01B5 7900        E     MOV     R1,#LOW USBUART_idSerialNumberStringDescriptor
01B7 900000      R     MOV     DPTR,#pStr
01BA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 196
01BD         ?C0013:
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 27  

                                           ; SOURCE LINE # 199
01BD 900000      R     MOV     DPTR,#pStr
01C0 120000      E     LCALL   ?C?PLDXDATA
01C3 120000      E     LCALL   ?C?CLDPTR
01C6 FF                MOV     R7,A
01C7 EF                MOV     A,R7
01C8 7003              JNZ     $ + 5H
01CA 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 201
01CD 900000      R     MOV     DPTR,#pStr
01D0 120000      E     LCALL   ?C?PLDXDATA
01D3 120000      E     LCALL   ?C?CLDPTR
01D6 FF                MOV     R7,A
01D7 7E00              MOV     R6,#00H
01D9 900000      E     MOV     DPTR,#USBUART_currentTD
01DC EE                MOV     A,R6
01DD F0                MOVX    @DPTR,A
01DE A3                INC     DPTR
01DF EF                MOV     A,R7
01E0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 202
01E1 900000      R     MOV     DPTR,#pStr
01E4 120000      E     LCALL   ?C?PLDXDATA
01E7 900000      E     MOV     DPTR,#USBUART_currentTD+02H
01EA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 203
01ED 120000      E     LCALL   USBUART_InitControlRead
01F0 900000      R     MOV     DPTR,#requestHandled
01F3 EF                MOV     A,R7
01F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
01F5 020000      R     LJMP    ?C0024
01F8         ?C0009:
                                           ; SOURCE LINE # 208
                                           ; SOURCE LINE # 209
01F8 120000      E     LCALL   USBUART_DispatchClassRqst
01FB 900000      R     MOV     DPTR,#requestHandled
01FE EF                MOV     A,R7
01FF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 210
                                           ; SOURCE LINE # 211
0200 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 213
0203         ?C0016:
                                           ; SOURCE LINE # 214
0203 900000      R     MOV     DPTR,#bmRequestType
0206 E0                MOVX    A,@DPTR
0207 FF                MOV     R7,A
0208 EF                MOV     A,R7
0209 5403              ANL     A,#03H
020B FF                MOV     R7,A
020C EF                MOV     A,R7
020D 120000      E     LCALL   ?C?CCASE
0210 0000        R     DW      ?C0019
0212 00                DB      00H
0213 0000        R     DW      ?C0018
0215 02                DB      02H
0216 0000              DW      00H
0218 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 215
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 28  

                                           ; SOURCE LINE # 216
021A         ?C0018:
                                           ; SOURCE LINE # 217
021A 900000      E     MOV     DPTR,#USBUART_currentTD
021D E4                CLR     A
021E F0                MOVX    @DPTR,A
021F A3                INC     DPTR
0220 7402              MOV     A,#02H
0222 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 218
0223 906004            MOV     DPTR,#06004H
0226 E0                MOVX    A,@DPTR
0227 FF                MOV     R7,A
0228 EF                MOV     A,R7
0229 547F              ANL     A,#07FH
022B FF                MOV     R7,A
022C EF                MOV     A,R7
022D 75F00B            MOV     B,#0BH
0230 A4                MUL     AB
0231 2400        E     ADD     A,#LOW USBUART_EP+02H
0233 F582              MOV     DPL,A
0235 E4                CLR     A
0236 3400        E     ADDC    A,#HIGH USBUART_EP+02H
0238 F583              MOV     DPH,A
023A E0                MOVX    A,@DPTR
023B FF                MOV     R7,A
023C 900000      R     MOV     DPTR,#USBUART_tBuffer
023F EF                MOV     A,R7
0240 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 219
0241 900000      R     MOV     DPTR,#USBUART_tBuffer+01H
0244 E4                CLR     A
0245 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 220
0246 7B01              MOV     R3,#01H
0248 7A00        R     MOV     R2,#HIGH USBUART_tBuffer
024A 7900        R     MOV     R1,#LOW USBUART_tBuffer
024C 900000      E     MOV     DPTR,#USBUART_currentTD+02H
024F 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 222
0252 120000      E     LCALL   USBUART_InitControlRead
0255 900000      R     MOV     DPTR,#requestHandled
0258 EF                MOV     A,R7
0259 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 223
025A 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 224
025D         ?C0019:
                                           ; SOURCE LINE # 225
025D 900000      E     MOV     DPTR,#USBUART_currentTD
0260 E4                CLR     A
0261 F0                MOVX    @DPTR,A
0262 A3                INC     DPTR
0263 7402              MOV     A,#02H
0265 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 226
0266 900000      E     MOV     DPTR,#USBUART_deviceStatus
0269 E0                MOVX    A,@DPTR
026A FF                MOV     R7,A
026B 900000      R     MOV     DPTR,#USBUART_tBuffer
026E EF                MOV     A,R7
026F F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 29  

                                           ; SOURCE LINE # 227
0270 900000      R     MOV     DPTR,#USBUART_tBuffer+01H
0273 E4                CLR     A
0274 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 228
0275 7B01              MOV     R3,#01H
0277 7A00        R     MOV     R2,#HIGH USBUART_tBuffer
0279 7900        R     MOV     R1,#LOW USBUART_tBuffer
027B 900000      E     MOV     DPTR,#USBUART_currentTD+02H
027E 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 230
0281 120000      E     LCALL   USBUART_InitControlRead
0284 900000      R     MOV     DPTR,#requestHandled
0287 EF                MOV     A,R7
0288 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 231
0289 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 232
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
                                           ; SOURCE LINE # 235
028C 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 237
028F         ?C0021:
                                           ; SOURCE LINE # 238
028F 900000      E     MOV     DPTR,#USBUART_currentTD
0292 E4                CLR     A
0293 F0                MOVX    @DPTR,A
0294 A3                INC     DPTR
0295 7401              MOV     A,#01H
0297 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 239
0298 7B01              MOV     R3,#01H
029A 7A00        E     MOV     R2,#HIGH USBUART_configuration
029C 7900        E     MOV     R1,#LOW USBUART_configuration
029E 900000      E     MOV     DPTR,#USBUART_currentTD+02H
02A1 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 240
02A4 120000      E     LCALL   USBUART_InitControlRead
02A7 900000      R     MOV     DPTR,#requestHandled
02AA EF                MOV     A,R7
02AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 241
02AC 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 243
02AF         ?C0022:
                                           ; SOURCE LINE # 244
02AF 900000      E     MOV     DPTR,#USBUART_currentTD
02B2 E4                CLR     A
02B3 F0                MOVX    @DPTR,A
02B4 A3                INC     DPTR
02B5 7401              MOV     A,#01H
02B7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 245
02B8 906004            MOV     DPTR,#06004H
02BB E0                MOVX    A,@DPTR
02BC FF                MOV     R7,A
02BD 7400        E     MOV     A,#LOW USBUART_interfaceSetting
02BF 2F                ADD     A,R7
02C0 F9                MOV     R1,A
02C1 E4                CLR     A
02C2 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 30  

02C4 FA                MOV     R2,A
02C5 7B01              MOV     R3,#01H
02C7 900000      E     MOV     DPTR,#USBUART_currentTD+02H
02CA 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 246
02CD 120000      E     LCALL   USBUART_InitControlRead
02D0 900000      R     MOV     DPTR,#requestHandled
02D3 EF                MOV     A,R7
02D4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 247
02D5 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 250
                                           ; SOURCE LINE # 251
                                           ; SOURCE LINE # 252
02D8 020000      R     LJMP    ?C0024
02DB         ?C0001:
                                           ; SOURCE LINE # 254
                                           ; SOURCE LINE # 256
02DB 906001            MOV     DPTR,#06001H
02DE E0                MOVX    A,@DPTR
02DF FF                MOV     R7,A
02E0 EF                MOV     A,R7
02E1 120000      E     LCALL   ?C?CCASE
02E4 0000        R     DW      ?C0036
02E6 01                DB      01H
02E7 0000        R     DW      ?C0045
02E9 03                DB      03H
02EA 0000        R     DW      ?C0026
02EC 05                DB      05H
02ED 0000        R     DW      ?C0027
02EF 09                DB      09H
02F0 0000        R     DW      ?C0033
02F2 0B                DB      0BH
02F3 0000              DW      00H
02F5 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 257
                                           ; SOURCE LINE # 258
02F7         ?C0026:
                                           ; SOURCE LINE # 260
02F7 906002            MOV     DPTR,#06002H
02FA E0                MOVX    A,@DPTR
02FB FF                MOV     R7,A
02FC 900000      E     MOV     DPTR,#USBUART_deviceAddress
02FF EF                MOV     A,R7
0300 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 261
0301 120000      E     LCALL   USBUART_InitNoDataControlTransfer
0304 900000      R     MOV     DPTR,#requestHandled
0307 EF                MOV     A,R7
0308 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 262
0309 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 264
030C         ?C0027:
                                           ; SOURCE LINE # 265
030C 906002            MOV     DPTR,#06002H
030F E0                MOVX    A,@DPTR
0310 FF                MOV     R7,A
0311 900000      R     MOV     DPTR,#configurationN
0314 EF                MOV     A,R7
0315 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 31  

                                           ; SOURCE LINE # 268
0316 900000      R     MOV     DPTR,#configurationN
0319 E0                MOVX    A,@DPTR
031A FF                MOV     R7,A
031B EF                MOV     A,R7
031C D3                SETB    C
031D 9400              SUBB    A,#00H
031F 4013              JC      ?C0028
                                           ; SOURCE LINE # 269
                                           ; SOURCE LINE # 270
0321 900000      R     MOV     DPTR,#configurationN
0324 E0                MOVX    A,@DPTR
0325 FF                MOV     R7,A
0326 EF                MOV     A,R7
0327 14                DEC     A
0328 FF                MOV     R7,A
0329 120000      R     LCALL   _USBUART_GetConfigTablePtr
032C 900000      R     MOV     DPTR,#pTmp
032F EE                MOV     A,R6
0330 F0                MOVX    @DPTR,A
0331 A3                INC     DPTR
0332 EF                MOV     A,R7
0333 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 271
0334         ?C0028:
                                           ; SOURCE LINE # 274
0334 900000      R     MOV     DPTR,#configurationN
0337 E0                MOVX    A,@DPTR
0338 FF                MOV     R7,A
0339 EF                MOV     A,R7
033A D3                SETB    C
033B 9400              SUBB    A,#00H
033D 400C              JC      ?C0031
033F 900000      R     MOV     DPTR,#pTmp
0342 E0                MOVX    A,@DPTR
0343 FE                MOV     R6,A
0344 A3                INC     DPTR
0345 E0                MOVX    A,@DPTR
0346 FF                MOV     R7,A
0347 EF                MOV     A,R7
0348 4E                ORL     A,R6
0349 700B              JNZ     ?C0030
034B         ?C0031:
034B 900000      R     MOV     DPTR,#configurationN
034E E0                MOVX    A,@DPTR
034F FF                MOV     R7,A
0350 EF                MOV     A,R7
0351 6003              JZ      $ + 5H
0353 020000      R     LJMP    ?C0024
0356         ?C0030:
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 277
0356 900000      E     MOV     DPTR,#USBUART_configuration
0359 E0                MOVX    A,@DPTR
035A FF                MOV     R7,A
035B 900000      R     MOV     DPTR,#configurationN
035E E0                MOVX    A,@DPTR
035F FE                MOV     R6,A
0360 EE                MOV     A,R6
0361 6F                XRL     A,R7
0362 6015              JZ      ?C0032
                                           ; SOURCE LINE # 278
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 32  

                                           ; SOURCE LINE # 279
0364 900000      R     MOV     DPTR,#configurationN
0367 E0                MOVX    A,@DPTR
0368 FF                MOV     R7,A
0369 900000      E     MOV     DPTR,#USBUART_configuration
036C EF                MOV     A,R7
036D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 280
036E 900000      E     MOV     DPTR,#USBUART_configurationChanged
0371 7401              MOV     A,#01H
0373 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 281
0374 7F01              MOV     R7,#01H
0376 120000      R     LCALL   _USBUART_Config
                                           ; SOURCE LINE # 282
0379         ?C0032:
                                           ; SOURCE LINE # 283
0379 120000      E     LCALL   USBUART_InitNoDataControlTransfer
037C 900000      R     MOV     DPTR,#requestHandled
037F EF                MOV     A,R7
0380 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
                                           ; SOURCE LINE # 285
0381 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 287
0384         ?C0033:
                                           ; SOURCE LINE # 288
0384 120000      R     LCALL   USBUART_ValidateAlternateSetting
0387 EF                MOV     A,R7
0388 7003              JNZ     $ + 5H
038A 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 289
                                           ; SOURCE LINE # 291
038D 906004            MOV     DPTR,#06004H
0390 E0                MOVX    A,@DPTR
0391 FF                MOV     R7,A
0392 900000      R     MOV     DPTR,#interfaceNumber
0395 EF                MOV     A,R7
0396 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
0397 906004            MOV     DPTR,#06004H
039A E0                MOVX    A,@DPTR
039B FF                MOV     R7,A
039C 900000      E     MOV     DPTR,#USBUART_interfaceNumber
039F EF                MOV     A,R7
03A0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 295
03A1 900000      R     MOV     DPTR,#interfaceNumber
03A4 E0                MOVX    A,@DPTR
03A5 FF                MOV     R7,A
03A6 7400        E     MOV     A,#LOW USBUART_interfaceSetting
03A8 2F                ADD     A,R7
03A9 F582              MOV     DPL,A
03AB E4                CLR     A
03AC 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
03AE F583              MOV     DPH,A
03B0 E0                MOVX    A,@DPTR
03B1 FF                MOV     R7,A
03B2 900000      R     MOV     DPTR,#interfaceNumber
03B5 E0                MOVX    A,@DPTR
03B6 FE                MOV     R6,A
03B7 7400        E     MOV     A,#LOW USBUART_interfaceSettingLast
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 33  

03B9 2E                ADD     A,R6
03BA F582              MOV     DPL,A
03BC E4                CLR     A
03BD 3400        E     ADDC    A,#HIGH USBUART_interfaceSettingLast
03BF F583              MOV     DPH,A
03C1 E0                MOVX    A,@DPTR
03C2 FE                MOV     R6,A
03C3 EE                MOV     A,R6
03C4 6F                XRL     A,R7
03C5 6009              JZ      ?C0035
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
03C7 900000      E     MOV     DPTR,#USBUART_configurationChanged
03CA 7401              MOV     A,#01H
03CC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 303
03CD 120000      R     LCALL   USBUART_ConfigAltChanged
                                           ; SOURCE LINE # 305
03D0         ?C0035:
                                           ; SOURCE LINE # 307
03D0 120000      E     LCALL   USBUART_InitNoDataControlTransfer
03D3 900000      R     MOV     DPTR,#requestHandled
03D6 EF                MOV     A,R7
03D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 308
                                           ; SOURCE LINE # 309
03D8 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 311
03DB         ?C0036:
                                           ; SOURCE LINE # 312
03DB 900000      R     MOV     DPTR,#bmRequestType
03DE E0                MOVX    A,@DPTR
03DF FF                MOV     R7,A
03E0 EF                MOV     A,R7
03E1 5403              ANL     A,#03H
03E3 FF                MOV     R7,A
03E4 EF                MOV     A,R7
03E5 120000      E     LCALL   ?C?CCASE
03E8 0000        R     DW      ?C0040
03EA 00                DB      00H
03EB 0000        R     DW      ?C0042
03ED 01                DB      01H
03EE 0000        R     DW      ?C0038
03F0 02                DB      02H
03F1 0000              DW      00H
03F3 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 313
                                           ; SOURCE LINE # 314
03F5         ?C0038:
                                           ; SOURCE LINE # 315
03F5 906002            MOV     DPTR,#06002H
03F8 E0                MOVX    A,@DPTR
03F9 FF                MOV     R7,A
03FA EF                MOV     A,R7
03FB 6003              JZ      $ + 5H
03FD 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
0400 120000      R     LCALL   USBUART_ClearEndpointHalt
0403 900000      R     MOV     DPTR,#requestHandled
0406 EF                MOV     A,R7
0407 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 34  

                                           ; SOURCE LINE # 318
                                           ; SOURCE LINE # 319
0408 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 320
040B         ?C0040:
                                           ; SOURCE LINE # 322
040B 906002            MOV     DPTR,#06002H
040E E0                MOVX    A,@DPTR
040F FF                MOV     R7,A
0410 EF                MOV     A,R7
0411 6401              XRL     A,#01H
0413 6003              JZ      $ + 5H
0415 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 323
                                           ; SOURCE LINE # 324
0418 900000      E     MOV     DPTR,#USBUART_deviceStatus
041B E0                MOVX    A,@DPTR
041C FF                MOV     R7,A
041D EF                MOV     A,R7
041E 54FD              ANL     A,#0FDH
0420 FF                MOV     R7,A
0421 900000      E     MOV     DPTR,#USBUART_deviceStatus
0424 EF                MOV     A,R7
0425 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 325
0426 120000      E     LCALL   USBUART_InitNoDataControlTransfer
0429 900000      R     MOV     DPTR,#requestHandled
042C EF                MOV     A,R7
042D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 326
                                           ; SOURCE LINE # 327
042E 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 328
0431         ?C0042:
                                           ; SOURCE LINE # 330
0431 906004            MOV     DPTR,#06004H
0434 E0                MOVX    A,@DPTR
0435 FF                MOV     R7,A
0436 EF                MOV     A,R7
0437 C3                CLR     C
0438 9402              SUBB    A,#02H
043A 4003              JC      $ + 5H
043C 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 331
                                           ; SOURCE LINE # 332
043F 906004            MOV     DPTR,#06004H
0442 E0                MOVX    A,@DPTR
0443 FF                MOV     R7,A
0444 7400        E     MOV     A,#LOW USBUART_interfaceStatus
0446 2F                ADD     A,R7
0447 F582              MOV     DPL,A
0449 E4                CLR     A
044A 3400        E     ADDC    A,#HIGH USBUART_interfaceStatus
044C F583              MOV     DPH,A
044E C083              PUSH    DPH
0450 C082              PUSH    DPL
0452 E0                MOVX    A,@DPTR
0453 FF                MOV     R7,A
0454 906002            MOV     DPTR,#06002H
0457 E0                MOVX    A,@DPTR
0458 FE                MOV     R6,A
0459 EE                MOV     A,R6
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 35  

045A F4                CPL     A
045B FE                MOV     R6,A
045C EF                MOV     A,R7
045D 5E                ANL     A,R6
045E FF                MOV     R7,A
045F D082              POP     DPL
0461 D083              POP     DPH
0463 EF                MOV     A,R7
0464 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 333
0465 120000      E     LCALL   USBUART_InitNoDataControlTransfer
0468 900000      R     MOV     DPTR,#requestHandled
046B EF                MOV     A,R7
046C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 334
                                           ; SOURCE LINE # 335
046D 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 336
                                           ; SOURCE LINE # 337
                                           ; SOURCE LINE # 338
                                           ; SOURCE LINE # 339
0470 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 341
0473         ?C0045:
                                           ; SOURCE LINE # 342
0473 900000      R     MOV     DPTR,#bmRequestType
0476 E0                MOVX    A,@DPTR
0477 FF                MOV     R7,A
0478 EF                MOV     A,R7
0479 5403              ANL     A,#03H
047B FF                MOV     R7,A
047C EF                MOV     A,R7
047D 120000      E     LCALL   ?C?CCASE
0480 0000        R     DW      ?C0049
0482 00                DB      00H
0483 0000        R     DW      ?C0051
0485 01                DB      01H
0486 0000        R     DW      ?C0047
0488 02                DB      02H
0489 0000              DW      00H
048B 0000        R     DW      ?C0024
                                           ; SOURCE LINE # 343
                                           ; SOURCE LINE # 344
048D         ?C0047:
                                           ; SOURCE LINE # 345
048D 906002            MOV     DPTR,#06002H
0490 E0                MOVX    A,@DPTR
0491 FF                MOV     R7,A
0492 EF                MOV     A,R7
0493 7065              JNZ     ?C0024
                                           ; SOURCE LINE # 346
                                           ; SOURCE LINE # 347
0495 120000      R     LCALL   USBUART_SetEndpointHalt
0498 900000      R     MOV     DPTR,#requestHandled
049B EF                MOV     A,R7
049C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 348
                                           ; SOURCE LINE # 349
049D 805B              SJMP    ?C0024
                                           ; SOURCE LINE # 351
049F         ?C0049:
                                           ; SOURCE LINE # 353
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 36  

049F 906002            MOV     DPTR,#06002H
04A2 E0                MOVX    A,@DPTR
04A3 FF                MOV     R7,A
04A4 EF                MOV     A,R7
04A5 6401              XRL     A,#01H
04A7 7051              JNZ     ?C0024
                                           ; SOURCE LINE # 354
                                           ; SOURCE LINE # 355
04A9 900000      E     MOV     DPTR,#USBUART_deviceStatus
04AC E0                MOVX    A,@DPTR
04AD FF                MOV     R7,A
04AE EF                MOV     A,R7
04AF 4402              ORL     A,#02H
04B1 FF                MOV     R7,A
04B2 900000      E     MOV     DPTR,#USBUART_deviceStatus
04B5 EF                MOV     A,R7
04B6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 356
04B7 120000      E     LCALL   USBUART_InitNoDataControlTransfer
04BA 900000      R     MOV     DPTR,#requestHandled
04BD EF                MOV     A,R7
04BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 357
                                           ; SOURCE LINE # 358
04BF 8039              SJMP    ?C0024
                                           ; SOURCE LINE # 360
04C1         ?C0051:
                                           ; SOURCE LINE # 362
04C1 906004            MOV     DPTR,#06004H
04C4 E0                MOVX    A,@DPTR
04C5 FF                MOV     R7,A
04C6 EF                MOV     A,R7
04C7 C3                CLR     C
04C8 9402              SUBB    A,#02H
04CA 502E              JNC     ?C0024
                                           ; SOURCE LINE # 363
                                           ; SOURCE LINE # 364
04CC 906004            MOV     DPTR,#06004H
04CF E0                MOVX    A,@DPTR
04D0 FF                MOV     R7,A
04D1 7400        E     MOV     A,#LOW USBUART_interfaceStatus
04D3 2F                ADD     A,R7
04D4 F582              MOV     DPL,A
04D6 E4                CLR     A
04D7 3400        E     ADDC    A,#HIGH USBUART_interfaceStatus
04D9 F583              MOV     DPH,A
04DB C083              PUSH    DPH
04DD C082              PUSH    DPL
04DF E0                MOVX    A,@DPTR
04E0 FF                MOV     R7,A
04E1 906002            MOV     DPTR,#06002H
04E4 E0                MOVX    A,@DPTR
04E5 FE                MOV     R6,A
04E6 EE                MOV     A,R6
04E7 F4                CPL     A
04E8 FE                MOV     R6,A
04E9 EF                MOV     A,R7
04EA 5E                ANL     A,R6
04EB FF                MOV     R7,A
04EC D082              POP     DPL
04EE D083              POP     DPH
04F0 EF                MOV     A,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 37  

04F1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
04F2 120000      E     LCALL   USBUART_InitNoDataControlTransfer
04F5 900000      R     MOV     DPTR,#requestHandled
04F8 EF                MOV     A,R7
04F9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 366
                                           ; SOURCE LINE # 367
                                           ; SOURCE LINE # 369
                                           ; SOURCE LINE # 370
                                           ; SOURCE LINE # 371
                                           ; SOURCE LINE # 372
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
                                           ; SOURCE LINE # 377
04FA         ?C0024:
                                           ; SOURCE LINE # 379
04FA 900000      R     MOV     DPTR,#requestHandled
04FD E0                MOVX    A,@DPTR
04FE FF                MOV     R7,A
                                           ; SOURCE LINE # 380
04FF         ?C0055:
04FF 22                RET     
             ; FUNCTION USBUART_HandleStandardRqst (END)

             ; FUNCTION _USBUART_ReadDieID (BEGIN)
                                           ; SOURCE LINE # 398
0000 900000      R     MOV     DPTR,#descr
0003 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 399
                                           ; SOURCE LINE # 402
0006 900000      R     MOV     DPTR,#j
0009 E4                CLR     A
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 405
000B 7B00              MOV     R3,#00H
000D 7A00              MOV     R2,#00H
000F 7900              MOV     R1,#00H
0011 C003              PUSH    AR3
0013 C002              PUSH    AR2
0015 C001              PUSH    AR1
0017 900000      R     MOV     DPTR,#descr
001A 120000      E     LCALL   ?C?PLDXDATA
001D D082              POP     DPL
001F D083              POP     DPH
0021 D0E0              POP     ACC
0023 6B                XRL     A,R3
0024 7008              JNZ     ?C0147
0026 E9                MOV     A,R1
0027 6582              XRL     A,DPL
0029 7003              JNZ     ?C0147
002B EA                MOV     A,R2
002C 6583              XRL     A,DPH
002E         ?C0147:
002E 7003              JNZ     $ + 5H
0030 020000      R     LJMP    ?C0060
                                           ; SOURCE LINE # 406
                                           ; SOURCE LINE # 408
0033 900000      R     MOV     DPTR,#descr
0036 120000      E     LCALL   ?C?PLDXDATA
0039 7422              MOV     A,#022H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 38  

003B 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 409
003E 900000      R     MOV     DPTR,#descr
0041 120000      E     LCALL   ?C?PLDXDATA
0044 E9                MOV     A,R1
0045 2401              ADD     A,#01H
0047 F9                MOV     R1,A
0048 EA                MOV     A,R2
0049 3400              ADDC    A,#00H
004B FA                MOV     R2,A
004C 7403              MOV     A,#03H
004E 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 412
0051 7B01              MOV     R3,#01H
0053 7A00        R     MOV     R2,#HIGH uniqueId
0055 7900        R     MOV     R1,#LOW uniqueId
0057 120000      E     LCALL   _CyGetUniqueId
                                           ; SOURCE LINE # 415
005A 900000      R     MOV     DPTR,#i
005D 7402              MOV     A,#02H
005F F0                MOVX    @DPTR,A
0060         ?C0057:
0060 900000      R     MOV     DPTR,#i
0063 E0                MOVX    A,@DPTR
0064 FF                MOV     R7,A
0065 EF                MOV     A,R7
0066 C3                CLR     C
0067 9422              SUBB    A,#022H
0069 4003              JC      $ + 5H
006B 020000      R     LJMP    ?C0060
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 417
006E 900000      R     MOV     DPTR,#j
0071 E0                MOVX    A,@DPTR
0072 FF                MOV     R7,A
0073 7400        R     MOV     A,#LOW uniqueId
0075 2F                ADD     A,R7
0076 F582              MOV     DPL,A
0078 E4                CLR     A
0079 3400        R     ADDC    A,#HIGH uniqueId
007B F583              MOV     DPH,A
007D E0                MOVX    A,@DPTR
007E FF                MOV     R7,A
007F EF                MOV     A,R7
0080 C4                SWAP    A
0081 540F              ANL     A,#0FH
0083 FF                MOV     R7,A
0084 EF                MOV     A,R7
0085 900000      R     MOV     DPTR,#hex
0088 93                MOVC    A,@A+DPTR
0089 FF                MOV     R7,A
008A 900000      R     MOV     DPTR,#descr
008D 120000      E     LCALL   ?C?PLDXDATA
0090 900000      R     MOV     DPTR,#i
0093 E0                MOVX    A,@DPTR
0094 FE                MOV     R6,A
0095 E9                MOV     A,R1
0096 2E                ADD     A,R6
0097 F9                MOV     R1,A
0098 E4                CLR     A
0099 3A                ADDC    A,R2
009A FA                MOV     R2,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 39  

009B EF                MOV     A,R7
009C 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 418
009F 900000      R     MOV     DPTR,#i
00A2 E0                MOVX    A,@DPTR
00A3 FF                MOV     R7,A
00A4 7E00              MOV     R6,#00H
00A6 EF                MOV     A,R7
00A7 2401              ADD     A,#01H
00A9 FF                MOV     R7,A
00AA EE                MOV     A,R6
00AB 3400              ADDC    A,#00H
00AD FE                MOV     R6,A
00AE 900000      R     MOV     DPTR,#descr
00B1 120000      E     LCALL   ?C?PLDXDATA
00B4 E9                MOV     A,R1
00B5 2F                ADD     A,R7
00B6 F9                MOV     R1,A
00B7 EA                MOV     A,R2
00B8 3E                ADDC    A,R6
00B9 FA                MOV     R2,A
00BA E4                CLR     A
00BB 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 419
00BE 900000      R     MOV     DPTR,#j
00C1 E0                MOVX    A,@DPTR
00C2 FF                MOV     R7,A
00C3 7400        R     MOV     A,#LOW uniqueId
00C5 2F                ADD     A,R7
00C6 F582              MOV     DPL,A
00C8 E4                CLR     A
00C9 3400        R     ADDC    A,#HIGH uniqueId
00CB F583              MOV     DPH,A
00CD E0                MOVX    A,@DPTR
00CE FF                MOV     R7,A
00CF EF                MOV     A,R7
00D0 540F              ANL     A,#0FH
00D2 FF                MOV     R7,A
00D3 EF                MOV     A,R7
00D4 900000      R     MOV     DPTR,#hex
00D7 93                MOVC    A,@A+DPTR
00D8 FF                MOV     R7,A
00D9 900000      R     MOV     DPTR,#i
00DC E0                MOVX    A,@DPTR
00DD FE                MOV     R6,A
00DE EE                MOV     A,R6
00DF FD                MOV     R5,A
00E0 7C00              MOV     R4,#00H
00E2 ED                MOV     A,R5
00E3 2402              ADD     A,#02H
00E5 FD                MOV     R5,A
00E6 EC                MOV     A,R4
00E7 3400              ADDC    A,#00H
00E9 FC                MOV     R4,A
00EA 900000      R     MOV     DPTR,#descr
00ED 120000      E     LCALL   ?C?PLDXDATA
00F0 E9                MOV     A,R1
00F1 2D                ADD     A,R5
00F2 F9                MOV     R1,A
00F3 EA                MOV     A,R2
00F4 3C                ADDC    A,R4
00F5 FA                MOV     R2,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 40  

00F6 EF                MOV     A,R7
00F7 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 420
00FA 900000      R     MOV     DPTR,#i
00FD E0                MOVX    A,@DPTR
00FE FF                MOV     R7,A
00FF 7E00              MOV     R6,#00H
0101 EF                MOV     A,R7
0102 2403              ADD     A,#03H
0104 FF                MOV     R7,A
0105 EE                MOV     A,R6
0106 3400              ADDC    A,#00H
0108 FE                MOV     R6,A
0109 900000      R     MOV     DPTR,#descr
010C 120000      E     LCALL   ?C?PLDXDATA
010F E9                MOV     A,R1
0110 2F                ADD     A,R7
0111 F9                MOV     R1,A
0112 EA                MOV     A,R2
0113 3E                ADDC    A,R6
0114 FA                MOV     R2,A
0115 E4                CLR     A
0116 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 421
0119 900000      R     MOV     DPTR,#j
011C E0                MOVX    A,@DPTR
011D 04                INC     A
011E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 422
011F 900000      R     MOV     DPTR,#i
0122 E0                MOVX    A,@DPTR
0123 2404              ADD     A,#04H
0125 F0                MOVX    @DPTR,A
0126 020000      R     LJMP    ?C0057
                                           ; SOURCE LINE # 423
                                           ; SOURCE LINE # 424
0129         ?C0060:
0129 22                RET     
             ; FUNCTION _USBUART_ReadDieID (END)

             ; FUNCTION USBUART_ConfigReg (BEGIN)
                                           ; SOURCE LINE # 437
                                           ; SOURCE LINE # 438
                                           ; SOURCE LINE # 446
0000 900000      R     MOV     DPTR,#ep
0003 7401              MOV     A,#01H
0005 F0                MOVX    @DPTR,A
0006         ?C0061:
0006 900000      R     MOV     DPTR,#ep
0009 E0                MOVX    A,@DPTR
000A FF                MOV     R7,A
000B EF                MOV     A,R7
000C C3                CLR     C
000D 9409              SUBB    A,#09H
000F 4003              JC      $ + 5H
0011 020000      R     LJMP    ?C0062
                                           ; SOURCE LINE # 447
                                           ; SOURCE LINE # 448
0014 900000      R     MOV     DPTR,#ep
0017 E0                MOVX    A,@DPTR
0018 FF                MOV     R7,A
0019 75F010            MOV     B,#010H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 41  

001C EF                MOV     A,R7
001D 906070            MOV     DPTR,#06070H
0020 120000      E     LCALL   ?C?OFFXADD
0023 740C              MOV     A,#0CH
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 455
0026 900000      R     MOV     DPTR,#ep
0029 E0                MOVX    A,@DPTR
002A FF                MOV     R7,A
002B EF                MOV     A,R7
002C 75F00B            MOV     B,#0BH
002F A4                MUL     AB
0030 2400        E     ADD     A,#LOW USBUART_EP+05H
0032 F582              MOV     DPL,A
0034 E4                CLR     A
0035 3400        E     ADDC    A,#HIGH USBUART_EP+05H
0037 F583              MOV     DPH,A
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B EF                MOV     A,R7
003C 6047              JZ      ?C0064
                                           ; SOURCE LINE # 456
                                           ; SOURCE LINE # 457
003E 900000      R     MOV     DPTR,#ep
0041 E0                MOVX    A,@DPTR
0042 FF                MOV     R7,A
0043 EF                MOV     A,R7
0044 75F00B            MOV     B,#0BH
0047 A4                MUL     AB
0048 2400        E     ADD     A,#LOW USBUART_EP+04H
004A F582              MOV     DPL,A
004C E4                CLR     A
004D 3400        E     ADDC    A,#HIGH USBUART_EP+04H
004F F583              MOV     DPH,A
0051 E0                MOVX    A,@DPTR
0052 FF                MOV     R7,A
0053 EF                MOV     A,R7
0054 5480              ANL     A,#080H
0056 FF                MOV     R7,A
0057 7E00              MOV     R6,#00H
0059 EF                MOV     A,R7
005A 4E                ORL     A,R6
005B 6014              JZ      ?C0065
                                           ; SOURCE LINE # 458
                                           ; SOURCE LINE # 459
005D 900000      R     MOV     DPTR,#ep
0060 E0                MOVX    A,@DPTR
0061 FF                MOV     R7,A
0062 75F010            MOV     B,#010H
0065 EF                MOV     A,R7
0066 905FFE            MOV     DPTR,#05FFEH
0069 120000      E     LCALL   ?C?OFFXADD
006C 740C              MOV     A,#0CH
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 465
006F 8026              SJMP    ?C0067
0071         ?C0065:
                                           ; SOURCE LINE # 467
                                           ; SOURCE LINE # 468
0071 900000      R     MOV     DPTR,#ep
0074 E0                MOVX    A,@DPTR
0075 FF                MOV     R7,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 42  

0076 75F010            MOV     B,#010H
0079 EF                MOV     A,R7
007A 905FFE            MOV     DPTR,#05FFEH
007D 120000      E     LCALL   ?C?OFFXADD
0080 7408              MOV     A,#08H
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 476
                                           ; SOURCE LINE # 477
0083 8012              SJMP    ?C0067
0085         ?C0064:
                                           ; SOURCE LINE # 479
                                           ; SOURCE LINE # 480
0085 900000      R     MOV     DPTR,#ep
0088 E0                MOVX    A,@DPTR
0089 FF                MOV     R7,A
008A 75F010            MOV     B,#010H
008D EF                MOV     A,R7
008E 905FFE            MOV     DPTR,#05FFEH
0091 120000      E     LCALL   ?C?OFFXADD
0094 7480              MOV     A,#080H
0096 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 481
0097         ?C0067:
                                           ; SOURCE LINE # 488
0097 900000      R     MOV     DPTR,#ep
009A E0                MOVX    A,@DPTR
009B FF                MOV     R7,A
009C EF                MOV     A,R7
009D 75F00B            MOV     B,#0BH
00A0 A4                MUL     AB
00A1 2400        E     ADD     A,#LOW USBUART_EP+06H
00A3 F582              MOV     DPL,A
00A5 E4                CLR     A
00A6 3400        E     ADDC    A,#HIGH USBUART_EP+06H
00A8 F583              MOV     DPH,A
00AA E0                MOVX    A,@DPTR
00AB FE                MOV     R6,A
00AC A3                INC     DPTR
00AD E0                MOVX    A,@DPTR
00AE FF                MOV     R7,A
00AF EF                MOV     A,R7
00B0 54FF              ANL     A,#0FFH
00B2 FF                MOV     R7,A
00B3 900000      R     MOV     DPTR,#ep
00B6 E0                MOVX    A,@DPTR
00B7 FE                MOV     R6,A
00B8 75F010            MOV     B,#010H
00BB EE                MOV     A,R6
00BC 906076            MOV     DPTR,#06076H
00BF 120000      E     LCALL   ?C?OFFXADD
00C2 EF                MOV     A,R7
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 489
00C4 900000      R     MOV     DPTR,#ep
00C7 E0                MOVX    A,@DPTR
00C8 FF                MOV     R7,A
00C9 EF                MOV     A,R7
00CA 75F00B            MOV     B,#0BH
00CD A4                MUL     AB
00CE 2400        E     ADD     A,#LOW USBUART_EP+06H
00D0 F582              MOV     DPL,A
00D2 E4                CLR     A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 43  

00D3 3400        E     ADDC    A,#HIGH USBUART_EP+06H
00D5 F583              MOV     DPH,A
00D7 E0                MOVX    A,@DPTR
00D8 FE                MOV     R6,A
00D9 A3                INC     DPTR
00DA E0                MOVX    A,@DPTR
00DB FF                MOV     R7,A
00DC EE                MOV     A,R6
00DD FF                MOV     R7,A
00DE 7E00              MOV     R6,#00H
00E0 900000      R     MOV     DPTR,#ep
00E3 E0                MOVX    A,@DPTR
00E4 FE                MOV     R6,A
00E5 75F010            MOV     B,#010H
00E8 EE                MOV     A,R6
00E9 906077            MOV     DPTR,#06077H
00EC 120000      E     LCALL   ?C?OFFXADD
00EF EF                MOV     A,R7
00F0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 490
00F1 900000      R     MOV     DPTR,#ep
00F4 E0                MOVX    A,@DPTR
00F5 FF                MOV     R7,A
00F6 EF                MOV     A,R7
00F7 75F00B            MOV     B,#0BH
00FA A4                MUL     AB
00FB 2400        E     ADD     A,#LOW USBUART_EP+06H
00FD F582              MOV     DPL,A
00FF E4                CLR     A
0100 3400        E     ADDC    A,#HIGH USBUART_EP+06H
0102 F583              MOV     DPH,A
0104 E0                MOVX    A,@DPTR
0105 FE                MOV     R6,A
0106 A3                INC     DPTR
0107 E0                MOVX    A,@DPTR
0108 FF                MOV     R7,A
0109 EF                MOV     A,R7
010A 54FF              ANL     A,#0FFH
010C FF                MOV     R7,A
010D 900000      R     MOV     DPTR,#ep
0110 E0                MOVX    A,@DPTR
0111 FE                MOV     R6,A
0112 75F010            MOV     B,#010H
0115 EE                MOV     A,R6
0116 906074            MOV     DPTR,#06074H
0119 120000      E     LCALL   ?C?OFFXADD
011C EF                MOV     A,R7
011D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 491
011E 900000      R     MOV     DPTR,#ep
0121 E0                MOVX    A,@DPTR
0122 FF                MOV     R7,A
0123 EF                MOV     A,R7
0124 75F00B            MOV     B,#0BH
0127 A4                MUL     AB
0128 2400        E     ADD     A,#LOW USBUART_EP+06H
012A F582              MOV     DPL,A
012C E4                CLR     A
012D 3400        E     ADDC    A,#HIGH USBUART_EP+06H
012F F583              MOV     DPH,A
0131 E0                MOVX    A,@DPTR
0132 FE                MOV     R6,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 44  

0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 FF                MOV     R7,A
0136 EE                MOV     A,R6
0137 FF                MOV     R7,A
0138 7E00              MOV     R6,#00H
013A 900000      R     MOV     DPTR,#ep
013D E0                MOVX    A,@DPTR
013E FE                MOV     R6,A
013F 75F010            MOV     B,#010H
0142 EE                MOV     A,R6
0143 906075            MOV     DPTR,#06075H
0146 120000      E     LCALL   ?C?OFFXADD
0149 EF                MOV     A,R7
014A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 494
014B 900000      R     MOV     DPTR,#ep
014E E0                MOVX    A,@DPTR
014F 04                INC     A
0150 F0                MOVX    @DPTR,A
0151 020000      R     LJMP    ?C0061
0154         ?C0062:
                                           ; SOURCE LINE # 519
0154 90600A            MOV     DPTR,#0600AH
0157 74FF              MOV     A,#0FFH
0159 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 520
015A 22                RET     
             ; FUNCTION USBUART_ConfigReg (END)

             ; FUNCTION USBUART_EpStateInit (BEGIN)
                                           ; SOURCE LINE # 532
                                           ; SOURCE LINE # 533
                                           ; SOURCE LINE # 536
0000 900000      R     MOV     DPTR,#i
0003 7401              MOV     A,#01H
0005 F0                MOVX    @DPTR,A
0006         ?C0069:
0006 900000      R     MOV     DPTR,#i
0009 E0                MOVX    A,@DPTR
000A FF                MOV     R7,A
000B EF                MOV     A,R7
000C C3                CLR     C
000D 9409              SUBB    A,#09H
000F 5054              JNC     ?C0074
                                           ; SOURCE LINE # 537
                                           ; SOURCE LINE # 538
0011 900000      R     MOV     DPTR,#i
0014 E0                MOVX    A,@DPTR
0015 FF                MOV     R7,A
0016 EF                MOV     A,R7
0017 75F00B            MOV     B,#0BH
001A A4                MUL     AB
001B 2400        E     ADD     A,#LOW USBUART_EP+04H
001D F582              MOV     DPL,A
001F E4                CLR     A
0020 3400        E     ADDC    A,#HIGH USBUART_EP+04H
0022 F583              MOV     DPH,A
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 5480              ANL     A,#080H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 45  

0029 FF                MOV     R7,A
002A 7E00              MOV     R6,#00H
002C EF                MOV     A,R7
002D 4E                ORL     A,R6
002E 6018              JZ      ?C0072
                                           ; SOURCE LINE # 539
                                           ; SOURCE LINE # 541
0030 900000      R     MOV     DPTR,#i
0033 E0                MOVX    A,@DPTR
0034 FF                MOV     R7,A
0035 EF                MOV     A,R7
0036 75F00B            MOV     B,#0BH
0039 A4                MUL     AB
003A 2400        E     ADD     A,#LOW USBUART_EP+01H
003C F582              MOV     DPL,A
003E E4                CLR     A
003F 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0041 F583              MOV     DPH,A
0043 7401              MOV     A,#01H
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 542
0046 8015              SJMP    ?C0071
0048         ?C0072:
                                           ; SOURCE LINE # 544
                                           ; SOURCE LINE # 546
0048 900000      R     MOV     DPTR,#i
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D EF                MOV     A,R7
004E 75F00B            MOV     B,#0BH
0051 A4                MUL     AB
0052 2400        E     ADD     A,#LOW USBUART_EP+01H
0054 F582              MOV     DPL,A
0056 E4                CLR     A
0057 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0059 F583              MOV     DPH,A
005B E4                CLR     A
005C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
005D         ?C0071:
005D 900000      R     MOV     DPTR,#i
0060 E0                MOVX    A,@DPTR
0061 04                INC     A
0062 F0                MOVX    @DPTR,A
0063 80A1              SJMP    ?C0069
                                           ; SOURCE LINE # 550
0065         ?C0074:
0065 22                RET     
             ; FUNCTION USBUART_EpStateInit (END)

             ; FUNCTION _USBUART_Config (BEGIN)
                                           ; SOURCE LINE # 570
0000 900000      R     MOV     DPTR,#clearAltSetting
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 571
                                           ; SOURCE LINE # 579
0005 900000      R     MOV     DPTR,#buffCount
0008 E4                CLR     A
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 46  

000B E4                CLR     A
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 586
000D 900000      R     MOV     DPTR,#ep
0010 E4                CLR     A
0011 F0                MOVX    @DPTR,A
0012         ?C0075:
0012 900000      R     MOV     DPTR,#ep
0015 E0                MOVX    A,@DPTR
0016 FF                MOV     R7,A
0017 EF                MOV     A,R7
0018 C3                CLR     C
0019 9409              SUBB    A,#09H
001B 4003              JC      $ + 5H
001D 020000      R     LJMP    ?C0076
                                           ; SOURCE LINE # 587
                                           ; SOURCE LINE # 588
0020 900000      R     MOV     DPTR,#ep
0023 E0                MOVX    A,@DPTR
0024 FF                MOV     R7,A
0025 EF                MOV     A,R7
0026 75F00B            MOV     B,#0BH
0029 A4                MUL     AB
002A 2400        E     ADD     A,#LOW USBUART_EP
002C F582              MOV     DPL,A
002E E4                CLR     A
002F 3400        E     ADDC    A,#HIGH USBUART_EP
0031 F583              MOV     DPH,A
0033 E4                CLR     A
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 589
0035 900000      R     MOV     DPTR,#ep
0038 E0                MOVX    A,@DPTR
0039 FF                MOV     R7,A
003A EF                MOV     A,R7
003B 75F00B            MOV     B,#0BH
003E A4                MUL     AB
003F 2400        E     ADD     A,#LOW USBUART_EP+02H
0041 F582              MOV     DPL,A
0043 E4                CLR     A
0044 3400        E     ADDC    A,#HIGH USBUART_EP+02H
0046 F583              MOV     DPH,A
0048 E4                CLR     A
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 590
004A 900000      R     MOV     DPTR,#ep
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USBUART_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USBUART_EP+03H
005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 591
005F 900000      R     MOV     DPTR,#ep
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 47  

0064 EF                MOV     A,R7
0065 75F00B            MOV     B,#0BH
0068 A4                MUL     AB
0069 2400        E     ADD     A,#LOW USBUART_EP+08H
006B F582              MOV     DPL,A
006D E4                CLR     A
006E 3400        E     ADDC    A,#HIGH USBUART_EP+08H
0070 F583              MOV     DPH,A
0072 E4                CLR     A
0073 F0                MOVX    @DPTR,A
0074 A3                INC     DPTR
0075 E4                CLR     A
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 592
0077 900000      R     MOV     DPTR,#ep
007A E0                MOVX    A,@DPTR
007B FF                MOV     R7,A
007C EF                MOV     A,R7
007D 75F00B            MOV     B,#0BH
0080 A4                MUL     AB
0081 2400        E     ADD     A,#LOW USBUART_EP+0AH
0083 F582              MOV     DPL,A
0085 E4                CLR     A
0086 3400        E     ADDC    A,#HIGH USBUART_EP+0AH
0088 F583              MOV     DPH,A
008A E4                CLR     A
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 593
008C 900000      R     MOV     DPTR,#ep
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 EF                MOV     A,R7
0092 75F00B            MOV     B,#0BH
0095 A4                MUL     AB
0096 2400        E     ADD     A,#LOW USBUART_EP+01H
0098 F582              MOV     DPL,A
009A E4                CLR     A
009B 3400        E     ADDC    A,#HIGH USBUART_EP+01H
009D F583              MOV     DPH,A
009F E4                CLR     A
00A0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 594
00A1 900000      R     MOV     DPTR,#ep
00A4 E0                MOVX    A,@DPTR
00A5 FF                MOV     R7,A
00A6 EF                MOV     A,R7
00A7 75F00B            MOV     B,#0BH
00AA A4                MUL     AB
00AB 2400        E     ADD     A,#LOW USBUART_EP+05H
00AD F582              MOV     DPL,A
00AF E4                CLR     A
00B0 3400        E     ADDC    A,#HIGH USBUART_EP+05H
00B2 F583              MOV     DPH,A
00B4 E4                CLR     A
00B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 595
00B6 900000      R     MOV     DPTR,#ep
00B9 E0                MOVX    A,@DPTR
00BA 04                INC     A
00BB F0                MOVX    @DPTR,A
00BC 020000      R     LJMP    ?C0075
00BF         ?C0076:
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 48  

                                           ; SOURCE LINE # 598
00BF 900000      R     MOV     DPTR,#clearAltSetting
00C2 E0                MOVX    A,@DPTR
00C3 FF                MOV     R7,A
00C4 EF                MOV     A,R7
00C5 603A              JZ      ?C0078
                                           ; SOURCE LINE # 599
                                           ; SOURCE LINE # 600
00C7 900000      R     MOV     DPTR,#i
00CA E4                CLR     A
00CB F0                MOVX    @DPTR,A
00CC         ?C0079:
00CC 900000      R     MOV     DPTR,#i
00CF E0                MOVX    A,@DPTR
00D0 FF                MOV     R7,A
00D1 EF                MOV     A,R7
00D2 C3                CLR     C
00D3 9402              SUBB    A,#02H
00D5 502A              JNC     ?C0078
                                           ; SOURCE LINE # 601
                                           ; SOURCE LINE # 602
00D7 900000      R     MOV     DPTR,#i
00DA E0                MOVX    A,@DPTR
00DB FF                MOV     R7,A
00DC 7400        E     MOV     A,#LOW USBUART_interfaceSetting
00DE 2F                ADD     A,R7
00DF F582              MOV     DPL,A
00E1 E4                CLR     A
00E2 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
00E4 F583              MOV     DPH,A
00E6 E4                CLR     A
00E7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 603
00E8 900000      R     MOV     DPTR,#i
00EB E0                MOVX    A,@DPTR
00EC FF                MOV     R7,A
00ED 7400        E     MOV     A,#LOW USBUART_interfaceSettingLast
00EF 2F                ADD     A,R7
00F0 F582              MOV     DPL,A
00F2 E4                CLR     A
00F3 3400        E     ADDC    A,#HIGH USBUART_interfaceSettingLast
00F5 F583              MOV     DPH,A
00F7 E4                CLR     A
00F8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 604
00F9 900000      R     MOV     DPTR,#i
00FC E0                MOVX    A,@DPTR
00FD 04                INC     A
00FE F0                MOVX    @DPTR,A
00FF 80CB              SJMP    ?C0079
                                           ; SOURCE LINE # 605
0101         ?C0078:
                                           ; SOURCE LINE # 608
0101 900000      E     MOV     DPTR,#USBUART_configuration
0104 E0                MOVX    A,@DPTR
0105 FF                MOV     R7,A
0106 EF                MOV     A,R7
0107 D3                SETB    C
0108 9400              SUBB    A,#00H
010A 5003              JNC     $ + 5H
010C 020000      R     LJMP    ?C0108
                                           ; SOURCE LINE # 609
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 49  

                                           ; SOURCE LINE # 611
010F 900000      R     MOV     DPTR,#cdcComNums
0112 E4                CLR     A
0113 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 614
0114 900000      E     MOV     DPTR,#USBUART_configuration
0117 E0                MOVX    A,@DPTR
0118 FF                MOV     R7,A
0119 EF                MOV     A,R7
011A 14                DEC     A
011B FF                MOV     R7,A
011C 120000      R     LCALL   _USBUART_GetConfigTablePtr
011F 900000      R     MOV     DPTR,#pTmp
0122 EE                MOV     A,R6
0123 F0                MOVX    @DPTR,A
0124 A3                INC     DPTR
0125 EF                MOV     A,R7
0126 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 617
0127 900000      R     MOV     DPTR,#pTmp
012A E0                MOVX    A,@DPTR
012B FE                MOV     R6,A
012C A3                INC     DPTR
012D E0                MOVX    A,@DPTR
012E FF                MOV     R7,A
012F 8F82              MOV     DPL,R7
0131 8E83              MOV     DPH,R6
0133 A3                INC     DPTR
0134 120000      E     LCALL   ?C?PLDCODE
0137 900000      R     MOV     DPTR,#pDescr
013A 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 618
013D 900000      R     MOV     DPTR,#pDescr
0140 120000      E     LCALL   ?C?PLDXDATA
0143 E9                MOV     A,R1
0144 2407              ADD     A,#07H
0146 F9                MOV     R1,A
0147 EA                MOV     A,R2
0148 3400              ADDC    A,#00H
014A FA                MOV     R2,A
014B 120000      E     LCALL   ?C?CLDPTR
014E FF                MOV     R7,A
014F EF                MOV     A,R7
0150 5440              ANL     A,#040H
0152 FF                MOV     R7,A
0153 7E00              MOV     R6,#00H
0155 EF                MOV     A,R7
0156 4E                ORL     A,R6
0157 6010              JZ      ?C0083
                                           ; SOURCE LINE # 619
                                           ; SOURCE LINE # 620
0159 900000      E     MOV     DPTR,#USBUART_deviceStatus
015C E0                MOVX    A,@DPTR
015D FF                MOV     R7,A
015E EF                MOV     A,R7
015F 4401              ORL     A,#01H
0161 FF                MOV     R7,A
0162 900000      E     MOV     DPTR,#USBUART_deviceStatus
0165 EF                MOV     A,R7
0166 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 621
0167 800E              SJMP    ?C0084
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 50  

0169         ?C0083:
                                           ; SOURCE LINE # 623
                                           ; SOURCE LINE # 624
0169 900000      E     MOV     DPTR,#USBUART_deviceStatus
016C E0                MOVX    A,@DPTR
016D FF                MOV     R7,A
016E EF                MOV     A,R7
016F 54FE              ANL     A,#0FEH
0171 FF                MOV     R7,A
0172 900000      E     MOV     DPTR,#USBUART_deviceStatus
0175 EF                MOV     A,R7
0176 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 625
0177         ?C0084:
                                           ; SOURCE LINE # 628
0177 900000      R     MOV     DPTR,#pTmp
017A E0                MOVX    A,@DPTR
017B FE                MOV     R6,A
017C A3                INC     DPTR
017D E0                MOVX    A,@DPTR
017E FF                MOV     R7,A
017F EF                MOV     A,R7
0180 2404              ADD     A,#04H
0182 FF                MOV     R7,A
0183 EE                MOV     A,R6
0184 3400              ADDC    A,#00H
0186 FE                MOV     R6,A
0187 900000      R     MOV     DPTR,#pTmp
018A EE                MOV     A,R6
018B F0                MOVX    @DPTR,A
018C A3                INC     DPTR
018D EF                MOV     A,R7
018E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 629
018F 900000      R     MOV     DPTR,#pTmp
0192 E0                MOVX    A,@DPTR
0193 FE                MOV     R6,A
0194 A3                INC     DPTR
0195 E0                MOVX    A,@DPTR
0196 FF                MOV     R7,A
0197 8F82              MOV     DPL,R7
0199 8E83              MOV     DPH,R6
019B E4                CLR     A
019C 93                MOVC    A,@A+DPTR
019D FF                MOV     R7,A
019E 900000      R     MOV     DPTR,#ep
01A1 EF                MOV     A,R7
01A2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 687
01A3 900000      R     MOV     DPTR,#i
01A6 7401              MOV     A,#01H
01A8 F0                MOVX    @DPTR,A
01A9         ?C0085:
01A9 900000      R     MOV     DPTR,#i
01AC E0                MOVX    A,@DPTR
01AD FF                MOV     R7,A
01AE EF                MOV     A,R7
01AF C3                CLR     C
01B0 9409              SUBB    A,#09H
01B2 4003              JC      $ + 5H
01B4 020000      R     LJMP    ?C0086
                                           ; SOURCE LINE # 688
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 51  

                                           ; SOURCE LINE # 690
01B7 900000      R     MOV     DPTR,#pTmp
01BA E0                MOVX    A,@DPTR
01BB FE                MOV     R6,A
01BC A3                INC     DPTR
01BD E0                MOVX    A,@DPTR
01BE FF                MOV     R7,A
01BF 8F82              MOV     DPL,R7
01C1 8E83              MOV     DPH,R6
01C3 A3                INC     DPTR
01C4 120000      E     LCALL   ?C?PLDCODE
01C7 AE02              MOV     R6,AR2
01C9 AF01              MOV     R7,AR1
01CB 900000      R     MOV     DPTR,#pEP
01CE EE                MOV     A,R6
01CF F0                MOVX    @DPTR,A
01D0 A3                INC     DPTR
01D1 EF                MOV     A,R7
01D2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 694
01D3 900000      R     MOV     DPTR,#curEp
01D6 E4                CLR     A
01D7 F0                MOVX    @DPTR,A
01D8         ?C0088:
01D8 900000      R     MOV     DPTR,#ep
01DB E0                MOVX    A,@DPTR
01DC FF                MOV     R7,A
01DD 900000      R     MOV     DPTR,#curEp
01E0 E0                MOVX    A,@DPTR
01E1 FE                MOV     R6,A
01E2 EE                MOV     A,R6
01E3 C3                CLR     C
01E4 9F                SUBB    A,R7
01E5 4003              JC      $ + 5H
01E7 020000      R     LJMP    ?C0087
                                           ; SOURCE LINE # 695
                                           ; SOURCE LINE # 696
01EA 900000      R     MOV     DPTR,#pEP
01ED E0                MOVX    A,@DPTR
01EE FE                MOV     R6,A
01EF A3                INC     DPTR
01F0 E0                MOVX    A,@DPTR
01F1 FF                MOV     R7,A
01F2 8F82              MOV     DPL,R7
01F4 8E83              MOV     DPH,R6
01F6 7402              MOV     A,#02H
01F8 93                MOVC    A,@A+DPTR
01F9 FF                MOV     R7,A
01FA EF                MOV     A,R7
01FB 547F              ANL     A,#07FH
01FD FF                MOV     R7,A
01FE 7E00              MOV     R6,#00H
0200 900000      R     MOV     DPTR,#i
0203 E0                MOVX    A,@DPTR
0204 FD                MOV     R5,A
0205 7C00              MOV     R4,#00H
0207 ED                MOV     A,R5
0208 6F                XRL     A,R7
0209 7002              JNZ     ?C0148
020B EC                MOV     A,R4
020C 6E                XRL     A,R6
020D         ?C0148:
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 52  

020D 6003              JZ      $ + 5H
020F 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 697
                                           ; SOURCE LINE # 699
0212 900000      R     MOV     DPTR,#pEP
0215 E0                MOVX    A,@DPTR
0216 FE                MOV     R6,A
0217 A3                INC     DPTR
0218 E0                MOVX    A,@DPTR
0219 FF                MOV     R7,A
021A 8F82              MOV     DPL,R7
021C 8E83              MOV     DPH,R6
021E 7404              MOV     A,#04H
0220 93                MOVC    A,@A+DPTR
0221 FE                MOV     R6,A
0222 7405              MOV     A,#05H
0224 93                MOVC    A,@A+DPTR
0225 FF                MOV     R7,A
0226 900000      R     MOV     DPTR,#i
0229 E0                MOVX    A,@DPTR
022A FD                MOV     R5,A
022B ED                MOV     A,R5
022C 75F00B            MOV     B,#0BH
022F A4                MUL     AB
0230 2400        E     ADD     A,#LOW USBUART_EP+08H
0232 F582              MOV     DPL,A
0234 E4                CLR     A
0235 3400        E     ADDC    A,#HIGH USBUART_EP+08H
0237 F583              MOV     DPH,A
0239 E0                MOVX    A,@DPTR
023A FC                MOV     R4,A
023B A3                INC     DPTR
023C E0                MOVX    A,@DPTR
023D FD                MOV     R5,A
023E C3                CLR     C
023F ED                MOV     A,R5
0240 9F                SUBB    A,R7
0241 EC                MOV     A,R4
0242 9E                SUBB    A,R6
0243 502C              JNC     ?C0092
                                           ; SOURCE LINE # 700
                                           ; SOURCE LINE # 701
0245 900000      R     MOV     DPTR,#pEP
0248 E0                MOVX    A,@DPTR
0249 FE                MOV     R6,A
024A A3                INC     DPTR
024B E0                MOVX    A,@DPTR
024C FF                MOV     R7,A
024D 8F82              MOV     DPL,R7
024F 8E83              MOV     DPH,R6
0251 7404              MOV     A,#04H
0253 93                MOVC    A,@A+DPTR
0254 FE                MOV     R6,A
0255 7405              MOV     A,#05H
0257 93                MOVC    A,@A+DPTR
0258 FF                MOV     R7,A
0259 900000      R     MOV     DPTR,#i
025C E0                MOVX    A,@DPTR
025D FD                MOV     R5,A
025E ED                MOV     A,R5
025F 75F00B            MOV     B,#0BH
0262 A4                MUL     AB
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 53  

0263 2400        E     ADD     A,#LOW USBUART_EP+08H
0265 F582              MOV     DPL,A
0267 E4                CLR     A
0268 3400        E     ADDC    A,#HIGH USBUART_EP+08H
026A F583              MOV     DPH,A
026C EE                MOV     A,R6
026D F0                MOVX    @DPTR,A
026E A3                INC     DPTR
026F EF                MOV     A,R7
0270 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 702
0271         ?C0092:
                                           ; SOURCE LINE # 705
0271 900000      R     MOV     DPTR,#pEP
0274 E0                MOVX    A,@DPTR
0275 FE                MOV     R6,A
0276 A3                INC     DPTR
0277 E0                MOVX    A,@DPTR
0278 FF                MOV     R7,A
0279 8F82              MOV     DPL,R7
027B 8E83              MOV     DPH,R6
027D E4                CLR     A
027E 93                MOVC    A,@A+DPTR
027F FF                MOV     R7,A
0280 7400        E     MOV     A,#LOW USBUART_interfaceSetting
0282 2F                ADD     A,R7
0283 F582              MOV     DPL,A
0285 E4                CLR     A
0286 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
0288 F583              MOV     DPH,A
028A E0                MOVX    A,@DPTR
028B FF                MOV     R7,A
028C 900000      R     MOV     DPTR,#pEP
028F E0                MOVX    A,@DPTR
0290 FC                MOV     R4,A
0291 A3                INC     DPTR
0292 E0                MOVX    A,@DPTR
0293 FD                MOV     R5,A
0294 8D82              MOV     DPL,R5
0296 8C83              MOV     DPH,R4
0298 7401              MOV     A,#01H
029A 93                MOVC    A,@A+DPTR
029B FE                MOV     R6,A
029C EF                MOV     A,R7
029D 6E                XRL     A,R6
029E 6003              JZ      $ + 5H
02A0 020000      R     LJMP    ?C0091
                                           ; SOURCE LINE # 706
                                           ; SOURCE LINE # 707
02A3 900000      R     MOV     DPTR,#pEP
02A6 E0                MOVX    A,@DPTR
02A7 FE                MOV     R6,A
02A8 A3                INC     DPTR
02A9 E0                MOVX    A,@DPTR
02AA FF                MOV     R7,A
02AB 8F82              MOV     DPL,R7
02AD 8E83              MOV     DPH,R6
02AF 7402              MOV     A,#02H
02B1 93                MOVC    A,@A+DPTR
02B2 FF                MOV     R7,A
02B3 900000      R     MOV     DPTR,#i
02B6 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 54  

02B7 FE                MOV     R6,A
02B8 EE                MOV     A,R6
02B9 75F00B            MOV     B,#0BH
02BC A4                MUL     AB
02BD 2400        E     ADD     A,#LOW USBUART_EP+04H
02BF F582              MOV     DPL,A
02C1 E4                CLR     A
02C2 3400        E     ADDC    A,#HIGH USBUART_EP+04H
02C4 F583              MOV     DPH,A
02C6 EF                MOV     A,R7
02C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 708
02C8 900000      R     MOV     DPTR,#pEP
02CB E0                MOVX    A,@DPTR
02CC FE                MOV     R6,A
02CD A3                INC     DPTR
02CE E0                MOVX    A,@DPTR
02CF FF                MOV     R7,A
02D0 8F82              MOV     DPL,R7
02D2 8E83              MOV     DPH,R6
02D4 7403              MOV     A,#03H
02D6 93                MOVC    A,@A+DPTR
02D7 FF                MOV     R7,A
02D8 900000      R     MOV     DPTR,#i
02DB E0                MOVX    A,@DPTR
02DC FE                MOV     R6,A
02DD EE                MOV     A,R6
02DE 75F00B            MOV     B,#0BH
02E1 A4                MUL     AB
02E2 2400        E     ADD     A,#LOW USBUART_EP
02E4 F582              MOV     DPL,A
02E6 E4                CLR     A
02E7 3400        E     ADDC    A,#HIGH USBUART_EP
02E9 F583              MOV     DPH,A
02EB EF                MOV     A,R7
02EC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 710
02ED 900000      R     MOV     DPTR,#pEP
02F0 E0                MOVX    A,@DPTR
02F1 FE                MOV     R6,A
02F2 A3                INC     DPTR
02F3 E0                MOVX    A,@DPTR
02F4 FF                MOV     R7,A
02F5 8F82              MOV     DPL,R7
02F7 8E83              MOV     DPH,R6
02F9 7403              MOV     A,#03H
02FB 93                MOVC    A,@A+DPTR
02FC FF                MOV     R7,A
02FD EF                MOV     A,R7
02FE 5403              ANL     A,#03H
0300 FF                MOV     R7,A
0301 900000      R     MOV     DPTR,#epType
0304 EF                MOV     A,R7
0305 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 712
0306 900000      R     MOV     DPTR,#pEP
0309 E0                MOVX    A,@DPTR
030A FE                MOV     R6,A
030B A3                INC     DPTR
030C E0                MOVX    A,@DPTR
030D FF                MOV     R7,A
030E 8F82              MOV     DPL,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 55  

0310 8E83              MOV     DPH,R6
0312 7402              MOV     A,#02H
0314 93                MOVC    A,@A+DPTR
0315 FF                MOV     R7,A
0316 EF                MOV     A,R7
0317 5480              ANL     A,#080H
0319 FF                MOV     R7,A
031A 7E00              MOV     R6,#00H
031C EF                MOV     A,R7
031D 4E                ORL     A,R6
031E 603C              JZ      ?C0094
                                           ; SOURCE LINE # 713
                                           ; SOURCE LINE # 715
0320 900000      R     MOV     DPTR,#epType
0323 E0                MOVX    A,@DPTR
0324 FF                MOV     R7,A
0325 EF                MOV     A,R7
0326 B40104            CJNE    A,#01H,?C0095
0329 7F07              MOV     R7,#07H
032B 8002              SJMP    ?C0096
032D         ?C0095:
032D 7F0D              MOV     R7,#0DH
032F         ?C0096:
032F 900000      R     MOV     DPTR,#i
0332 E0                MOVX    A,@DPTR
0333 FE                MOV     R6,A
0334 EE                MOV     A,R6
0335 75F00B            MOV     B,#0BH
0338 A4                MUL     AB
0339 2400        E     ADD     A,#LOW USBUART_EP+05H
033B F582              MOV     DPL,A
033D E4                CLR     A
033E 3400        E     ADDC    A,#HIGH USBUART_EP+05H
0340 F583              MOV     DPH,A
0342 EF                MOV     A,R7
0343 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 716
0344 900000      R     MOV     DPTR,#i
0347 E0                MOVX    A,@DPTR
0348 FF                MOV     R7,A
0349 EF                MOV     A,R7
034A 75F00B            MOV     B,#0BH
034D A4                MUL     AB
034E 2400        E     ADD     A,#LOW USBUART_EP+01H
0350 F582              MOV     DPL,A
0352 E4                CLR     A
0353 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0355 F583              MOV     DPH,A
0357 7401              MOV     A,#01H
0359 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 724
035A 8039              SJMP    ?C0097
035C         ?C0094:
                                           ; SOURCE LINE # 726
                                           ; SOURCE LINE # 728
035C 900000      R     MOV     DPTR,#epType
035F E0                MOVX    A,@DPTR
0360 FF                MOV     R7,A
0361 EF                MOV     A,R7
0362 B40104            CJNE    A,#01H,?C0098
0365 7F05              MOV     R7,#05H
0367 8002              SJMP    ?C0099
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 56  

0369         ?C0098:
0369 7F09              MOV     R7,#09H
036B         ?C0099:
036B 900000      R     MOV     DPTR,#i
036E E0                MOVX    A,@DPTR
036F FE                MOV     R6,A
0370 EE                MOV     A,R6
0371 75F00B            MOV     B,#0BH
0374 A4                MUL     AB
0375 2400        E     ADD     A,#LOW USBUART_EP+05H
0377 F582              MOV     DPL,A
0379 E4                CLR     A
037A 3400        E     ADDC    A,#HIGH USBUART_EP+05H
037C F583              MOV     DPH,A
037E EF                MOV     A,R7
037F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 729
0380 900000      R     MOV     DPTR,#i
0383 E0                MOVX    A,@DPTR
0384 FF                MOV     R7,A
0385 EF                MOV     A,R7
0386 75F00B            MOV     B,#0BH
0389 A4                MUL     AB
038A 2400        E     ADD     A,#LOW USBUART_EP+01H
038C F582              MOV     DPL,A
038E E4                CLR     A
038F 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0391 F583              MOV     DPH,A
0393 E4                CLR     A
0394 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 737
0395         ?C0097:
                                           ; SOURCE LINE # 740
0395 900000      R     MOV     DPTR,#pEP
0398 E0                MOVX    A,@DPTR
0399 FE                MOV     R6,A
039A A3                INC     DPTR
039B E0                MOVX    A,@DPTR
039C FF                MOV     R7,A
039D 8F82              MOV     DPL,R7
039F 8E83              MOV     DPH,R6
03A1 7406              MOV     A,#06H
03A3 93                MOVC    A,@A+DPTR
03A4 FF                MOV     R7,A
03A5 EF                MOV     A,R7
03A6 640A              XRL     A,#0AH
03A8 6014              JZ      ?C0101
03AA 900000      R     MOV     DPTR,#pEP
03AD E0                MOVX    A,@DPTR
03AE FE                MOV     R6,A
03AF A3                INC     DPTR
03B0 E0                MOVX    A,@DPTR
03B1 FF                MOV     R7,A
03B2 8F82              MOV     DPL,R7
03B4 8E83              MOV     DPH,R6
03B6 7406              MOV     A,#06H
03B8 93                MOVC    A,@A+DPTR
03B9 FF                MOV     R7,A
03BA EF                MOV     A,R7
03BB B4021A            CJNE    A,#02H,?C0091
03BE         ?C0101:
                                           ; SOURCE LINE # 741
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 57  

                                           ; SOURCE LINE # 742
03BE 900000      R     MOV     DPTR,#pEP
03C1 E0                MOVX    A,@DPTR
03C2 FE                MOV     R6,A
03C3 A3                INC     DPTR
03C4 E0                MOVX    A,@DPTR
03C5 FF                MOV     R7,A
03C6 900000      R     MOV     DPTR,#i
03C9 E0                MOVX    A,@DPTR
03CA FD                MOV     R5,A
03CB 900000      R     MOV     DPTR,#cdcComNums
03CE E0                MOVX    A,@DPTR
03CF FB                MOV     R3,A
03D0 120000      E     LCALL   _USBUART_Cdc_EpInit
03D3 900000      R     MOV     DPTR,#cdcComNums
03D6 EF                MOV     A,R7
03D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 743
                                           ; SOURCE LINE # 749
                                           ; SOURCE LINE # 750
03D8         ?C0091:
                                           ; SOURCE LINE # 752
03D8 900000      R     MOV     DPTR,#pEP
03DB E0                MOVX    A,@DPTR
03DC FE                MOV     R6,A
03DD A3                INC     DPTR
03DE E0                MOVX    A,@DPTR
03DF FF                MOV     R7,A
03E0 EF                MOV     A,R7
03E1 2407              ADD     A,#07H
03E3 FF                MOV     R7,A
03E4 EE                MOV     A,R6
03E5 3400              ADDC    A,#00H
03E7 FE                MOV     R6,A
03E8 900000      R     MOV     DPTR,#pEP
03EB EE                MOV     A,R6
03EC F0                MOVX    @DPTR,A
03ED A3                INC     DPTR
03EE EF                MOV     A,R7
03EF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 753
03F0 900000      R     MOV     DPTR,#curEp
03F3 E0                MOVX    A,@DPTR
03F4 04                INC     A
03F5 F0                MOVX    @DPTR,A
03F6 020000      R     LJMP    ?C0088
                                           ; SOURCE LINE # 754
03F9         ?C0087:
03F9 900000      R     MOV     DPTR,#i
03FC E0                MOVX    A,@DPTR
03FD 04                INC     A
03FE F0                MOVX    @DPTR,A
03FF 020000      R     LJMP    ?C0085
0402         ?C0086:
                                           ; SOURCE LINE # 762
0402 900000      R     MOV     DPTR,#pTmp
0405 E0                MOVX    A,@DPTR
0406 FE                MOV     R6,A
0407 A3                INC     DPTR
0408 E0                MOVX    A,@DPTR
0409 FF                MOV     R7,A
040A 8F82              MOV     DPL,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 58  

040C 8E83              MOV     DPH,R6
040E A3                INC     DPTR
040F 120000      E     LCALL   ?C?PLDCODE
0412 AE02              MOV     R6,AR2
0414 AF01              MOV     R7,AR1
0416 900000      R     MOV     DPTR,#pEP
0419 EE                MOV     A,R6
041A F0                MOVX    @DPTR,A
041B A3                INC     DPTR
041C EF                MOV     A,R7
041D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 763
041E 900000      R     MOV     DPTR,#i
0421 E4                CLR     A
0422 F0                MOVX    @DPTR,A
0423         ?C0102:
0423 900000      R     MOV     DPTR,#ep
0426 E0                MOVX    A,@DPTR
0427 FF                MOV     R7,A
0428 900000      R     MOV     DPTR,#i
042B E0                MOVX    A,@DPTR
042C FE                MOV     R6,A
042D EE                MOV     A,R6
042E C3                CLR     C
042F 9F                SUBB    A,R7
0430 5053              JNC     ?C0103
                                           ; SOURCE LINE # 764
                                           ; SOURCE LINE # 766
0432 900000      R     MOV     DPTR,#pEP
0435 E0                MOVX    A,@DPTR
0436 FE                MOV     R6,A
0437 A3                INC     DPTR
0438 E0                MOVX    A,@DPTR
0439 FF                MOV     R7,A
043A 8F82              MOV     DPL,R7
043C 8E83              MOV     DPH,R6
043E E4                CLR     A
043F 93                MOVC    A,@A+DPTR
0440 FF                MOV     R7,A
0441 900000      R     MOV     DPTR,#pEP
0444 E0                MOVX    A,@DPTR
0445 FC                MOV     R4,A
0446 A3                INC     DPTR
0447 E0                MOVX    A,@DPTR
0448 FD                MOV     R5,A
0449 8D82              MOV     DPL,R5
044B 8C83              MOV     DPH,R4
044D 7402              MOV     A,#02H
044F 93                MOVC    A,@A+DPTR
0450 FE                MOV     R6,A
0451 EE                MOV     A,R6
0452 547F              ANL     A,#07FH
0454 FE                MOV     R6,A
0455 EE                MOV     A,R6
0456 75F00B            MOV     B,#0BH
0459 A4                MUL     AB
045A 2400        E     ADD     A,#LOW USBUART_EP+0AH
045C F582              MOV     DPL,A
045E E4                CLR     A
045F 3400        E     ADDC    A,#HIGH USBUART_EP+0AH
0461 F583              MOV     DPH,A
0463 EF                MOV     A,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 59  

0464 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 767
0465 900000      R     MOV     DPTR,#pEP
0468 E0                MOVX    A,@DPTR
0469 FE                MOV     R6,A
046A A3                INC     DPTR
046B E0                MOVX    A,@DPTR
046C FF                MOV     R7,A
046D EF                MOV     A,R7
046E 2407              ADD     A,#07H
0470 FF                MOV     R7,A
0471 EE                MOV     A,R6
0472 3400              ADDC    A,#00H
0474 FE                MOV     R6,A
0475 900000      R     MOV     DPTR,#pEP
0478 EE                MOV     A,R6
0479 F0                MOVX    @DPTR,A
047A A3                INC     DPTR
047B EF                MOV     A,R7
047C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 768
047D 900000      R     MOV     DPTR,#i
0480 E0                MOVX    A,@DPTR
0481 04                INC     A
0482 F0                MOVX    @DPTR,A
0483 809E              SJMP    ?C0102
0485         ?C0103:
                                           ; SOURCE LINE # 771
0485 120000      R     LCALL   USBUART_GetInterfaceClassTablePtr
0488 900000      E     MOV     DPTR,#USBUART_interfaceClass
048B EE                MOV     A,R6
048C F0                MOVX    @DPTR,A
048D A3                INC     DPTR
048E EF                MOV     A,R7
048F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 775
0490 900000      R     MOV     DPTR,#buffCount
0493 E4                CLR     A
0494 F0                MOVX    @DPTR,A
0495 A3                INC     DPTR
0496 E4                CLR     A
0497 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 776
0498 900000      R     MOV     DPTR,#ep
049B 7401              MOV     A,#01H
049D F0                MOVX    @DPTR,A
049E         ?C0105:
049E 900000      R     MOV     DPTR,#ep
04A1 E0                MOVX    A,@DPTR
04A2 FF                MOV     R7,A
04A3 EF                MOV     A,R7
04A4 C3                CLR     C
04A5 9409              SUBB    A,#09H
04A7 5049              JNC     ?C0106
                                           ; SOURCE LINE # 777
                                           ; SOURCE LINE # 778
04A9 900000      R     MOV     DPTR,#buffCount
04AC E0                MOVX    A,@DPTR
04AD FE                MOV     R6,A
04AE A3                INC     DPTR
04AF E0                MOVX    A,@DPTR
04B0 FF                MOV     R7,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 60  

04B1 900000      R     MOV     DPTR,#ep
04B4 E0                MOVX    A,@DPTR
04B5 FD                MOV     R5,A
04B6 ED                MOV     A,R5
04B7 75F00B            MOV     B,#0BH
04BA A4                MUL     AB
04BB 2400        E     ADD     A,#LOW USBUART_EP+06H
04BD F582              MOV     DPL,A
04BF E4                CLR     A
04C0 3400        E     ADDC    A,#HIGH USBUART_EP+06H
04C2 F583              MOV     DPH,A
04C4 EE                MOV     A,R6
04C5 F0                MOVX    @DPTR,A
04C6 A3                INC     DPTR
04C7 EF                MOV     A,R7
04C8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 779
04C9 900000      R     MOV     DPTR,#ep
04CC E0                MOVX    A,@DPTR
04CD FF                MOV     R7,A
04CE EF                MOV     A,R7
04CF 75F00B            MOV     B,#0BH
04D2 A4                MUL     AB
04D3 2400        E     ADD     A,#LOW USBUART_EP+08H
04D5 F582              MOV     DPL,A
04D7 E4                CLR     A
04D8 3400        E     ADDC    A,#HIGH USBUART_EP+08H
04DA F583              MOV     DPH,A
04DC E0                MOVX    A,@DPTR
04DD FE                MOV     R6,A
04DE A3                INC     DPTR
04DF E0                MOVX    A,@DPTR
04E0 FF                MOV     R7,A
04E1 900000      R     MOV     DPTR,#buffCount
04E4 EE                MOV     A,R6
04E5 8FF0              MOV     B,R7
04E7 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 785
04EA 900000      R     MOV     DPTR,#ep
04ED E0                MOVX    A,@DPTR
04EE 04                INC     A
04EF F0                MOVX    @DPTR,A
04F0 80AC              SJMP    ?C0105
04F2         ?C0106:
                                           ; SOURCE LINE # 789
04F2 120000      R     LCALL   USBUART_ConfigReg
                                           ; SOURCE LINE # 790
                                           ; SOURCE LINE # 791
04F5         ?C0108:
04F5 22                RET     
             ; FUNCTION _USBUART_Config (END)

             ; FUNCTION USBUART_ConfigAltChanged (BEGIN)
                                           ; SOURCE LINE # 805
                                           ; SOURCE LINE # 806
                                           ; SOURCE LINE # 817
0000 900000      E     MOV     DPTR,#USBUART_configuration
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 D3                SETB    C
0007 9400              SUBB    A,#00H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 61  

0009 5003              JNC     $ + 5H
000B 020000      R     LJMP    ?C0120
                                           ; SOURCE LINE # 818
                                           ; SOURCE LINE # 820
000E 900000      E     MOV     DPTR,#USBUART_configuration
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 EF                MOV     A,R7
0014 14                DEC     A
0015 FF                MOV     R7,A
0016 120000      R     LCALL   _USBUART_GetConfigTablePtr
0019 900000      R     MOV     DPTR,#pTmp
001C EE                MOV     A,R6
001D F0                MOVX    @DPTR,A
001E A3                INC     DPTR
001F EF                MOV     A,R7
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 821
0021 900000      R     MOV     DPTR,#pTmp
0024 E0                MOVX    A,@DPTR
0025 FE                MOV     R6,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 FF                MOV     R7,A
0029 EF                MOV     A,R7
002A 2404              ADD     A,#04H
002C FF                MOV     R7,A
002D EE                MOV     A,R6
002E 3400              ADDC    A,#00H
0030 FE                MOV     R6,A
0031 900000      R     MOV     DPTR,#pTmp
0034 EE                MOV     A,R6
0035 F0                MOVX    @DPTR,A
0036 A3                INC     DPTR
0037 EF                MOV     A,R7
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 822
0039 900000      R     MOV     DPTR,#pTmp
003C E0                MOVX    A,@DPTR
003D FE                MOV     R6,A
003E A3                INC     DPTR
003F E0                MOVX    A,@DPTR
0040 FF                MOV     R7,A
0041 8F82              MOV     DPL,R7
0043 8E83              MOV     DPH,R6
0045 E4                CLR     A
0046 93                MOVC    A,@A+DPTR
0047 FF                MOV     R7,A
0048 900000      R     MOV     DPTR,#ep
004B EF                MOV     A,R7
004C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 825
004D 900000      R     MOV     DPTR,#pTmp
0050 E0                MOVX    A,@DPTR
0051 FE                MOV     R6,A
0052 A3                INC     DPTR
0053 E0                MOVX    A,@DPTR
0054 FF                MOV     R7,A
0055 8F82              MOV     DPL,R7
0057 8E83              MOV     DPH,R6
0059 A3                INC     DPTR
005A 120000      E     LCALL   ?C?PLDCODE
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 62  

005D AE02              MOV     R6,AR2
005F AF01              MOV     R7,AR1
0061 900000      R     MOV     DPTR,#pEP
0064 EE                MOV     A,R6
0065 F0                MOVX    @DPTR,A
0066 A3                INC     DPTR
0067 EF                MOV     A,R7
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 831
0069 900000      E     MOV     DPTR,#USBUART_interfaceNumber
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
006E 900000      R     MOV     DPTR,#interfaceNum
0071 EF                MOV     A,R7
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 832
0073 900000      R     MOV     DPTR,#i
0076 E4                CLR     A
0077 F0                MOVX    @DPTR,A
0078         ?C0110:
0078 900000      R     MOV     DPTR,#ep
007B E0                MOVX    A,@DPTR
007C FF                MOV     R7,A
007D 900000      R     MOV     DPTR,#i
0080 E0                MOVX    A,@DPTR
0081 FE                MOV     R6,A
0082 EE                MOV     A,R6
0083 C3                CLR     C
0084 9F                SUBB    A,R7
0085 4003              JC      $ + 5H
0087 020000      R     LJMP    ?C0120
                                           ; SOURCE LINE # 833
                                           ; SOURCE LINE # 835
008A 900000      R     MOV     DPTR,#pEP
008D E0                MOVX    A,@DPTR
008E FE                MOV     R6,A
008F A3                INC     DPTR
0090 E0                MOVX    A,@DPTR
0091 FF                MOV     R7,A
0092 8F82              MOV     DPL,R7
0094 8E83              MOV     DPH,R6
0096 E4                CLR     A
0097 93                MOVC    A,@A+DPTR
0098 FF                MOV     R7,A
0099 900000      R     MOV     DPTR,#interfaceNum
009C E0                MOVX    A,@DPTR
009D FE                MOV     R6,A
009E EE                MOV     A,R6
009F 6F                XRL     A,R7
00A0 6003              JZ      $ + 5H
00A2 020000      R     LJMP    ?C0113
00A5 900000      R     MOV     DPTR,#pEP
00A8 E0                MOVX    A,@DPTR
00A9 FE                MOV     R6,A
00AA A3                INC     DPTR
00AB E0                MOVX    A,@DPTR
00AC FF                MOV     R7,A
00AD 8F82              MOV     DPL,R7
00AF 8E83              MOV     DPH,R6
00B1 7401              MOV     A,#01H
00B3 93                MOVC    A,@A+DPTR
00B4 FF                MOV     R7,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 63  

00B5 900000      R     MOV     DPTR,#interfaceNum
00B8 E0                MOVX    A,@DPTR
00B9 FE                MOV     R6,A
00BA 7400        E     MOV     A,#LOW USBUART_interfaceSetting
00BC 2E                ADD     A,R6
00BD F582              MOV     DPL,A
00BF E4                CLR     A
00C0 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
00C2 F583              MOV     DPH,A
00C4 E0                MOVX    A,@DPTR
00C5 FE                MOV     R6,A
00C6 EE                MOV     A,R6
00C7 6F                XRL     A,R7
00C8 6003              JZ      $ + 5H
00CA 020000      R     LJMP    ?C0113
                                           ; SOURCE LINE # 837
                                           ; SOURCE LINE # 838
00CD 900000      R     MOV     DPTR,#pEP
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 FF                MOV     R7,A
00D5 8F82              MOV     DPL,R7
00D7 8E83              MOV     DPH,R6
00D9 7402              MOV     A,#02H
00DB 93                MOVC    A,@A+DPTR
00DC FF                MOV     R7,A
00DD EF                MOV     A,R7
00DE 547F              ANL     A,#07FH
00E0 FF                MOV     R7,A
00E1 900000      R     MOV     DPTR,#curEp
00E4 EF                MOV     A,R7
00E5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 839
00E6 900000      R     MOV     DPTR,#pEP
00E9 E0                MOVX    A,@DPTR
00EA FE                MOV     R6,A
00EB A3                INC     DPTR
00EC E0                MOVX    A,@DPTR
00ED FF                MOV     R7,A
00EE 8F82              MOV     DPL,R7
00F0 8E83              MOV     DPH,R6
00F2 7403              MOV     A,#03H
00F4 93                MOVC    A,@A+DPTR
00F5 FF                MOV     R7,A
00F6 EF                MOV     A,R7
00F7 5403              ANL     A,#03H
00F9 FF                MOV     R7,A
00FA 900000      R     MOV     DPTR,#epType
00FD EF                MOV     A,R7
00FE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 842
00FF 900000      R     MOV     DPTR,#curEp
0102 E0                MOVX    A,@DPTR
0103 FF                MOV     R7,A
0104 EF                MOV     A,R7
0105 75F00B            MOV     B,#0BH
0108 A4                MUL     AB
0109 2400        E     ADD     A,#LOW USBUART_EP+03H
010B F582              MOV     DPL,A
010D E4                CLR     A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 64  

010E 3400        E     ADDC    A,#HIGH USBUART_EP+03H
0110 F583              MOV     DPH,A
0112 E4                CLR     A
0113 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 843
0114 900000      R     MOV     DPTR,#pEP
0117 E0                MOVX    A,@DPTR
0118 FE                MOV     R6,A
0119 A3                INC     DPTR
011A E0                MOVX    A,@DPTR
011B FF                MOV     R7,A
011C 8F82              MOV     DPL,R7
011E 8E83              MOV     DPH,R6
0120 7402              MOV     A,#02H
0122 93                MOVC    A,@A+DPTR
0123 FF                MOV     R7,A
0124 900000      R     MOV     DPTR,#curEp
0127 E0                MOVX    A,@DPTR
0128 FE                MOV     R6,A
0129 EE                MOV     A,R6
012A 75F00B            MOV     B,#0BH
012D A4                MUL     AB
012E 2400        E     ADD     A,#LOW USBUART_EP+04H
0130 F582              MOV     DPL,A
0132 E4                CLR     A
0133 3400        E     ADDC    A,#HIGH USBUART_EP+04H
0135 F583              MOV     DPH,A
0137 EF                MOV     A,R7
0138 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 844
0139 900000      R     MOV     DPTR,#pEP
013C E0                MOVX    A,@DPTR
013D FE                MOV     R6,A
013E A3                INC     DPTR
013F E0                MOVX    A,@DPTR
0140 FF                MOV     R7,A
0141 8F82              MOV     DPL,R7
0143 8E83              MOV     DPH,R6
0145 7403              MOV     A,#03H
0147 93                MOVC    A,@A+DPTR
0148 FF                MOV     R7,A
0149 900000      R     MOV     DPTR,#curEp
014C E0                MOVX    A,@DPTR
014D FE                MOV     R6,A
014E EE                MOV     A,R6
014F 75F00B            MOV     B,#0BH
0152 A4                MUL     AB
0153 2400        E     ADD     A,#LOW USBUART_EP
0155 F582              MOV     DPL,A
0157 E4                CLR     A
0158 3400        E     ADDC    A,#HIGH USBUART_EP
015A F583              MOV     DPH,A
015C EF                MOV     A,R7
015D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 845
015E 900000      R     MOV     DPTR,#pEP
0161 E0                MOVX    A,@DPTR
0162 FE                MOV     R6,A
0163 A3                INC     DPTR
0164 E0                MOVX    A,@DPTR
0165 FF                MOV     R7,A
0166 8F82              MOV     DPL,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 65  

0168 8E83              MOV     DPH,R6
016A 7404              MOV     A,#04H
016C 93                MOVC    A,@A+DPTR
016D FE                MOV     R6,A
016E 7405              MOV     A,#05H
0170 93                MOVC    A,@A+DPTR
0171 FF                MOV     R7,A
0172 900000      R     MOV     DPTR,#curEp
0175 E0                MOVX    A,@DPTR
0176 FD                MOV     R5,A
0177 ED                MOV     A,R5
0178 75F00B            MOV     B,#0BH
017B A4                MUL     AB
017C 2400        E     ADD     A,#LOW USBUART_EP+08H
017E F582              MOV     DPL,A
0180 E4                CLR     A
0181 3400        E     ADDC    A,#HIGH USBUART_EP+08H
0183 F583              MOV     DPH,A
0185 EE                MOV     A,R6
0186 F0                MOVX    @DPTR,A
0187 A3                INC     DPTR
0188 EF                MOV     A,R7
0189 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 847
018A 900000      R     MOV     DPTR,#pEP
018D E0                MOVX    A,@DPTR
018E FE                MOV     R6,A
018F A3                INC     DPTR
0190 E0                MOVX    A,@DPTR
0191 FF                MOV     R7,A
0192 8F82              MOV     DPL,R7
0194 8E83              MOV     DPH,R6
0196 7402              MOV     A,#02H
0198 93                MOVC    A,@A+DPTR
0199 FF                MOV     R7,A
019A EF                MOV     A,R7
019B 5480              ANL     A,#080H
019D FF                MOV     R7,A
019E 7E00              MOV     R6,#00H
01A0 EF                MOV     A,R7
01A1 4E                ORL     A,R6
01A2 603C              JZ      ?C0114
                                           ; SOURCE LINE # 848
                                           ; SOURCE LINE # 850
01A4 900000      R     MOV     DPTR,#epType
01A7 E0                MOVX    A,@DPTR
01A8 FF                MOV     R7,A
01A9 EF                MOV     A,R7
01AA B40104            CJNE    A,#01H,?C0115
01AD 7F07              MOV     R7,#07H
01AF 8002              SJMP    ?C0116
01B1         ?C0115:
01B1 7F0D              MOV     R7,#0DH
01B3         ?C0116:
01B3 900000      R     MOV     DPTR,#curEp
01B6 E0                MOVX    A,@DPTR
01B7 FE                MOV     R6,A
01B8 EE                MOV     A,R6
01B9 75F00B            MOV     B,#0BH
01BC A4                MUL     AB
01BD 2400        E     ADD     A,#LOW USBUART_EP+05H
01BF F582              MOV     DPL,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 66  

01C1 E4                CLR     A
01C2 3400        E     ADDC    A,#HIGH USBUART_EP+05H
01C4 F583              MOV     DPH,A
01C6 EF                MOV     A,R7
01C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 851
01C8 900000      R     MOV     DPTR,#curEp
01CB E0                MOVX    A,@DPTR
01CC FF                MOV     R7,A
01CD EF                MOV     A,R7
01CE 75F00B            MOV     B,#0BH
01D1 A4                MUL     AB
01D2 2400        E     ADD     A,#LOW USBUART_EP+01H
01D4 F582              MOV     DPL,A
01D6 E4                CLR     A
01D7 3400        E     ADDC    A,#HIGH USBUART_EP+01H
01D9 F583              MOV     DPH,A
01DB 7401              MOV     A,#01H
01DD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 852
01DE 8039              SJMP    ?C0117
01E0         ?C0114:
                                           ; SOURCE LINE # 854
                                           ; SOURCE LINE # 856
01E0 900000      R     MOV     DPTR,#epType
01E3 E0                MOVX    A,@DPTR
01E4 FF                MOV     R7,A
01E5 EF                MOV     A,R7
01E6 B40104            CJNE    A,#01H,?C0118
01E9 7F05              MOV     R7,#05H
01EB 8002              SJMP    ?C0119
01ED         ?C0118:
01ED 7F09              MOV     R7,#09H
01EF         ?C0119:
01EF 900000      R     MOV     DPTR,#curEp
01F2 E0                MOVX    A,@DPTR
01F3 FE                MOV     R6,A
01F4 EE                MOV     A,R6
01F5 75F00B            MOV     B,#0BH
01F8 A4                MUL     AB
01F9 2400        E     ADD     A,#LOW USBUART_EP+05H
01FB F582              MOV     DPL,A
01FD E4                CLR     A
01FE 3400        E     ADDC    A,#HIGH USBUART_EP+05H
0200 F583              MOV     DPH,A
0202 EF                MOV     A,R7
0203 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 857
0204 900000      R     MOV     DPTR,#curEp
0207 E0                MOVX    A,@DPTR
0208 FF                MOV     R7,A
0209 EF                MOV     A,R7
020A 75F00B            MOV     B,#0BH
020D A4                MUL     AB
020E 2400        E     ADD     A,#LOW USBUART_EP+01H
0210 F582              MOV     DPL,A
0212 E4                CLR     A
0213 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0215 F583              MOV     DPH,A
0217 E4                CLR     A
0218 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 858
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 67  

0219         ?C0117:
                                           ; SOURCE LINE # 861
0219 900000      R     MOV     DPTR,#curEp
021C E0                MOVX    A,@DPTR
021D FF                MOV     R7,A
021E 75F010            MOV     B,#010H
0221 EF                MOV     A,R7
0222 905FFE            MOV     DPTR,#05FFEH
0225 120000      E     LCALL   ?C?OFFXADD
0228 7401              MOV     A,#01H
022A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 907
022B 900000      R     MOV     DPTR,#curEp
022E E0                MOVX    A,@DPTR
022F FF                MOV     R7,A
0230 EF                MOV     A,R7
0231 75F00B            MOV     B,#0BH
0234 A4                MUL     AB
0235 2400        E     ADD     A,#LOW USBUART_EP+08H
0237 F582              MOV     DPL,A
0239 E4                CLR     A
023A 3400        E     ADDC    A,#HIGH USBUART_EP+08H
023C F583              MOV     DPH,A
023E E0                MOVX    A,@DPTR
023F FE                MOV     R6,A
0240 A3                INC     DPTR
0241 E0                MOVX    A,@DPTR
0242 FF                MOV     R7,A
0243 EE                MOV     A,R6
0244 FF                MOV     R7,A
0245 7E00              MOV     R6,#00H
0247 900000      R     MOV     DPTR,#curEp
024A E0                MOVX    A,@DPTR
024B FE                MOV     R6,A
024C 75F010            MOV     B,#010H
024F EE                MOV     A,R6
0250 905FFC            MOV     DPTR,#05FFCH
0253 120000      E     LCALL   ?C?OFFXADD
0256 EF                MOV     A,R7
0257 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 908
0258 900000      R     MOV     DPTR,#curEp
025B E0                MOVX    A,@DPTR
025C FF                MOV     R7,A
025D EF                MOV     A,R7
025E 75F00B            MOV     B,#0BH
0261 A4                MUL     AB
0262 2400        E     ADD     A,#LOW USBUART_EP+08H
0264 F582              MOV     DPL,A
0266 E4                CLR     A
0267 3400        E     ADDC    A,#HIGH USBUART_EP+08H
0269 F583              MOV     DPH,A
026B E0                MOVX    A,@DPTR
026C FE                MOV     R6,A
026D A3                INC     DPTR
026E E0                MOVX    A,@DPTR
026F FF                MOV     R7,A
0270 EF                MOV     A,R7
0271 54FF              ANL     A,#0FFH
0273 FF                MOV     R7,A
0274 900000      R     MOV     DPTR,#curEp
0277 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 68  

0278 FE                MOV     R6,A
0279 75F010            MOV     B,#010H
027C EE                MOV     A,R6
027D 905FFD            MOV     DPTR,#05FFDH
0280 120000      E     LCALL   ?C?OFFXADD
0283 EF                MOV     A,R7
0284 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 914
0285 900000      R     MOV     DPTR,#curEp
0288 E0                MOVX    A,@DPTR
0289 FF                MOV     R7,A
028A EF                MOV     A,R7
028B 75F00B            MOV     B,#0BH
028E A4                MUL     AB
028F 2400        E     ADD     A,#LOW USBUART_EP+06H
0291 F582              MOV     DPL,A
0293 E4                CLR     A
0294 3400        E     ADDC    A,#HIGH USBUART_EP+06H
0296 F583              MOV     DPH,A
0298 E0                MOVX    A,@DPTR
0299 FE                MOV     R6,A
029A A3                INC     DPTR
029B E0                MOVX    A,@DPTR
029C FF                MOV     R7,A
029D EF                MOV     A,R7
029E 54FF              ANL     A,#0FFH
02A0 FF                MOV     R7,A
02A1 900000      R     MOV     DPTR,#curEp
02A4 E0                MOVX    A,@DPTR
02A5 FE                MOV     R6,A
02A6 75F010            MOV     B,#010H
02A9 EE                MOV     A,R6
02AA 906076            MOV     DPTR,#06076H
02AD 120000      E     LCALL   ?C?OFFXADD
02B0 EF                MOV     A,R7
02B1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 915
02B2 900000      R     MOV     DPTR,#curEp
02B5 E0                MOVX    A,@DPTR
02B6 FF                MOV     R7,A
02B7 EF                MOV     A,R7
02B8 75F00B            MOV     B,#0BH
02BB A4                MUL     AB
02BC 2400        E     ADD     A,#LOW USBUART_EP+06H
02BE F582              MOV     DPL,A
02C0 E4                CLR     A
02C1 3400        E     ADDC    A,#HIGH USBUART_EP+06H
02C3 F583              MOV     DPH,A
02C5 E0                MOVX    A,@DPTR
02C6 FE                MOV     R6,A
02C7 A3                INC     DPTR
02C8 E0                MOVX    A,@DPTR
02C9 FF                MOV     R7,A
02CA EE                MOV     A,R6
02CB FF                MOV     R7,A
02CC 7E00              MOV     R6,#00H
02CE 900000      R     MOV     DPTR,#curEp
02D1 E0                MOVX    A,@DPTR
02D2 FE                MOV     R6,A
02D3 75F010            MOV     B,#010H
02D6 EE                MOV     A,R6
02D7 906077            MOV     DPTR,#06077H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 69  

02DA 120000      E     LCALL   ?C?OFFXADD
02DD EF                MOV     A,R7
02DE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 916
02DF 900000      R     MOV     DPTR,#curEp
02E2 E0                MOVX    A,@DPTR
02E3 FF                MOV     R7,A
02E4 EF                MOV     A,R7
02E5 75F00B            MOV     B,#0BH
02E8 A4                MUL     AB
02E9 2400        E     ADD     A,#LOW USBUART_EP+06H
02EB F582              MOV     DPL,A
02ED E4                CLR     A
02EE 3400        E     ADDC    A,#HIGH USBUART_EP+06H
02F0 F583              MOV     DPH,A
02F2 E0                MOVX    A,@DPTR
02F3 FE                MOV     R6,A
02F4 A3                INC     DPTR
02F5 E0                MOVX    A,@DPTR
02F6 FF                MOV     R7,A
02F7 EF                MOV     A,R7
02F8 54FF              ANL     A,#0FFH
02FA FF                MOV     R7,A
02FB 900000      R     MOV     DPTR,#curEp
02FE E0                MOVX    A,@DPTR
02FF FE                MOV     R6,A
0300 75F010            MOV     B,#010H
0303 EE                MOV     A,R6
0304 906074            MOV     DPTR,#06074H
0307 120000      E     LCALL   ?C?OFFXADD
030A EF                MOV     A,R7
030B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 917
030C 900000      R     MOV     DPTR,#curEp
030F E0                MOVX    A,@DPTR
0310 FF                MOV     R7,A
0311 EF                MOV     A,R7
0312 75F00B            MOV     B,#0BH
0315 A4                MUL     AB
0316 2400        E     ADD     A,#LOW USBUART_EP+06H
0318 F582              MOV     DPL,A
031A E4                CLR     A
031B 3400        E     ADDC    A,#HIGH USBUART_EP+06H
031D F583              MOV     DPH,A
031F E0                MOVX    A,@DPTR
0320 FE                MOV     R6,A
0321 A3                INC     DPTR
0322 E0                MOVX    A,@DPTR
0323 FF                MOV     R7,A
0324 EE                MOV     A,R6
0325 FF                MOV     R7,A
0326 7E00              MOV     R6,#00H
0328 900000      R     MOV     DPTR,#curEp
032B E0                MOVX    A,@DPTR
032C FE                MOV     R6,A
032D 75F010            MOV     B,#010H
0330 EE                MOV     A,R6
0331 906075            MOV     DPTR,#06075H
0334 120000      E     LCALL   ?C?OFFXADD
0337 EF                MOV     A,R7
0338 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 920
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 70  

0339         ?C0113:
                                           ; SOURCE LINE # 922
0339 900000      R     MOV     DPTR,#pEP
033C E0                MOVX    A,@DPTR
033D FE                MOV     R6,A
033E A3                INC     DPTR
033F E0                MOVX    A,@DPTR
0340 FF                MOV     R7,A
0341 EF                MOV     A,R7
0342 2407              ADD     A,#07H
0344 FF                MOV     R7,A
0345 EE                MOV     A,R6
0346 3400              ADDC    A,#00H
0348 FE                MOV     R6,A
0349 900000      R     MOV     DPTR,#pEP
034C EE                MOV     A,R6
034D F0                MOVX    @DPTR,A
034E A3                INC     DPTR
034F EF                MOV     A,R7
0350 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 923
0351 900000      R     MOV     DPTR,#i
0354 E0                MOVX    A,@DPTR
0355 04                INC     A
0356 F0                MOVX    @DPTR,A
0357 020000      R     LJMP    ?C0110
                                           ; SOURCE LINE # 926
                                           ; SOURCE LINE # 927
035A         ?C0120:
035A 22                RET     
             ; FUNCTION USBUART_ConfigAltChanged (END)

             ; FUNCTION _USBUART_GetConfigTablePtr (BEGIN)
                                           ; SOURCE LINE # 942
0000 900000      R     MOV     DPTR,#confIndex
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 944
                                           ; SOURCE LINE # 948
0005 900000      E     MOV     DPTR,#USBUART_device
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 25E0              ADD     A,ACC
000D 25E0              ADD     A,ACC
000F 2400        E     ADD     A,#LOW USBUART_TABLE+01H
0011 F582              MOV     DPL,A
0013 E4                CLR     A
0014 3400        E     ADDC    A,#HIGH USBUART_TABLE+01H
0016 F583              MOV     DPH,A
0018 120000      E     LCALL   ?C?PLDCODE
001B AE02              MOV     R6,AR2
001D AF01              MOV     R7,AR1
001F 900000      R     MOV     DPTR,#pTmp
0022 EE                MOV     A,R6
0023 F0                MOVX    @DPTR,A
0024 A3                INC     DPTR
0025 EF                MOV     A,R7
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 955
0027 900000      R     MOV     DPTR,#pTmp
002A E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 71  

002B FE                MOV     R6,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FF                MOV     R7,A
002F EF                MOV     A,R7
0030 2408              ADD     A,#08H
0032 FF                MOV     R7,A
0033 EE                MOV     A,R6
0034 3400              ADDC    A,#00H
0036 FE                MOV     R6,A
0037 900000      R     MOV     DPTR,#pTmp
003A EE                MOV     A,R6
003B F0                MOVX    @DPTR,A
003C A3                INC     DPTR
003D EF                MOV     A,R7
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 957
003F 900000      R     MOV     DPTR,#pTmp
0042 E0                MOVX    A,@DPTR
0043 FE                MOV     R6,A
0044 A3                INC     DPTR
0045 E0                MOVX    A,@DPTR
0046 FF                MOV     R7,A
0047 8F82              MOV     DPL,R7
0049 8E83              MOV     DPH,R6
004B E4                CLR     A
004C 93                MOVC    A,@A+DPTR
004D FF                MOV     R7,A
004E 900000      R     MOV     DPTR,#confIndex
0051 E0                MOVX    A,@DPTR
0052 FE                MOV     R6,A
0053 EE                MOV     A,R6
0054 C3                CLR     C
0055 9F                SUBB    A,R7
0056 400A              JC      ?C0121
                                           ; SOURCE LINE # 958
                                           ; SOURCE LINE # 959
0058 900000      R     MOV     DPTR,#pTmp
005B E4                CLR     A
005C F0                MOVX    @DPTR,A
005D A3                INC     DPTR
005E E4                CLR     A
005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 960
0060 8030              SJMP    ?C0122
0062         ?C0121:
                                           ; SOURCE LINE # 962
                                           ; SOURCE LINE # 963
0062 900000      R     MOV     DPTR,#pTmp
0065 E0                MOVX    A,@DPTR
0066 FE                MOV     R6,A
0067 A3                INC     DPTR
0068 E0                MOVX    A,@DPTR
0069 FF                MOV     R7,A
006A 8F82              MOV     DPL,R7
006C 8E83              MOV     DPH,R6
006E C083              PUSH    DPH
0070 C082              PUSH    DPL
0072 900000      R     MOV     DPTR,#confIndex
0075 E0                MOVX    A,@DPTR
0076 FF                MOV     R7,A
0077 D082              POP     DPL
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 72  

0079 D083              POP     DPH
007B 75F004            MOV     B,#04H
007E EF                MOV     A,R7
007F 120000      E     LCALL   ?C?OFFXADD
0082 A3                INC     DPTR
0083 120000      E     LCALL   ?C?PLDCODE
0086 AE02              MOV     R6,AR2
0088 AF01              MOV     R7,AR1
008A 900000      R     MOV     DPTR,#pTmp
008D EE                MOV     A,R6
008E F0                MOVX    @DPTR,A
008F A3                INC     DPTR
0090 EF                MOV     A,R7
0091 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 964
0092         ?C0122:
                                           ; SOURCE LINE # 966
0092 900000      R     MOV     DPTR,#pTmp
0095 E0                MOVX    A,@DPTR
0096 FE                MOV     R6,A
0097 A3                INC     DPTR
0098 E0                MOVX    A,@DPTR
0099 FF                MOV     R7,A
                                           ; SOURCE LINE # 967
009A         ?C0123:
009A 22                RET     
             ; FUNCTION _USBUART_GetConfigTablePtr (END)

             ; FUNCTION USBUART_GetDeviceTablePtr (BEGIN)
                                           ; SOURCE LINE # 1011
                                           ; SOURCE LINE # 1013
                                           ; SOURCE LINE # 1015
0000 900000      E     MOV     DPTR,#USBUART_device
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 25E0              ADD     A,ACC
0008 25E0              ADD     A,ACC
000A 2400        E     ADD     A,#LOW USBUART_TABLE+01H
000C F582              MOV     DPL,A
000E E4                CLR     A
000F 3400        E     ADDC    A,#HIGH USBUART_TABLE+01H
0011 F583              MOV     DPH,A
0013 120000      E     LCALL   ?C?PLDCODE
0016 AE02              MOV     R6,AR2
0018 AF01              MOV     R7,AR1
                                           ; SOURCE LINE # 1016
001A         ?C0124:
001A 22                RET     
             ; FUNCTION USBUART_GetDeviceTablePtr (END)

             ; FUNCTION USBUART_GetInterfaceClassTablePtr (BEGIN)
                                           ; SOURCE LINE # 1030
                                           ; SOURCE LINE # 1032
                                           ; SOURCE LINE # 1037
0000 900000      E     MOV     DPTR,#USBUART_configuration
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 14                DEC     A
0007 FF                MOV     R7,A
0008 120000      R     LCALL   _USBUART_GetConfigTablePtr
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 73  

000B 900000      R     MOV     DPTR,#pTmp
000E EE                MOV     A,R6
000F F0                MOVX    @DPTR,A
0010 A3                INC     DPTR
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1038
0013 900000      R     MOV     DPTR,#pTmp
0016 E0                MOVX    A,@DPTR
0017 FE                MOV     R6,A
0018 A3                INC     DPTR
0019 E0                MOVX    A,@DPTR
001A FF                MOV     R7,A
001B EF                MOV     A,R7
001C 4E                ORL     A,R6
001D 606F              JZ      ?C0125
                                           ; SOURCE LINE # 1039
                                           ; SOURCE LINE # 1040
001F 900000      R     MOV     DPTR,#pTmp
0022 E0                MOVX    A,@DPTR
0023 FE                MOV     R6,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FF                MOV     R7,A
0027 8F82              MOV     DPL,R7
0029 8E83              MOV     DPH,R6
002B A3                INC     DPTR
002C 120000      E     LCALL   ?C?PLDCODE
002F E9                MOV     A,R1
0030 2404              ADD     A,#04H
0032 F9                MOV     R1,A
0033 EA                MOV     A,R2
0034 3400              ADDC    A,#00H
0036 FA                MOV     R2,A
0037 120000      E     LCALL   ?C?CLDPTR
003A FF                MOV     R7,A
003B 900000      R     MOV     DPTR,#currentInterfacesNum
003E EF                MOV     A,R7
003F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1043
0040 900000      R     MOV     DPTR,#currentInterfacesNum
0043 E0                MOVX    A,@DPTR
0044 FF                MOV     R7,A
0045 7E00              MOV     R6,#00H
0047 EF                MOV     A,R7
0048 2402              ADD     A,#02H
004A FF                MOV     R7,A
004B EE                MOV     A,R6
004C 3400              ADDC    A,#00H
004E FE                MOV     R6,A
004F EF                MOV     A,R7
0050 7802              MOV     R0,#02H
0052         ?C0149:
0052 C3                CLR     C
0053 33                RLC     A
0054 CE                XCH     A,R6
0055 33                RLC     A
0056 CE                XCH     A,R6
0057 D8F9              DJNZ    R0,?C0149
0059 FF                MOV     R7,A
005A 900000      R     MOV     DPTR,#pTmp
005D E0                MOVX    A,@DPTR
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 74  

005E FC                MOV     R4,A
005F A3                INC     DPTR
0060 E0                MOVX    A,@DPTR
0061 FD                MOV     R5,A
0062 EF                MOV     A,R7
0063 2D                ADD     A,R5
0064 FF                MOV     R7,A
0065 EE                MOV     A,R6
0066 3C                ADDC    A,R4
0067 FE                MOV     R6,A
0068 900000      R     MOV     DPTR,#pTmp
006B EE                MOV     A,R6
006C F0                MOVX    @DPTR,A
006D A3                INC     DPTR
006E EF                MOV     A,R7
006F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1044
0070 900000      R     MOV     DPTR,#pTmp
0073 E0                MOVX    A,@DPTR
0074 FE                MOV     R6,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 FF                MOV     R7,A
0078 8F82              MOV     DPL,R7
007A 8E83              MOV     DPH,R6
007C A3                INC     DPTR
007D 120000      E     LCALL   ?C?PLDCODE
0080 AE02              MOV     R6,AR2
0082 AF01              MOV     R7,AR1
0084 900000      R     MOV     DPTR,#pInterfaceClass
0087 EE                MOV     A,R6
0088 F0                MOVX    @DPTR,A
0089 A3                INC     DPTR
008A EF                MOV     A,R7
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1045
008C 8008              SJMP    ?C0126
008E         ?C0125:
                                           ; SOURCE LINE # 1047
                                           ; SOURCE LINE # 1048
008E 900000      R     MOV     DPTR,#pInterfaceClass
0091 E4                CLR     A
0092 F0                MOVX    @DPTR,A
0093 A3                INC     DPTR
0094 E4                CLR     A
0095 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1049
0096         ?C0126:
                                           ; SOURCE LINE # 1051
0096 900000      R     MOV     DPTR,#pInterfaceClass
0099 E0                MOVX    A,@DPTR
009A FE                MOV     R6,A
009B A3                INC     DPTR
009C E0                MOVX    A,@DPTR
009D FF                MOV     R7,A
                                           ; SOURCE LINE # 1052
009E         ?C0127:
009E 22                RET     
             ; FUNCTION USBUART_GetInterfaceClassTablePtr (END)

             ; FUNCTION _USBUART_TerminateEP (BEGIN)
                                           ; SOURCE LINE # 1072
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 75  

0000 900000      R     MOV     DPTR,#epNumber
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1073
                                           ; SOURCE LINE # 1075
0005 900000      R     MOV     DPTR,#epNumber
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 547F              ANL     A,#07FH
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#epNumber
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1077
0013 900000      R     MOV     DPTR,#epNumber
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 D3                SETB    C
001A 9400              SUBB    A,#00H
001C 5003              JNC     $ + 5H
001E 020000      R     LJMP    ?C0131
0021 900000      R     MOV     DPTR,#epNumber
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 C3                CLR     C
0028 9409              SUBB    A,#09H
002A 4003              JC      $ + 5H
002C 020000      R     LJMP    ?C0131
                                           ; SOURCE LINE # 1078
                                           ; SOURCE LINE # 1080
002F 900000      R     MOV     DPTR,#epNumber
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 75F00B            MOV     B,#0BH
0038 A4                MUL     AB
0039 2400        E     ADD     A,#LOW USBUART_EP+02H
003B F582              MOV     DPL,A
003D E4                CLR     A
003E 3400        E     ADDC    A,#HIGH USBUART_EP+02H
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 4401              ORL     A,#01H
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1083
004A 900000      R     MOV     DPTR,#epNumber
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USBUART_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USBUART_EP+03H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 76  

005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1084
005F 900000      R     MOV     DPTR,#epNumber
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
0064 EF                MOV     A,R7
0065 75F00B            MOV     B,#0BH
0068 A4                MUL     AB
0069 2400        E     ADD     A,#LOW USBUART_EP+01H
006B F582              MOV     DPL,A
006D E4                CLR     A
006E 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0070 F583              MOV     DPH,A
0072 7402              MOV     A,#02H
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1086
0075 900000      R     MOV     DPTR,#epNumber
0078 E0                MOVX    A,@DPTR
0079 FF                MOV     R7,A
007A EF                MOV     A,R7
007B 75F00B            MOV     B,#0BH
007E A4                MUL     AB
007F 2400        E     ADD     A,#LOW USBUART_EP+04H
0081 F582              MOV     DPL,A
0083 E4                CLR     A
0084 3400        E     ADDC    A,#HIGH USBUART_EP+04H
0086 F583              MOV     DPH,A
0088 E0                MOVX    A,@DPTR
0089 FF                MOV     R7,A
008A EF                MOV     A,R7
008B 5480              ANL     A,#080H
008D FF                MOV     R7,A
008E 7E00              MOV     R6,#00H
0090 EF                MOV     A,R7
0091 4E                ORL     A,R6
0092 6013              JZ      ?C0129
                                           ; SOURCE LINE # 1087
                                           ; SOURCE LINE # 1089
0094 900000      R     MOV     DPTR,#epNumber
0097 E0                MOVX    A,@DPTR
0098 FF                MOV     R7,A
0099 75F010            MOV     B,#010H
009C EF                MOV     A,R7
009D 905FFE            MOV     DPTR,#05FFEH
00A0 120000      E     LCALL   ?C?OFFXADD
00A3 740C              MOV     A,#0CH
00A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1090
00A6 22                RET     
00A7         ?C0129:
                                           ; SOURCE LINE # 1092
                                           ; SOURCE LINE # 1094
00A7 900000      R     MOV     DPTR,#epNumber
00AA E0                MOVX    A,@DPTR
00AB FF                MOV     R7,A
00AC 75F010            MOV     B,#010H
00AF EF                MOV     A,R7
00B0 905FFE            MOV     DPTR,#05FFEH
00B3 120000      E     LCALL   ?C?OFFXADD
00B6 7408              MOV     A,#08H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 77  

00B8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1095
                                           ; SOURCE LINE # 1096
                                           ; SOURCE LINE # 1097
00B9         ?C0131:
00B9 22                RET     
             ; FUNCTION _USBUART_TerminateEP (END)

             ; FUNCTION USBUART_SetEndpointHalt (BEGIN)
                                           ; SOURCE LINE # 1113
                                           ; SOURCE LINE # 1114
                                           ; SOURCE LINE # 1115
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1119
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 547F              ANL     A,#07FH
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#ep
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1121
0013 900000      R     MOV     DPTR,#ep
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 D3                SETB    C
001A 9400              SUBB    A,#00H
001C 5003              JNC     $ + 5H
001E 020000      R     LJMP    ?C0132
0021 900000      R     MOV     DPTR,#ep
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 C3                CLR     C
0028 9409              SUBB    A,#09H
002A 4003              JC      $ + 5H
002C 020000      R     LJMP    ?C0132
                                           ; SOURCE LINE # 1122
                                           ; SOURCE LINE # 1124
002F 900000      R     MOV     DPTR,#ep
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 75F00B            MOV     B,#0BH
0038 A4                MUL     AB
0039 2400        E     ADD     A,#LOW USBUART_EP+02H
003B F582              MOV     DPL,A
003D E4                CLR     A
003E 3400        E     ADDC    A,#HIGH USBUART_EP+02H
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 4401              ORL     A,#01H
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 78  

                                           ; SOURCE LINE # 1127
004A 900000      R     MOV     DPTR,#ep
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USBUART_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USBUART_EP+03H
005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1128
005F 900000      R     MOV     DPTR,#ep
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
0064 EF                MOV     A,R7
0065 75F00B            MOV     B,#0BH
0068 A4                MUL     AB
0069 2400        E     ADD     A,#LOW USBUART_EP+01H
006B F582              MOV     DPL,A
006D E4                CLR     A
006E 3400        E     ADDC    A,#HIGH USBUART_EP+01H
0070 F583              MOV     DPH,A
0072 E0                MOVX    A,@DPTR
0073 FF                MOV     R7,A
0074 EF                MOV     A,R7
0075 4402              ORL     A,#02H
0077 FF                MOV     R7,A
0078 EF                MOV     A,R7
0079 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1130
007A 900000      R     MOV     DPTR,#ep
007D E0                MOVX    A,@DPTR
007E FF                MOV     R7,A
007F EF                MOV     A,R7
0080 75F00B            MOV     B,#0BH
0083 A4                MUL     AB
0084 2400        E     ADD     A,#LOW USBUART_EP+04H
0086 F582              MOV     DPL,A
0088 E4                CLR     A
0089 3400        E     ADDC    A,#HIGH USBUART_EP+04H
008B F583              MOV     DPH,A
008D E0                MOVX    A,@DPTR
008E FF                MOV     R7,A
008F EF                MOV     A,R7
0090 5480              ANL     A,#080H
0092 FF                MOV     R7,A
0093 7E00              MOV     R6,#00H
0095 EF                MOV     A,R7
0096 4E                ORL     A,R6
0097 6014              JZ      ?C0133
                                           ; SOURCE LINE # 1131
                                           ; SOURCE LINE # 1133
0099 900000      R     MOV     DPTR,#ep
009C E0                MOVX    A,@DPTR
009D FF                MOV     R7,A
009E 75F010            MOV     B,#010H
00A1 EF                MOV     A,R7
00A2 905FFE            MOV     DPTR,#05FFEH
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 79  

00A5 120000      E     LCALL   ?C?OFFXADD
00A8 748D              MOV     A,#08DH
00AA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1135
00AB 8012              SJMP    ?C0134
00AD         ?C0133:
                                           ; SOURCE LINE # 1137
                                           ; SOURCE LINE # 1139
00AD 900000      R     MOV     DPTR,#ep
00B0 E0                MOVX    A,@DPTR
00B1 FF                MOV     R7,A
00B2 75F010            MOV     B,#010H
00B5 EF                MOV     A,R7
00B6 905FFE            MOV     DPTR,#05FFEH
00B9 120000      E     LCALL   ?C?OFFXADD
00BC 7489              MOV     A,#089H
00BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1141
00BF         ?C0134:
                                           ; SOURCE LINE # 1142
00BF 120000      E     LCALL   USBUART_InitNoDataControlTransfer
00C2 900000      R     MOV     DPTR,#requestHandled
00C5 EF                MOV     A,R7
00C6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1143
00C7         ?C0132:
                                           ; SOURCE LINE # 1145
00C7 900000      R     MOV     DPTR,#requestHandled
00CA E0                MOVX    A,@DPTR
00CB FF                MOV     R7,A
                                           ; SOURCE LINE # 1146
00CC         ?C0135:
00CC 22                RET     
             ; FUNCTION USBUART_SetEndpointHalt (END)

             ; FUNCTION USBUART_ClearEndpointHalt (BEGIN)
                                           ; SOURCE LINE # 1162
                                           ; SOURCE LINE # 1163
                                           ; SOURCE LINE # 1164
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1168
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A EF                MOV     A,R7
000B 547F              ANL     A,#07FH
000D FF                MOV     R7,A
000E 900000      R     MOV     DPTR,#ep
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1170
0013 900000      R     MOV     DPTR,#ep
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 D3                SETB    C
001A 9400              SUBB    A,#00H
001C 5003              JNC     $ + 5H
001E 020000      R     LJMP    ?C0136
0021 900000      R     MOV     DPTR,#ep
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 80  

0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 EF                MOV     A,R7
0027 C3                CLR     C
0028 9409              SUBB    A,#09H
002A 4003              JC      $ + 5H
002C 020000      R     LJMP    ?C0136
                                           ; SOURCE LINE # 1171
                                           ; SOURCE LINE # 1173
002F 900000      R     MOV     DPTR,#ep
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 75F00B            MOV     B,#0BH
0038 A4                MUL     AB
0039 2400        E     ADD     A,#LOW USBUART_EP+02H
003B F582              MOV     DPL,A
003D E4                CLR     A
003E 3400        E     ADDC    A,#HIGH USBUART_EP+02H
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 FF                MOV     R7,A
0044 EF                MOV     A,R7
0045 54FE              ANL     A,#0FEH
0047 FF                MOV     R7,A
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1176
004A 900000      R     MOV     DPTR,#ep
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F EF                MOV     A,R7
0050 75F00B            MOV     B,#0BH
0053 A4                MUL     AB
0054 2400        E     ADD     A,#LOW USBUART_EP+03H
0056 F582              MOV     DPL,A
0058 E4                CLR     A
0059 3400        E     ADDC    A,#HIGH USBUART_EP+03H
005B F583              MOV     DPH,A
005D E4                CLR     A
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1179
005F 900000      R     MOV     DPTR,#ep
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
0064 75F010            MOV     B,#010H
0067 EF                MOV     A,R7
0068 905FFC            MOV     DPTR,#05FFCH
006B 120000      E     LCALL   ?C?OFFXADD
006E 747F              MOV     A,#07FH
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1182
0071 900000      R     MOV     DPTR,#ep
0074 E0                MOVX    A,@DPTR
0075 FF                MOV     R7,A
0076 EF                MOV     A,R7
0077 75F00B            MOV     B,#0BH
007A A4                MUL     AB
007B 2400        E     ADD     A,#LOW USBUART_EP+01H
007D F582              MOV     DPL,A
007F E4                CLR     A
0080 3400        E     ADDC    A,#HIGH USBUART_EP+01H
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 81  

0082 F583              MOV     DPH,A
0084 E0                MOVX    A,@DPTR
0085 FF                MOV     R7,A
0086 EF                MOV     A,R7
0087 54FD              ANL     A,#0FDH
0089 FF                MOV     R7,A
008A EF                MOV     A,R7
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1184
008C 900000      R     MOV     DPTR,#ep
008F E0                MOVX    A,@DPTR
0090 FF                MOV     R7,A
0091 EF                MOV     A,R7
0092 75F00B            MOV     B,#0BH
0095 A4                MUL     AB
0096 2400        E     ADD     A,#LOW USBUART_EP+04H
0098 F582              MOV     DPL,A
009A E4                CLR     A
009B 3400        E     ADDC    A,#HIGH USBUART_EP+04H
009D F583              MOV     DPH,A
009F E0                MOVX    A,@DPTR
00A0 FF                MOV     R7,A
00A1 EF                MOV     A,R7
00A2 5480              ANL     A,#080H
00A4 FF                MOV     R7,A
00A5 7E00              MOV     R6,#00H
00A7 EF                MOV     A,R7
00A8 4E                ORL     A,R6
00A9 6041              JZ      ?C0137
                                           ; SOURCE LINE # 1185
                                           ; SOURCE LINE # 1187
00AB 900000      R     MOV     DPTR,#ep
00AE E0                MOVX    A,@DPTR
00AF FF                MOV     R7,A
00B0 EF                MOV     A,R7
00B1 75F00B            MOV     B,#0BH
00B4 A4                MUL     AB
00B5 2400        E     ADD     A,#LOW USBUART_EP+01H
00B7 F582              MOV     DPL,A
00B9 E4                CLR     A
00BA 3400        E     ADDC    A,#HIGH USBUART_EP+01H
00BC F583              MOV     DPH,A
00BE E0                MOVX    A,@DPTR
00BF FF                MOV     R7,A
00C0 EF                MOV     A,R7
00C1 B40114            CJNE    A,#01H,?C0138
                                           ; SOURCE LINE # 1188
                                           ; SOURCE LINE # 1190
00C4 900000      R     MOV     DPTR,#ep
00C7 E0                MOVX    A,@DPTR
00C8 FF                MOV     R7,A
00C9 75F010            MOV     B,#010H
00CC EF                MOV     A,R7
00CD 905FFE            MOV     DPTR,#05FFEH
00D0 120000      E     LCALL   ?C?OFFXADD
00D3 740C              MOV     A,#0CH
00D5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1191
00D6 8053              SJMP    ?C0140
00D8         ?C0138:
                                           ; SOURCE LINE # 1193
                                           ; SOURCE LINE # 1194
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 82  

00D8 900000      R     MOV     DPTR,#ep
00DB E0                MOVX    A,@DPTR
00DC FF                MOV     R7,A
00DD 75F010            MOV     B,#010H
00E0 EF                MOV     A,R7
00E1 905FFE            MOV     DPTR,#05FFEH
00E4 120000      E     LCALL   ?C?OFFXADD
00E7 740D              MOV     A,#0DH
00E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1195
                                           ; SOURCE LINE # 1196
00EA 803F              SJMP    ?C0140
00EC         ?C0137:
                                           ; SOURCE LINE # 1198
                                           ; SOURCE LINE # 1200
00EC 900000      R     MOV     DPTR,#ep
00EF E0                MOVX    A,@DPTR
00F0 FF                MOV     R7,A
00F1 EF                MOV     A,R7
00F2 75F00B            MOV     B,#0BH
00F5 A4                MUL     AB
00F6 2400        E     ADD     A,#LOW USBUART_EP+01H
00F8 F582              MOV     DPL,A
00FA E4                CLR     A
00FB 3400        E     ADDC    A,#HIGH USBUART_EP+01H
00FD F583              MOV     DPH,A
00FF E0                MOVX    A,@DPTR
0100 FF                MOV     R7,A
0101 EF                MOV     A,R7
0102 B40114            CJNE    A,#01H,?C0141
                                           ; SOURCE LINE # 1201
                                           ; SOURCE LINE # 1203
0105 900000      R     MOV     DPTR,#ep
0108 E0                MOVX    A,@DPTR
0109 FF                MOV     R7,A
010A 75F010            MOV     B,#010H
010D EF                MOV     A,R7
010E 905FFE            MOV     DPTR,#05FFEH
0111 120000      E     LCALL   ?C?OFFXADD
0114 7408              MOV     A,#08H
0116 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1204
0117 8012              SJMP    ?C0140
0119         ?C0141:
                                           ; SOURCE LINE # 1206
                                           ; SOURCE LINE # 1207
0119 900000      R     MOV     DPTR,#ep
011C E0                MOVX    A,@DPTR
011D FF                MOV     R7,A
011E 75F010            MOV     B,#010H
0121 EF                MOV     A,R7
0122 905FFE            MOV     DPTR,#05FFEH
0125 120000      E     LCALL   ?C?OFFXADD
0128 7409              MOV     A,#09H
012A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1208
                                           ; SOURCE LINE # 1209
012B         ?C0140:
                                           ; SOURCE LINE # 1211
012B 120000      E     LCALL   USBUART_InitNoDataControlTransfer
012E 900000      R     MOV     DPTR,#requestHandled
0131 EF                MOV     A,R7
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 83  

0132 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1212
0133         ?C0136:
                                           ; SOURCE LINE # 1214
0133 900000      R     MOV     DPTR,#requestHandled
0136 E0                MOVX    A,@DPTR
0137 FF                MOV     R7,A
                                           ; SOURCE LINE # 1215
0138         ?C0143:
0138 22                RET     
             ; FUNCTION USBUART_ClearEndpointHalt (END)

             ; FUNCTION USBUART_ValidateAlternateSetting (BEGIN)
                                           ; SOURCE LINE # 1231
                                           ; SOURCE LINE # 1232
                                           ; SOURCE LINE # 1233
0000 900000      R     MOV     DPTR,#requestHandled
0003 E4                CLR     A
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1240
0005 906004            MOV     DPTR,#06004H
0008 E0                MOVX    A,@DPTR
0009 FF                MOV     R7,A
000A 900000      R     MOV     DPTR,#interfaceNum
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1243
000F 900000      E     MOV     DPTR,#USBUART_configuration
0012 E0                MOVX    A,@DPTR
0013 FF                MOV     R7,A
0014 EF                MOV     A,R7
0015 14                DEC     A
0016 FF                MOV     R7,A
0017 120000      R     LCALL   _USBUART_GetConfigTablePtr
001A 900000      R     MOV     DPTR,#pTmp
001D EE                MOV     A,R6
001E F0                MOVX    @DPTR,A
001F A3                INC     DPTR
0020 EF                MOV     A,R7
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1244
0022 900000      R     MOV     DPTR,#pTmp
0025 E0                MOVX    A,@DPTR
0026 FE                MOV     R6,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 FF                MOV     R7,A
002A 8F82              MOV     DPL,R7
002C 8E83              MOV     DPH,R6
002E A3                INC     DPTR
002F 120000      E     LCALL   ?C?PLDCODE
0032 E9                MOV     A,R1
0033 2404              ADD     A,#04H
0035 F9                MOV     R1,A
0036 EA                MOV     A,R2
0037 3400              ADDC    A,#00H
0039 FA                MOV     R2,A
003A 120000      E     LCALL   ?C?CLDPTR
003D FF                MOV     R7,A
003E 900000      R     MOV     DPTR,#curInterfacesNum
0041 EF                MOV     A,R7
0042 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 84  

                                           ; SOURCE LINE # 1247
0043 900000      R     MOV     DPTR,#curInterfacesNum
0046 E0                MOVX    A,@DPTR
0047 FF                MOV     R7,A
0048 900000      R     MOV     DPTR,#interfaceNum
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D EE                MOV     A,R6
004E D3                SETB    C
004F 9F                SUBB    A,R7
0050 400B              JC      ?C0145
0052 900000      R     MOV     DPTR,#interfaceNum
0055 E0                MOVX    A,@DPTR
0056 FF                MOV     R7,A
0057 EF                MOV     A,R7
0058 D3                SETB    C
0059 9402              SUBB    A,#02H
005B 503E              JNC     ?C0144
005D         ?C0145:
                                           ; SOURCE LINE # 1248
                                           ; SOURCE LINE # 1252
005D 900000      R     MOV     DPTR,#interfaceNum
0060 E0                MOVX    A,@DPTR
0061 FF                MOV     R7,A
0062 7400        E     MOV     A,#LOW USBUART_interfaceSetting
0064 2F                ADD     A,R7
0065 F582              MOV     DPL,A
0067 E4                CLR     A
0068 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
006A F583              MOV     DPH,A
006C E0                MOVX    A,@DPTR
006D FF                MOV     R7,A
006E 900000      R     MOV     DPTR,#interfaceNum
0071 E0                MOVX    A,@DPTR
0072 FE                MOV     R6,A
0073 7400        E     MOV     A,#LOW USBUART_interfaceSettingLast
0075 2E                ADD     A,R6
0076 F582              MOV     DPL,A
0078 E4                CLR     A
0079 3400        E     ADDC    A,#HIGH USBUART_interfaceSettingLast
007B F583              MOV     DPH,A
007D EF                MOV     A,R7
007E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1253
007F 906002            MOV     DPTR,#06002H
0082 E0                MOVX    A,@DPTR
0083 FF                MOV     R7,A
0084 900000      R     MOV     DPTR,#interfaceNum
0087 E0                MOVX    A,@DPTR
0088 FE                MOV     R6,A
0089 7400        E     MOV     A,#LOW USBUART_interfaceSetting
008B 2E                ADD     A,R6
008C F582              MOV     DPL,A
008E E4                CLR     A
008F 3400        E     ADDC    A,#HIGH USBUART_interfaceSetting
0091 F583              MOV     DPH,A
0093 EF                MOV     A,R7
0094 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1255
0095 900000      R     MOV     DPTR,#requestHandled
0098 7401              MOV     A,#01H
009A F0                MOVX    @DPTR,A
C51 COMPILER V9.51   USBUART_STD                                                           04/28/2016 18:59:28 PAGE 85  

                                           ; SOURCE LINE # 1256
009B         ?C0144:
                                           ; SOURCE LINE # 1258
009B 900000      R     MOV     DPTR,#requestHandled
009E E0                MOVX    A,@DPTR
009F FF                MOV     R7,A
                                           ; SOURCE LINE # 1259
00A0         ?C0146:
00A0 22                RET     
             ; FUNCTION USBUART_ValidateAlternateSetting (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   5362    ----
   CONSTANT SIZE    =     17    ----
   XDATA SIZE       =      2      68
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
